/*! For license information please see main.3cff1bb0.js.LICENSE.txt */
!function(){"use strict";var e={463:function(e,t,n){var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function k(e,t,n,r){var i=y.hasOwnProperty(t)?y[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,g);y[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function B(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(1!==o||1!==u)do{if(o--,0>--u||i[o]!==a[u]){var s="\n"+i[o].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=o&&0<=u);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function j(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case b:return"Portal";case E:return"Profiler";case I:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case S:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function $(e,t){X(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var me=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,xe=null,Ie=null;function Ee(e){if(e=ki(e)){if("function"!==typeof be)throw Error(a(280));var t=e.stateNode;t&&(t=_i(t),be(e.stateNode,e.type,t))}}function Te(e){xe?Ie?Ie.push(e):Ie=[e]:xe=e}function Se(){if(xe){var e=xe,t=Ie;if(Ie=xe=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ce(e,t){return e(t)}function Ne(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ce(e,t,n)}finally{Ae=!1,(null!==xe||null!==Ie)&&(Ne(),Se())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Re=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){Re=!1}function Le(e,t,n,r,i,a,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Me=!1,Fe=null,Ue=!1,Ve=null,Be={onError:function(e){Me=!0,Fe=e}};function je(e,t,n,r,i,a,o,u,s){Me=!1,Fe=null,Le.apply(Be,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(qe(e)!==e)throw Error(a(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return We(i),e;if(o===r)return We(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var u=!1,s=i.child;s;){if(s===n){u=!0,n=i,r=o;break}if(s===r){u=!0,r=i,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=i;break}if(s===r){u=!0,r=o,n=i;break}s=s.sibling}if(!u)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Je=i.unstable_requestPaint,Xe=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ut(e)/st|0)|0},ut=Math.log,st=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var u=o&~i;0!==u?r=ht(u):0!==(a&=o)&&(r=ht(a))}else 0!==(o=n&~i)?r=ht(o):0!==a&&(r=ht(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,bt,xt,It,Et,Tt=!1,St=[],Ct=null,Nt=null,At=null,Dt=new Map,Pt=new Map,Rt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&bt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=gi(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void Et(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&bt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Vt(e,t,n){Ut(e)&&n.delete(t)}function Bt(){Tt=!1,null!==Ct&&Ut(Ct)&&(Ct=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==At&&Ut(At)&&(At=null),Dt.forEach(Vt),Pt.forEach(Vt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function qt(e){function t(t){return jt(t,e)}if(0<St.length){jt(St[0],e);for(var n=1;n<St.length;n++){var r=St[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&jt(Ct,e),null!==Nt&&jt(Nt,e),null!==At&&jt(At,e),Dt.forEach(t),Pt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Rt.shift()}var zt=w.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=1,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Ht(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=4,Gt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Gt(e,t,n,r){if(Wt){var i=Yt(e,t,n,r);if(null===i)Wr(e,t,r,Qt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Mt(Ct,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return At=Mt(At,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Dt.set(a,Mt(Dt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pt.set(a,Mt(Pt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var a=ki(i);if(null!==a&&_t(a),null===(a=Yt(e,t,n,r))&&Wr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=gi(e=_e(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,un,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),hn=F({},cn,{view:0,detail:0}),fn=an(hn),dn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,un=e.screenY-sn.screenY):un=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:un}}),pn=an(dn),vn=an(F({},dn,{dataTransfer:0})),yn=an(F({},hn,{relatedTarget:0})),mn=an(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(gn),wn=an(F({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function En(){return In}var Tn=F({},hn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=an(Tn),Cn=an(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),An=an(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=F({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(Dn),Rn=[9,13,27,32],On=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ln,Fn=l&&(!On||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Vn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Kn(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Gn=null;function Qn(e){Ur(e,0)}function Yn(e){if(G(wi(e)))return e}function Jn(e,t){if("change"===e)return t}var Xn=!1;if(l){var $n;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Xn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Gn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Kn(t,Gn,e,_e(e)),De(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function ar(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,yr=null,mr=null,gr=null,kr=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==yr||yr!==Q(r)||("selectionStart"in(r=yr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Hr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},xr={},Ir={};function Er(e){if(xr[e])return xr[e];if(!br[e])return e;var t,n=br[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ir)return xr[e]=n[t];return e}l&&(Ir=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Tr=Er("animationend"),Sr=Er("animationiteration"),Cr=Er("animationstart"),Nr=Er("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ar.set(e,t),s(t,[e])}for(var Rr=0;Rr<Dr.length;Rr++){var Or=Dr[Rr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(Tr,"onAnimationEnd"),Pr(Sr,"onAnimationIteration"),Pr(Cr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,u,s,c){if(je.apply(this,arguments),Me){if(!Me)throw Error(a(198));var l=Fe;Me=!1,Fe=null,Ue||(Ue=!0,Ve=l)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==a&&i.isPropagationStopped())break e;Fr(i,u,c),a=s}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function Vr(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[jr]){e[jr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Br("selectionchange",!1,t))}}function zr(e,t,n,r){switch(Jt(t)){case 1:var i=Kt;break;case 4:i=Ht;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===i||8===u.nodeType&&u.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===i||8===s.nodeType&&s.parentNode===i))return;o=o.return}for(;null!==u;){if(null===(o=gi(u)))return;if(5===(s=o.tag)||6===s){r=a=o;continue e}u=u.parentNode}}r=r.return}De((function(){var r=a,i=_e(n),o=[];e:{var u=Ar.get(e);if(void 0!==u){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=Sn;break;case"focusin":c="focus",s=yn;break;case"focusout":c="blur",s=yn;break;case"beforeblur":case"afterblur":s=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Nn;break;case Tr:case Sr:case Cr:s=mn;break;case Nr:s=An;break;case"scroll":s=fn;break;case"wheel":s=Pn;break;case"copy":case"cut":case"paste":s=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Cn}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==u?u+"Capture":null:u;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==f&&(null!=(v=Pe(p,f))&&l.push(Kr(p,v,d)))),h)break;p=p.return}0<l.length&&(u=new s(u,c,null,n,i),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!gi(c)&&!c[pi])&&(s||u)&&(u=i.window===i?i:(u=i.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?gi(c):null)&&(c!==(h=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=pn,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Cn,v="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==s?u:wi(s),d=null==c?u:wi(c),(u=new l(v,p+"leave",s,n,i)).target=h,u.relatedTarget=d,v=null,gi(i)===r&&((l=new l(f,p+"enter",c,n,i)).target=d,l.relatedTarget=h,v=l),h=v,s&&c)e:{for(f=c,p=0,d=l=s;d;d=Gr(d))p++;for(d=0,v=f;v;v=Gr(v))d++;for(;0<p-d;)l=Gr(l),p--;for(;0<d-p;)f=Gr(f),d--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=Gr(l),f=Gr(f)}l=null}else l=null;null!==s&&Qr(o,u,s,l,!1),null!==c&&null!==h&&Qr(o,h,c,l,!0)}if("select"===(s=(u=r?wi(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var y=Jn;else if(Wn(u))if(Xn)y=or;else{y=ir;var m=rr}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(y=ar);switch(y&&(y=y(e,r))?Kn(o,y,n,i):(m&&m(e,u,r),"focusout"===e&&(m=u._wrapperState)&&m.controlled&&"number"===u.type&&ee(u,"number",u.value)),m=r?wi(r):window,e){case"focusin":(Wn(m)||"true"===m.contentEditable)&&(yr=m,mr=r,gr=null);break;case"focusout":gr=mr=yr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,wr(o,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":wr(o,n,i)}var g;if(On)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else qn?Bn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Fn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==k?"onCompositionEnd"===k&&qn&&(g=en()):($t="value"in(Xt=i)?Xt.value:Xt.textContent,qn=!0)),0<(m=Hr(r,k)).length&&(k=new wn(k,e,null,n,i),o.push({event:k,listeners:m}),g?k.data=g:null!==(g=jn(n))&&(k.data=g))),(g=Mn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Un);case"textInput":return(e=t.data)===Un&&Vn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),Zt=$t=Xt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Ur(o,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Pe(e,n))&&r.unshift(Kr(e,a,i)),null!=(a=Pe(e,t))&&r.push(Kr(e,a,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,i?null!=(s=Pe(n,a))&&o.unshift(Kr(n,s,u)):i||null!=(s=Pe(n,a))&&o.push(Kr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Jr,"")}function $r(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(ui)}:ri;function ui(e){setTimeout((function(){throw e}))}function si(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);qt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,di="__reactProps$"+hi,pi="__reactContainer$"+hi,vi="__reactEvents$"+hi,yi="__reactListeners$"+hi,mi="__reactHandles$"+hi;function gi(e){var t=e[fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[fi])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[fi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _i(e){return e[di]||null}var bi=[],xi=-1;function Ii(e){return{current:e}}function Ei(e){0>xi||(e.current=bi[xi],bi[xi]=null,xi--)}function Ti(e,t){xi++,bi[xi]=e.current,e.current=t}var Si={},Ci=Ii(Si),Ni=Ii(!1),Ai=Si;function Di(e,t){var n=e.type.contextTypes;if(!n)return Si;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){Ei(Ni),Ei(Ci)}function Oi(e,t,n){if(Ci.current!==Si)throw Error(a(168));Ti(Ci,t),Ti(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,z(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Si,Ai=Ci.current,Ti(Ci,e),Ti(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Li(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ni),Ei(Ci),Ti(Ci,e)):Ei(Ni),Ti(Ni,n)}var Ui=null,Vi=!1,Bi=!1;function ji(e){null===Ui?Ui=[e]:Ui.push(e)}function qi(){if(!Bi&&null!==Ui){Bi=!0;var e=0,t=kt;try{var n=Ui;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Vi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ge(Ze,qi),i}finally{kt=t,Bi=!1}}return null}var zi=w.ReactCurrentBatchConfig;function Wi(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ki=Ii(null),Hi=null,Gi=null,Qi=null;function Yi(){Qi=Gi=Hi=null}function Ji(e){var t=Ki.current;Ei(Ki),e._currentValue=t}function Xi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function $i(e,t){Hi=e,Qi=Gi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_u=!0),e.firstContext=null)}function Zi(e){var t=e._currentValue;if(Qi!==e)if(e={context:e,memoizedValue:t,next:null},null===Gi){if(null===Hi)throw Error(a(308));Gi=e,Hi.dependencies={lanes:0,firstContext:e}}else Gi=Gi.next=e;return t}var ea=null,ta=!1;function na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ia(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function aa(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,tc(e)?(null===(e=n.interleaved)?(t.next=t,null===ea?ea=[n]:ea.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function oa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function ua(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function sa(e,t,n,r){var i=e.updateQueue;ta=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var s=u,c=s.next;s.next=null,null===o?a=c:o.next=c,o=s;var l=e.alternate;null!==l&&((u=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===u?l.firstBaseUpdate=c:u.next=c,l.lastBaseUpdate=s))}if(null!==a){var h=i.baseState;for(o=0,l=c=s=null,u=a;;){var f=u.lane,d=u.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:d,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var p=e,v=u;switch(f=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=v.payload)?p.call(d,h,f):p)||void 0===f)break e;h=F({},h,f);break e;case 2:ta=!0}}null!==u.callback&&0!==u.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[u]:f.push(u))}else d={eventTime:d,lane:f,tag:u.tag,payload:u.payload,callback:u.callback,next:null},null===l?(c=l=d,s=h):l=l.next=d,o|=f;if(null===(u=u.next)){if(null===(u=i.shared.pending))break;u=(f=u).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===l&&(s=h),i.baseState=s,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Rs|=o,e.lanes=o,e.memoizedState=h}}function ca(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var la=(new r.Component).refs;function ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Xs(),i=$s(e),a=ia(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),aa(e,a),null!==(t=Zs(e,i,r))&&oa(t,e,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Xs(),i=$s(e),a=ia(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),aa(e,a),null!==(t=Zs(e,i,r))&&oa(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xs(),r=$s(e),i=ia(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),aa(e,i),null!==(t=Zs(e,r,n))&&oa(t,e,r)}};function da(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(i,a))}function pa(e,t,n){var r=!1,i=Si,a=t.contextType;return"object"===typeof a&&null!==a?a=Zi(a):(i=Pi(t)?Ai:Ci.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Di(e,i):Si),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function va(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function ya(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=la,na(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Zi(a):(a=Pi(t)?Ai:Ci.current,i.context=Di(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ha(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&fa.enqueueReplaceState(i,i.state,null),sa(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}var ma=[],ga=0,ka=null,wa=0,_a=[],ba=0,xa=null,Ia=1,Ea="";function Ta(e,t){ma[ga++]=wa,ma[ga++]=ka,ka=e,wa=t}function Sa(e,t,n){_a[ba++]=Ia,_a[ba++]=Ea,_a[ba++]=xa,xa=e;var r=Ia;e=Ea;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ia=1<<32-ot(t)+i|n<<i|r,Ea=a+e}else Ia=1<<a|n<<i|r,Ea=e}function Ca(e){null!==e.return&&(Ta(e,1),Sa(e,1,0))}function Na(e){for(;e===ka;)ka=ma[--ga],ma[ga]=null,wa=ma[--ga],ma[ga]=null;for(;e===xa;)xa=_a[--ba],_a[ba]=null,Ea=_a[--ba],_a[ba]=null,Ia=_a[--ba],_a[ba]=null}var Aa=null,Da=null,Pa=!1,Ra=null;function Oa(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function La(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Aa=e,Da=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Aa=e,Da=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==xa?{id:Ia,overflow:Ea}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Aa=e,Da=null,!0);default:return!1}}function Ma(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Fa(e){if(Pa){var t=Da;if(t){var n=t;if(!La(e,t)){if(Ma(e))throw Error(a(418));t=ci(n.nextSibling);var r=Aa;t&&La(e,t)?Oa(r,n):(e.flags=-4097&e.flags|2,Pa=!1,Aa=e)}}else{if(Ma(e))throw Error(a(418));e.flags=-4097&e.flags|2,Pa=!1,Aa=e}}}function Ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Aa=e}function Va(e){if(e!==Aa)return!1;if(!Pa)return Ua(e),Pa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=Da)){if(Ma(e)){for(e=Da;e;)e=ci(e.nextSibling);throw Error(a(418))}for(;t;)Oa(e,t),t=ci(t.nextSibling)}if(Ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Da=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Da=null}}else Da=Aa?ci(e.stateNode.nextSibling):null;return!0}function Ba(){Da=Aa=null,Pa=!1}function ja(e){null===Ra?Ra=[e]:Ra.push(e)}function qa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===la&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function za(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wa(e){return(0,e._init)(e._payload)}function Ka(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function u(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===x?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===P&&Wa(a)===t.type)?((r=i(t,n.props)).ref=qa(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=qa(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=qa(e,null,t),n.return=e,n;case b:return(t=Fc(t,e.mode,n)).return=e,t;case P:return f(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Oc(t,e.mode,n,null)).return=e,t;za(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case b:return n.key===i?l(e,t,n,r):null;case P:return d(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);za(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case b:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);za(t,r)}return null}function v(i,a,u,s){for(var c=null,l=null,h=a,v=a=0,y=null;null!==h&&v<u.length;v++){h.index>v?(y=h,h=null):y=h.sibling;var m=d(i,h,u[v],s);if(null===m){null===h&&(h=y);break}e&&h&&null===m.alternate&&t(i,h),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m,h=y}if(v===u.length)return n(i,h),Pa&&Ta(i,v),c;if(null===h){for(;v<u.length;v++)null!==(h=f(i,u[v],s))&&(a=o(h,a,v),null===l?c=h:l.sibling=h,l=h);return Pa&&Ta(i,v),c}for(h=r(i,h);v<u.length;v++)null!==(y=p(h,i,v,u[v],s))&&(e&&null!==y.alternate&&h.delete(null===y.key?v:y.key),a=o(y,a,v),null===l?c=y:l.sibling=y,l=y);return e&&h.forEach((function(e){return t(i,e)})),Pa&&Ta(i,v),c}function y(i,u,s,c){var l=L(s);if("function"!==typeof l)throw Error(a(150));if(null==(s=l.call(s)))throw Error(a(151));for(var h=l=null,v=u,y=u=0,m=null,g=s.next();null!==v&&!g.done;y++,g=s.next()){v.index>y?(m=v,v=null):m=v.sibling;var k=d(i,v,g.value,c);if(null===k){null===v&&(v=m);break}e&&v&&null===k.alternate&&t(i,v),u=o(k,u,y),null===h?l=k:h.sibling=k,h=k,v=m}if(g.done)return n(i,v),Pa&&Ta(i,y),l;if(null===v){for(;!g.done;y++,g=s.next())null!==(g=f(i,g.value,c))&&(u=o(g,u,y),null===h?l=g:h.sibling=g,h=g);return Pa&&Ta(i,y),l}for(v=r(i,v);!g.done;y++,g=s.next())null!==(g=p(v,i,y,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?y:g.key),u=o(g,u,y),null===h?l=g:h.sibling=g,h=g);return e&&v.forEach((function(e){return t(i,e)})),Pa&&Ta(i,y),l}return function e(r,a,o,s){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,l=a;null!==l;){if(l.key===c){if((c=o.type)===x){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&Wa(c)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=qa(r,l,o),a.return=r,r=a;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===x?((a=Oc(o.props.children,r.mode,s,o.key)).return=r,r=a):((s=Rc(o.type,o.key,o.props,null,r.mode,s)).ref=qa(r,a,o),s.return=r,r=s)}return u(r);case b:e:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Fc(o,r.mode,s)).return=r,r=a}return u(r);case P:return e(r,a,(l=o._init)(o._payload),s)}if(te(o))return v(r,a,o,s);if(L(o))return y(r,a,o,s);za(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Mc(o,r.mode,s)).return=r,r=a),u(r)):n(r,a)}}var Ha=Ka(!0),Ga=Ka(!1),Qa={},Ya=Ii(Qa),Ja=Ii(Qa),Xa=Ii(Qa);function $a(e){if(e===Qa)throw Error(a(174));return e}function Za(e,t){switch(Ti(Xa,t),Ti(Ja,e),Ti(Ya,Qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Ya),Ti(Ya,t)}function eo(){Ei(Ya),Ei(Ja),Ei(Xa)}function to(e){$a(Xa.current);var t=$a(Ya.current),n=se(t,e.type);t!==n&&(Ti(Ja,e),Ti(Ya,n))}function no(e){Ja.current===e&&(Ei(Ya),Ei(Ja))}var ro=Ii(0);function io(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ao=[];function oo(){for(var e=0;e<ao.length;e++)ao[e]._workInProgressVersionPrimary=null;ao.length=0}var uo=w.ReactCurrentDispatcher,so=w.ReactCurrentBatchConfig,co=0,lo=null,ho=null,fo=null,po=!1,vo=!1,yo=0,mo=0;function go(){throw Error(a(321))}function ko(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function wo(e,t,n,r,i,o){if(co=o,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uo.current=null===e||null===e.memoizedState?ru:iu,e=n(r,i),vo){o=0;do{if(vo=!1,yo=0,25<=o)throw Error(a(301));o+=1,fo=ho=null,t.updateQueue=null,uo.current=au,e=n(r,i)}while(vo)}if(uo.current=nu,t=null!==ho&&null!==ho.next,co=0,fo=ho=lo=null,po=!1,t)throw Error(a(300));return e}function _o(){var e=0!==yo;return yo=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fo?lo.memoizedState=fo=e:fo=fo.next=e,fo}function xo(){if(null===ho){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===fo?lo.memoizedState:fo.next;if(null!==t)fo=t,ho=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===fo?lo.memoizedState=fo=e:fo=fo.next=e}return fo}function Io(e,t){return"function"===typeof t?t(e):t}function Eo(e){var t=xo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ho,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var u=i.next;i.next=o.next,o.next=u}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var s=u=null,c=null,l=o;do{var h=l.lane;if((co&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=f,u=r):c=c.next=f,lo.lanes|=h,Rs|=h}l=l.next}while(null!==l&&l!==o);null===c?u=r:c.next=s,ur(r,t.memoizedState)||(_u=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,lo.lanes|=o,Rs|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function To(e){var t=xo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var u=i=i.next;do{o=e(o,u.action),u=u.next}while(u!==i);ur(o,t.memoizedState)||(_u=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function So(){}function Co(e,t){var n=lo,r=xo(),i=t(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,_u=!0),r=r.queue,Vo(Do.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==fo&&1&fo.memoizedState.tag){if(n.flags|=2048,Oo(9,Ao.bind(null,n,r,i,t),void 0,null),null===Ts)throw Error(a(349));0!==(30&co)||No(n,t,i)}return i}function No(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ao(e,t,n,r){t.value=n,t.getSnapshot=r,Po(t)&&Zs(e,1,-1)}function Do(e,t,n){return n((function(){Po(t)&&Zs(e,1,-1)}))}function Po(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Ro(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:e},t.queue=e,e=e.dispatch=Xo.bind(null,lo,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Lo(){return xo().memoizedState}function Mo(e,t,n,r){var i=bo();lo.flags|=e,i.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function Fo(e,t,n,r){var i=xo();r=void 0===r?null:r;var a=void 0;if(null!==ho){var o=ho.memoizedState;if(a=o.destroy,null!==r&&ko(r,o.deps))return void(i.memoizedState=Oo(t,n,a,r))}lo.flags|=e,i.memoizedState=Oo(1|t,n,a,r)}function Uo(e,t){return Mo(8390656,8,e,t)}function Vo(e,t){return Fo(2048,8,e,t)}function Bo(e,t){return Fo(4,2,e,t)}function jo(e,t){return Fo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4,4,qo.bind(null,t,e),n)}function Wo(){}function Ko(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ho(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Go(e,t,n){return 0===(21&co)?(e.baseState&&(e.baseState=!1,_u=!0),e.memoizedState=n):(ur(n,t)||(n=vt(),lo.lanes|=n,Rs|=n,e.baseState=!0),t)}function Qo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=so.transition;so.transition={};try{e(!1),t()}finally{kt=n,so.transition=r}}function Yo(){return xo().memoizedState}function Jo(e,t,n){var r=$s(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$o(e)?Zo(t,n):(eu(e,t,n),null!==(e=Zs(e,r,n=Xs()))&&tu(e,t,r))}function Xo(e,t,n){var r=$s(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($o(e))Zo(t,i);else{eu(e,t,i);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,ur(u,o))return}catch(s){}null!==(e=Zs(e,r,n=Xs()))&&tu(e,t,r)}}function $o(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Zo(e,t){vo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function eu(e,t,n){tc(e)?(null===(e=t.interleaved)?(n.next=n,null===ea?ea=[t]:ea.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function tu(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var nu={readContext:Zi,useCallback:go,useContext:go,useEffect:go,useImperativeHandle:go,useInsertionEffect:go,useLayoutEffect:go,useMemo:go,useReducer:go,useRef:go,useState:go,useDebugValue:go,useDeferredValue:go,useTransition:go,useMutableSource:go,useSyncExternalStore:go,useId:go,unstable_isNewReconciler:!1},ru={readContext:Zi,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Zi,useEffect:Uo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Mo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mo(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Jo.bind(null,lo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Ro,useDebugValue:Wo,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Ro(!1),t=e[0];return e=Qo.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lo,i=bo();if(Pa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Ts)throw Error(a(349));0!==(30&co)||No(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Uo(Do.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,Ao.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Ts.identifierPrefix;if(Pa){var n=Ea;t=":"+t+"R"+(n=(Ia&~(1<<32-ot(Ia)-1)).toString(32)+n),0<(n=yo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=mo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iu={readContext:Zi,useCallback:Ko,useContext:Zi,useEffect:Vo,useImperativeHandle:zo,useInsertionEffect:Bo,useLayoutEffect:jo,useMemo:Ho,useReducer:Eo,useRef:Lo,useState:function(){return Eo(Io)},useDebugValue:Wo,useDeferredValue:function(e){return Go(xo(),ho.memoizedState,e)},useTransition:function(){return[Eo(Io)[0],xo().memoizedState]},useMutableSource:So,useSyncExternalStore:Co,useId:Yo,unstable_isNewReconciler:!1},au={readContext:Zi,useCallback:Ko,useContext:Zi,useEffect:Vo,useImperativeHandle:zo,useInsertionEffect:Bo,useLayoutEffect:jo,useMemo:Ho,useReducer:To,useRef:Lo,useState:function(){return To(Io)},useDebugValue:Wo,useDeferredValue:function(e){var t=xo();return null===ho?t.memoizedState=e:Go(t,ho.memoizedState,e)},useTransition:function(){return[To(Io)[0],xo().memoizedState]},useMutableSource:So,useSyncExternalStore:Co,useId:Yo,unstable_isNewReconciler:!1};function ou(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function uu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var su,cu,lu,hu="function"===typeof WeakMap?WeakMap:Map;function fu(e,t,n){(n=ia(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){js||(js=!0,qs=r),uu(0,t)},n}function du(e,t,n){(n=ia(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){uu(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){uu(0,t),"function"!==typeof r&&(null===zs?zs=new Set([this]):zs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function pu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hu;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ic.bind(null,e,t,n),t.then(e,e))}function vu(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yu(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ia(-1,1)).tag=2,aa(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}function mu(e,t){if(!Pa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function gu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ku(e,t,n){var r=t.pendingProps;switch(Na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gu(t),null;case 1:case 17:return Pi(t.type)&&Ri(),gu(t),null;case 3:return r=t.stateNode,eo(),Ei(Ni),Ei(Ci),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Va(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Ra&&(ac(Ra),Ra=null))),gu(t),null;case 5:no(t);var i=$a(Xa.current);if(n=t.type,null!==e&&null!=t.stateNode)cu(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return gu(t),null}if(e=$a(Ya.current),Va(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fi]=t,r[di]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":J(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var s in ge(n,o),i=null,o)if(o.hasOwnProperty(s)){var c=o[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",""+c]):u.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&Vr("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ue(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[fi]=t,e[di]=r,su(e,t),t.stateNode=e;e:{switch(s=ke(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":J(e,r),i=Y(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ge(n,i),c=i)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ye(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Vr("scroll",e):null!=l&&k(e,o,l,s))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return gu(t),null;case 6:if(e&&null!=t.stateNode)lu(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=$a(Xa.current),$a(Ya.current),Va(t)){if(r=t.stateNode,n=t.memoizedProps,r[fi]=t,(o=r.nodeValue!==n)&&null!==(e=Aa))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fi]=t,t.stateNode=r}return gu(t),null;case 13:if(Ei(ro),r=t.memoizedState,Pa&&null!==Da&&0!==(1&t.mode)&&0===(128&t.flags)){for(r=Da;r;)r=ci(r.nextSibling);return Ba(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Va(t),null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[fi]=t}else Ba(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return gu(t),null}return null!==Ra&&(ac(Ra),Ra=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Va(t):n=null!==e.memoizedState,r!==n&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Ds&&(Ds=3):pc())),null!==t.updateQueue&&(t.flags|=4),gu(t),null);case 4:return eo(),null===e&&qr(t.stateNode.containerInfo),gu(t),null;case 10:return Ji(t.type._context),gu(t),null;case 19:if(Ei(ro),null===(o=t.memoizedState))return gu(t),null;if(r=0!==(128&t.flags),null===(s=o.rendering))if(r)mu(o,!1);else{if(0!==Ds||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=io(e))){for(t.flags|=128,mu(o,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>Vs&&(t.flags|=128,r=!0,mu(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=io(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),mu(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!Pa)return gu(t),null}else 2*Xe()-o.renderingStartTime>Vs&&1073741824!==n&&(t.flags|=128,r=!0,mu(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=ro.current,Ti(ro,r?1&n|2:1&n),t):(gu(t),null);case 22:case 23:return lc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ns)&&(gu(t),6&t.subtreeFlags&&(t.flags|=8192)):gu(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}su=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},cu=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,$a(Ya.current);var a,o=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ge(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(u.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(a in s)!s.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&s[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(u.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Vr("scroll",e),o||s===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},lu=function(e,t,n,r){n!==r&&(t.flags|=4)};var wu=w.ReactCurrentOwner,_u=!1;function bu(e,t,n,r){t.child=null===e?Ga(t,null,n,r):Ha(t,e.child,n,r)}function xu(e,t,n,r,i){n=n.render;var a=t.ref;return $i(t,i),r=wo(e,t,n,r,a,i),n=_o(),null===e||_u?(Pa&&n&&Ca(t),t.flags|=1,bu(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wu(e,t,i))}function Iu(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Dc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Eu(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(o,r)&&e.ref===t.ref)return Wu(e,t,i)}return t.flags|=1,(e=Pc(a,r)).ref=t.ref,e.return=t,t.child=e}function Eu(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(sr(a,r)&&e.ref===t.ref){if(_u=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Wu(e,t,i);0!==(131072&e.flags)&&(_u=!0)}}return Cu(e,t,n,r,i)}function Tu(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(As,Ns),Ns|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(As,Ns),Ns|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ti(As,Ns),Ns|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ti(As,Ns),Ns|=r;return bu(e,t,i,n),t.child}function Su(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cu(e,t,n,r,i){var a=Pi(n)?Ai:Ci.current;return a=Di(t,a),$i(t,i),n=wo(e,t,n,r,a,i),r=_o(),null===e||_u?(Pa&&r&&Ca(t),t.flags|=1,bu(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wu(e,t,i))}function Nu(e,t,n,r,i){if(Pi(n)){var a=!0;Mi(t)}else a=!1;if($i(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),pa(t,n,r),ya(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Zi(c):c=Di(t,c=Pi(n)?Ai:Ci.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&va(t,o,r,c),ta=!1;var f=t.memoizedState;o.state=f,sa(t,r,o,i),s=t.memoizedState,u!==r||f!==s||Ni.current||ta?("function"===typeof l&&(ha(t,n,l,r),s=t.memoizedState),(u=ta||da(t,n,u,r,f,s,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ra(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:Wi(t.type,u),o.props=c,h=t.pendingProps,f=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=Zi(s):s=Di(t,s=Pi(n)?Ai:Ci.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==h||f!==s)&&va(t,o,r,s),ta=!1,f=t.memoizedState,o.state=f,sa(t,r,o,i);var p=t.memoizedState;u!==h||f!==p||Ni.current||ta?("function"===typeof d&&(ha(t,n,d,r),p=t.memoizedState),(c=ta||da(t,n,c,r,f,p,s)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Au(e,t,n,r,a,i)}function Au(e,t,n,r,i,a){Su(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Wu(e,t,a);r=t.stateNode,wu.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ha(t,e.child,null,a),t.child=Ha(t,null,u,a)):bu(e,t,u,a),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Du(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Za(e,t.containerInfo)}function Pu(e,t,n,r,i){return Ba(),ja(i),t.flags|=256,bu(e,t,n,r),t.child}var Ru={dehydrated:null,treeContext:null,retryLane:0};function Ou(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lu(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function Mu(e,t,n){var r,i=t.pendingProps,o=ro.current,u=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(u=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(ro,1&o),null===e)return Fa(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=i.children,e=i.fallback,u?(i=t.mode,u=t.child,o={mode:"hidden",children:o},0===(1&i)&&null!==u?(u.childLanes=0,u.pendingProps=o):u=Lc(o,i,0,null),e=Oc(e,i,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=Ou(n),t.memoizedState=Ru,e):Fu(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(s)return 256&t.flags?(t.flags&=-257,Bu(e,t,n,Error(a(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(u=i.fallback,o=t.mode,i=Lc({mode:"visible",children:i.children},o,0,null),(u=Oc(u,o,n,null)).flags|=2,i.return=t,u.return=t,i.sibling=u,t.child=i,0!==(1&t.mode)&&Ha(t,e.child,null,n),t.child.memoizedState=Ou(n),t.memoizedState=Ru,u);if(0===(1&t.mode))t=Bu(e,t,n,null);else if("$!"===r.data)t=Bu(e,t,n,Error(a(419)));else if(i=0!==(n&e.childLanes),_u||i){if(null!==(i=Ts)){switch(n&-n){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}0!==(i=0!==(u&(i.suspendedLanes|n))?0:u)&&i!==o.retryLane&&(o.retryLane=i,Zs(e,i,-1))}pc(),t=Bu(e,t,n,Error(a(421)))}else"$?"===r.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),r._reactRetry=t,t=null):(n=o.treeContext,Da=ci(r.nextSibling),Aa=t,Pa=!0,Ra=null,null!==n&&(_a[ba++]=Ia,_a[ba++]=Ea,_a[ba++]=xa,Ia=n.id,Ea=n.overflow,xa=t),(t=Fu(t,t.pendingProps.children)).flags|=4096);return t}return u?(i=Vu(e,t,i.children,i.fallback,n),u=t.child,o=e.child.memoizedState,u.memoizedState=null===o?Ou(n):Lu(o,n),u.childLanes=e.childLanes&~n,t.memoizedState=Ru,i):(n=Uu(e,t,i.children,n),t.memoizedState=null,n)}return u?(i=Vu(e,t,i.children,i.fallback,n),u=t.child,o=e.child.memoizedState,u.memoizedState=null===o?Ou(n):Lu(o,n),u.childLanes=e.childLanes&~n,t.memoizedState=Ru,i):(n=Uu(e,t,i.children,n),t.memoizedState=null,n)}function Fu(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uu(e,t,n,r){var i=e.child;return e=i.sibling,n=Pc(i,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function Vu(e,t,n,r,i){var a=t.mode,o=(e=e.child).sibling,u={mode:"hidden",children:n};return 0===(1&a)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=u,t.deletions=null):(n=Pc(e,u)).subtreeFlags=14680064&e.subtreeFlags,null!==o?r=Pc(o,r):(r=Oc(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Bu(e,t,n,r){return null!==r&&ja(r),Ha(t,e.child,null,n),(e=Fu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ju(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Xi(e.return,t,n)}function qu(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function zu(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bu(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ju(e,n,t);else if(19===e.tag)ju(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===io(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),qu(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===io(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}qu(t,!0,n,null,a);break;case"together":qu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Rs|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ku(e,t){switch(Na(t),t.tag){case 1:return Pi(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),Ei(Ni),Ei(Ci),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(Ei(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));Ba()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(ro),null;case 4:return eo(),null;case 10:return Ji(t.type._context),null;case 22:case 23:return lc(),null;default:return null}}var Hu=!1,Gu=!1,Qu="function"===typeof WeakSet?WeakSet:Set,Yu=null;function Ju(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){xc(e,t,r)}else n.current=null}function Xu(e,t,n){try{n()}catch(r){xc(e,t,r)}}var $u=!1;function Zu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&Xu(t,n,a)}i=i.next}while(i!==r)}}function es(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ts(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ns(e){var t=e.alternate;null!==t&&(e.alternate=null,ns(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[di],delete t[vi],delete t[yi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rs(e){return 5===e.tag||3===e.tag||4===e.tag}function is(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function as(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(as(e,t,n),e=e.sibling;null!==e;)as(e,t,n),e=e.sibling}function os(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(os(e,t,n),e=e.sibling;null!==e;)os(e,t,n),e=e.sibling}var us=null,ss=!1;function cs(e,t,n){for(n=n.child;null!==n;)ls(e,t,n),n=n.sibling}function ls(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(u){}switch(n.tag){case 5:Gu||Ju(n,t);case 6:var r=us,i=ss;us=null,cs(e,t,n),ss=i,null!==(us=r)&&(ss?(e=us,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):us.removeChild(n.stateNode));break;case 18:null!==us&&(ss?(e=us,n=n.stateNode,8===e.nodeType?si(e.parentNode,n):1===e.nodeType&&si(e,n),qt(e)):si(us,n.stateNode));break;case 4:r=us,i=ss,us=n.stateNode.containerInfo,ss=!0,cs(e,t,n),us=r,ss=i;break;case 0:case 11:case 14:case 15:if(!Gu&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&Xu(n,t,o),i=i.next}while(i!==r)}cs(e,t,n);break;case 1:if(!Gu&&(Ju(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){xc(n,t,u)}cs(e,t,n);break;case 21:cs(e,t,n);break;case 22:1&n.mode?(Gu=(r=Gu)||null!==n.memoizedState,cs(e,t,n),Gu=r):cs(e,t,n);break;default:cs(e,t,n)}}function hs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qu),t.forEach((function(t){var r=Sc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function fs(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,u=t,s=u;e:for(;null!==s;){switch(s.tag){case 5:us=s.stateNode,ss=!1;break e;case 3:case 4:us=s.stateNode.containerInfo,ss=!0;break e}s=s.return}if(null===us)throw Error(a(160));ls(o,u,i),us=null,ss=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){xc(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ds(t,e),t=t.sibling}function ds(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fs(t,e),ps(e),4&r){try{Zu(3,e,e.return),es(3,e)}catch(v){xc(e,e.return,v)}try{Zu(5,e,e.return)}catch(v){xc(e,e.return,v)}}break;case 1:fs(t,e),ps(e),512&r&&null!==n&&Ju(n,n.return);break;case 5:if(fs(t,e),ps(e),512&r&&null!==n&&Ju(n,n.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(v){xc(e,e.return,v)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,u=null!==n?n.memoizedProps:o,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===o.type&&null!=o.name&&X(i,o),ke(s,u);var l=ke(s,o);for(u=0;u<c.length;u+=2){var h=c[u],f=c[u+1];"style"===h?ye(i,f):"dangerouslySetInnerHTML"===h?he(i,f):"children"===h?fe(i,f):k(i,h,f,l)}switch(s){case"input":$(i,o);break;case"textarea":ae(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):d!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[di]=o}catch(v){xc(e,e.return,v)}}break;case 6:if(fs(t,e),ps(e),4&r){if(null===e.stateNode)throw Error(a(162));l=e.stateNode,h=e.memoizedProps;try{l.nodeValue=h}catch(v){xc(e,e.return,v)}}break;case 3:if(fs(t,e),ps(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(v){xc(e,e.return,v)}break;case 4:default:fs(t,e),ps(e);break;case 13:fs(t,e),ps(e),8192&(l=e.child).flags&&null!==l.memoizedState&&(null===l.alternate||null===l.alternate.memoizedState)&&(Us=Xe()),4&r&&hs(e);break;case 22:if(l=null!==n&&null!==n.memoizedState,1&e.mode?(Gu=(h=Gu)||l,fs(t,e),Gu=h):fs(t,e),ps(e),8192&r){h=null!==e.memoizedState;e:for(f=null,d=e;;){if(5===d.tag){if(null===f){f=d;try{i=d.stateNode,h?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(s=d.stateNode,u=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",u))}catch(v){xc(e,e.return,v)}}}else if(6===d.tag){if(null===f)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(v){xc(e,e.return,v)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}if(h&&!l&&0!==(1&e.mode))for(Yu=e,e=e.child;null!==e;){for(l=Yu=e;null!==Yu;){switch(f=(h=Yu).child,h.tag){case 0:case 11:case 14:case 15:Zu(4,h,h.return);break;case 1:if(Ju(h,h.return),"function"===typeof(o=h.stateNode).componentWillUnmount){d=h,p=h.return;try{i=d,o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(v){xc(d,p,v)}}break;case 5:Ju(h,h.return);break;case 22:if(null!==h.memoizedState){gs(l);continue}}null!==f?(f.return=h,Yu=f):gs(l)}e=e.sibling}}break;case 19:fs(t,e),ps(e),4&r&&hs(e);case 21:}}function ps(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(rs(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(fe(i,""),r.flags&=-33),os(e,is(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;as(e,is(e),o);break;default:throw Error(a(161))}}catch(u){xc(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vs(e,t,n){Yu=e,ys(e,t,n)}function ys(e,t,n){for(var r=0!==(1&e.mode);null!==Yu;){var i=Yu,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Hu;if(!o){var u=i.alternate,s=null!==u&&null!==u.memoizedState||Gu;u=Hu;var c=Gu;if(Hu=o,(Gu=s)&&!c)for(Yu=i;null!==Yu;)s=(o=Yu).child,22===o.tag&&null!==o.memoizedState?ks(i):null!==s?(s.return=o,Yu=s):ks(i);for(;null!==a;)Yu=a,ys(a,t,n),a=a.sibling;Yu=i,Hu=u,Gu=c}ms(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Yu=a):ms(e)}}function ms(e){for(;null!==Yu;){var t=Yu;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Gu||es(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Gu)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Wi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ca(t,o,r);break;case 3:var u=t.updateQueue;if(null!==u){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ca(t,u,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&qt(f)}}}break;default:throw Error(a(163))}Gu||512&t.flags&&ts(t)}catch(d){xc(t,t.return,d)}}if(t===e){Yu=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yu=n;break}Yu=t.return}}function gs(e){for(;null!==Yu;){var t=Yu;if(t===e){Yu=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yu=n;break}Yu=t.return}}function ks(e){for(;null!==Yu;){var t=Yu;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{es(4,t)}catch(s){xc(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(s){xc(t,i,s)}}var a=t.return;try{ts(t)}catch(s){xc(t,a,s)}break;case 5:var o=t.return;try{ts(t)}catch(s){xc(t,o,s)}}}catch(s){xc(t,t.return,s)}if(t===e){Yu=null;break}var u=t.sibling;if(null!==u){u.return=t.return,Yu=u;break}Yu=t.return}}var ws,_s=Math.ceil,bs=w.ReactCurrentDispatcher,xs=w.ReactCurrentOwner,Is=w.ReactCurrentBatchConfig,Es=0,Ts=null,Ss=null,Cs=0,Ns=0,As=Ii(0),Ds=0,Ps=null,Rs=0,Os=0,Ls=0,Ms=null,Fs=null,Us=0,Vs=1/0,Bs=null,js=!1,qs=null,zs=null,Ws=!1,Ks=null,Hs=0,Gs=0,Qs=null,Ys=-1,Js=0;function Xs(){return 0!==(6&Es)?Xe():-1!==Ys?Ys:Ys=Xe()}function $s(e){return 0===(1&e.mode)?1:0!==(2&Es)&&0!==Cs?Cs&-Cs:null!==zi.transition?(0===Js&&(Js=vt()),Js):0!==(e=kt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function Zs(e,t,n){if(50<Gs)throw Gs=0,Qs=null,Error(a(185));var r=ec(e,t);return null===r?null:(mt(r,t,n),0!==(2&Es)&&r===Ts||(r===Ts&&(0===(2&Es)&&(Os|=t),4===Ds&&oc(r,Cs)),nc(r,n),1===t&&0===Es&&0===(1&e.mode)&&(Vs=Xe()+500,Vi&&qi())),r)}function ec(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function tc(e){return(null!==Ts||null!==ea)&&0!==(1&e.mode)&&0===(2&Es)}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),u=1<<o,s=i[o];-1===s?0!==(u&n)&&0===(u&r)||(i[o]=dt(u,t)):s<=t&&(e.expiredLanes|=u),a&=~u}}(e,t);var r=ft(e,e===Ts?Cs:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Vi=!0,ji(e)}(uc.bind(null,e)):ji(uc.bind(null,e)),oi((function(){0===Es&&qi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Ys=-1,Js=0,0!==(6&Es))throw Error(a(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ft(e,e===Ts?Cs:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Es;Es|=2;var o=dc();for(Ts===e&&Cs===t||(Bs=null,Vs=Xe()+500,hc(e,t));;)try{mc();break}catch(s){fc(e,s)}Yi(),bs.current=o,Es=i,null!==Ss?t=0:(Ts=null,Cs=0,t=Ds)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ic(e,i))),1===t)throw n=Ps,hc(e,0),oc(e,r),nc(e,Xe()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ur(a(),i))return!1}catch(u){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Ps,hc(e,0),oc(e,r),nc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Fs,Bs);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Us+500-Xe())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Xs(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wc.bind(null,e,Fs,Bs),t);break}wc(e,Fs,Bs);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var u=31-ot(r);o=1<<u,(u=t[u])>i&&(i=u),r&=~o}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_s(r/1960))-r)){e.timeoutHandle=ri(wc.bind(null,e,Fs,Bs),r);break}wc(e,Fs,Bs);break;default:throw Error(a(329))}}}return nc(e,Xe()),e.callbackNode===n?rc.bind(null,e):null}function ic(e,t){var n=Ms;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Fs,Fs=n,null!==t&&ac(t)),e}function ac(e){null===Fs?Fs=e:Fs.push.apply(Fs,e)}function oc(e,t){for(t&=~Ls,t&=~Os,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Es))throw Error(a(327));_c();var t=ft(e,0);if(0===(1&t))return nc(e,Xe()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Ps,hc(e,0),oc(e,t),nc(e,Xe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Fs,Bs),nc(e,Xe()),null}function sc(e,t){var n=Es;Es|=1;try{return e(t)}finally{0===(Es=n)&&(Vs=Xe()+500,Vi&&qi())}}function cc(e){null!==Ks&&0===Ks.tag&&0===(6&Es)&&_c();var t=Es;Es|=1;var n=Is.transition,r=kt;try{if(Is.transition=null,kt=1,e)return e()}finally{kt=r,Is.transition=n,0===(6&(Es=t))&&qi()}}function lc(){Ns=As.current,Ei(As)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ss)for(n=Ss.return;null!==n;){var r=n;switch(Na(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ri();break;case 3:eo(),Ei(Ni),Ei(Ci),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:Ei(ro);break;case 10:Ji(r.type._context);break;case 22:case 23:lc()}n=n.return}if(Ts=e,Ss=e=Pc(e.current,null),Cs=Ns=t,Ds=0,Ps=null,Ls=Os=Rs=0,Fs=Ms=null,null!==ea){for(t=0;t<ea.length;t++)if(null!==(r=(n=ea[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}ea=null}return e}function fc(e,t){for(;;){var n=Ss;try{if(Yi(),uo.current=nu,po){for(var r=lo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}po=!1}if(co=0,fo=ho=lo=null,vo=!1,yo=0,xs.current=null,null===n||null===n.return){Ds=1,Ps=t,Ss=null;break}e:{var o=e,u=n.return,s=n,c=t;if(t=Cs,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=s,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=vu(u);if(null!==p){p.flags&=-257,yu(p,u,s,0,t),1&p.mode&&pu(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break e}if(0===(1&t)){pu(o,l,t),pc();break e}c=Error(a(426))}else if(Pa&&1&s.mode){var m=vu(u);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),yu(m,u,s,0,t),ja(c);break e}}o=c,4!==Ds&&(Ds=2),null===Ms?Ms=[o]:Ms.push(o),c=ou(c,s),s=u;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,ua(s,fu(0,c,t));break e;case 1:o=c;var g=s.type,k=s.stateNode;if(0===(128&s.flags)&&("function"===typeof g.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===zs||!zs.has(k)))){s.flags|=65536,t&=-t,s.lanes|=t,ua(s,du(s,o,t));break e}}s=s.return}while(null!==s)}kc(n)}catch(w){t=w,Ss===n&&null!==n&&(Ss=n=n.return);continue}break}}function dc(){var e=bs.current;return bs.current=nu,null===e?nu:e}function pc(){0!==Ds&&3!==Ds&&2!==Ds||(Ds=4),null===Ts||0===(268435455&Rs)&&0===(268435455&Os)||oc(Ts,Cs)}function vc(e,t){var n=Es;Es|=2;var r=dc();for(Ts===e&&Cs===t||(Bs=null,hc(e,t));;)try{yc();break}catch(i){fc(e,i)}if(Yi(),Es=n,bs.current=r,null!==Ss)throw Error(a(261));return Ts=null,Cs=0,Ds}function yc(){for(;null!==Ss;)gc(Ss)}function mc(){for(;null!==Ss&&!Ye();)gc(Ss)}function gc(e){var t=ws(e.alternate,e,Ns);e.memoizedProps=e.pendingProps,null===t?kc(e):Ss=t,xs.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=ku(n,t,Ns)))return void(Ss=n)}else{if(null!==(n=Ku(n,t)))return n.flags&=32767,void(Ss=n);if(null===e)return Ds=6,void(Ss=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ss=t);Ss=t=e}while(null!==t);0===Ds&&(Ds=5)}function wc(e,t,n){var r=kt,i=Is.transition;try{Is.transition=null,kt=1,function(e,t,n,r){do{_c()}while(null!==Ks);if(0!==(6&Es))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Ts&&(Ss=Ts=null,Cs=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ws||(Ws=!0,Cc(tt,(function(){return _c(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Is.transition,Is.transition=null;var u=kt;kt=1;var s=Es;Es|=4,xs.current=null,function(e,t){if(ei=Wt,dr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var u=0,s=-1,c=-1,l=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==n||0!==i&&3!==f.nodeType||(s=u+i),f!==o||0!==r&&3!==f.nodeType||(c=u+r),3===f.nodeType&&(u+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===n&&++l===i&&(s=u),d===o&&++h===r&&(c=u),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Yu=t;null!==Yu;)if(e=(t=Yu).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yu=e;else for(;null!==Yu;){t=Yu;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var y=v.memoizedProps,m=v.memoizedState,g=t.stateNode,k=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:Wi(t.type,y),m);g.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=t.stateNode.containerInfo;if(1===w.nodeType)w.textContent="";else if(9===w.nodeType){var _=w.body;null!=_&&(_.textContent="")}break;default:throw Error(a(163))}}catch(b){xc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Yu=e;break}Yu=t.return}v=$u,$u=!1}(e,n),ds(n,e),pr(ti),Wt=!!ei,ti=ei=null,e.current=n,vs(n,e,i),Je(),Es=s,kt=u,Is.transition=o}else e.current=n;if(Ws&&(Ws=!1,Ks=e,Hs=i),0===(o=e.pendingLanes)&&(zs=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(js)throw js=!1,e=qs,qs=null,e;0!==(1&Hs)&&0!==e.tag&&_c(),0!==(1&(o=e.pendingLanes))?e===Qs?Gs++:(Gs=0,Qs=e):Gs=0,qi()}(e,t,n,r)}finally{Is.transition=i,kt=r}return null}function _c(){if(null!==Ks){var e=wt(Hs),t=Is.transition,n=kt;try{if(Is.transition=null,kt=16>e?16:e,null===Ks)var r=!1;else{if(e=Ks,Ks=null,Hs=0,0!==(6&Es))throw Error(a(331));var i=Es;for(Es|=4,Yu=e.current;null!==Yu;){var o=Yu,u=o.child;if(0!==(16&Yu.flags)){var s=o.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Yu=l;null!==Yu;){var h=Yu;switch(h.tag){case 0:case 11:case 15:Zu(8,h,o)}var f=h.child;if(null!==f)f.return=h,Yu=f;else for(;null!==Yu;){var d=(h=Yu).sibling,p=h.return;if(ns(h),h===l){Yu=null;break}if(null!==d){d.return=p,Yu=d;break}Yu=p}}}var v=o.alternate;if(null!==v){var y=v.child;if(null!==y){v.child=null;do{var m=y.sibling;y.sibling=null,y=m}while(null!==y)}}Yu=o}}if(0!==(2064&o.subtreeFlags)&&null!==u)u.return=o,Yu=u;else e:for(;null!==Yu;){if(0!==(2048&(o=Yu).flags))switch(o.tag){case 0:case 11:case 15:Zu(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Yu=g;break e}Yu=o.return}}var k=e.current;for(Yu=k;null!==Yu;){var w=(u=Yu).child;if(0!==(2064&u.subtreeFlags)&&null!==w)w.return=u,Yu=w;else e:for(u=k;null!==Yu;){if(0!==(2048&(s=Yu).flags))try{switch(s.tag){case 0:case 11:case 15:es(9,s)}}catch(b){xc(s,s.return,b)}if(s===u){Yu=null;break e}var _=s.sibling;if(null!==_){_.return=s.return,Yu=_;break e}Yu=s.return}}if(Es=i,qi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(b){}r=!0}return r}finally{kt=n,Is.transition=t}}return!1}function bc(e,t,n){aa(e,t=fu(0,t=ou(n,t),1)),t=Xs(),null!==(e=ec(e,1))&&(mt(e,1,t),nc(e,t))}function xc(e,t,n){if(3===e.tag)bc(e,e,n);else for(;null!==t;){if(3===t.tag){bc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===zs||!zs.has(r))){aa(t,e=du(t,e=ou(n,e),1)),e=Xs(),null!==(t=ec(t,1))&&(mt(t,1,e),nc(t,e));break}}t=t.return}}function Ic(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Xs(),e.pingedLanes|=e.suspendedLanes&n,Ts===e&&(Cs&n)===n&&(4===Ds||3===Ds&&(130023424&Cs)===Cs&&500>Xe()-Us?hc(e,0):Ls|=n),nc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=Xs();null!==(e=ec(e,t))&&(mt(e,t,n),nc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Sc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ec(e,n)}function Cc(e,t){return Ge(e,t)}function Nc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Nc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,i,o){var u=2;if(r=e,"function"===typeof e)Dc(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case x:return Oc(n.children,i,o,t);case I:u=8,i|=8;break;case E:return(e=Ac(12,n,t,2|i)).elementType=E,e.lanes=o,e;case N:return(e=Ac(13,n,t,i)).elementType=N,e.lanes=o,e;case A:return(e=Ac(19,n,t,i)).elementType=A,e.lanes=o,e;case R:return Lc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:u=10;break e;case S:u=9;break e;case C:u=11;break e;case D:u=14;break e;case P:u=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ac(u,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Oc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={},e}function Mc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,a,o,u,s){return e=new Uc(e,t,n,u,s),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ac(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},na(a),e}function Bc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function jc(e){if(!e)return Si;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Li(e,n,t)}return t}function qc(e,t,n,r,i,a,o,u,s){return(e=Vc(n,r,!0,e,0,a,0,u,s)).context=jc(null),n=e.current,(a=ia(r=Xs(),i=$s(n))).callback=void 0!==t&&null!==t?t:null,aa(n,a),e.current.lanes=i,mt(e,i,r),nc(e,r),e}function zc(e,t,n,r){var i=t.current,a=Xs(),o=$s(i);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ia(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),aa(i,t),null!==(e=Zs(i,o,a))&&oa(e,i,o),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}ws=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)_u=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _u=!1,function(e,t,n){switch(t.tag){case 3:Du(t),Ba();break;case 5:to(t);break;case 1:Pi(t.type)&&Mi(t);break;case 4:Za(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(Ki,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Mu(e,t,n):(Ti(ro,1&ro.current),null!==(e=Wu(e,t,n))?e.sibling:null);Ti(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return zu(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,Tu(e,t,n)}return Wu(e,t,n)}(e,t,n);_u=0!==(131072&e.flags)}else _u=!1,Pa&&0!==(1048576&t.flags)&&Sa(t,wa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=Di(t,Ci.current);$i(t,n),i=wo(null,t,r,e,i,n);var o=_o();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,na(t),i.updater=fa,t.stateNode=i,i._reactInternals=t,ya(t,r,e,n),t=Au(null,t,r,!0,o,n)):(t.tag=0,Pa&&o&&Ca(t),bu(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===D)return 14}return 2}(r),e=Wi(r,e),i){case 0:t=Cu(null,t,r,e,n);break e;case 1:t=Nu(null,t,r,e,n);break e;case 11:t=xu(null,t,r,e,n);break e;case 14:t=Iu(null,t,r,Wi(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Cu(e,t,r,i=t.elementType===r?i:Wi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Nu(e,t,r,i=t.elementType===r?i:Wi(r,i),n);case 3:e:{if(Du(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,ra(e,t),sa(t,r,null,n);var u=t.memoizedState;if(r=u.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pu(e,t,r,n,i=Error(a(423)));break e}if(r!==i){t=Pu(e,t,r,n,i=Error(a(424)));break e}for(Da=ci(t.stateNode.containerInfo.firstChild),Aa=t,Pa=!0,Ra=null,n=Ga(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Ba(),r===i){t=Wu(e,t,n);break e}bu(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&Fa(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,u=i.children,ni(r,i)?u=null:null!==o&&ni(r,o)&&(t.flags|=32),Su(e,t),bu(e,t,u,n),t.child;case 6:return null===e&&Fa(t),null;case 13:return Mu(e,t,n);case 4:return Za(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ha(t,null,r,n):bu(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xu(e,t,r,i=t.elementType===r?i:Wi(r,i),n);case 7:return bu(e,t,t.pendingProps,n),t.child;case 8:case 12:return bu(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,u=i.value,Ti(Ki,r._currentValue),r._currentValue=u,null!==o)if(ur(o.value,u)){if(o.children===i.children&&!Ni.current){t=Wu(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var s=o.dependencies;if(null!==s){u=o.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=ia(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Xi(o.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===o.tag)u=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(u=o.return))throw Error(a(341));u.lanes|=n,null!==(s=u.alternate)&&(s.lanes|=n),Xi(u,n,t),u=o.sibling}else u=o.child;if(null!==u)u.return=o;else for(u=o;null!==u;){if(u===t){u=null;break}if(null!==(o=u.sibling)){o.return=u.return,u=o;break}u=u.return}o=u}bu(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,$i(t,n),r=r(i=Zi(i)),t.flags|=1,bu(e,t,r,n),t.child;case 14:return i=Wi(r=t.type,t.pendingProps),Iu(e,t,r,i=Wi(r.type,i),n);case 15:return Eu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Wi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Pi(r)?(e=!0,Mi(t)):e=!1,$i(t,n),pa(t,r,i),ya(t,r,i,n),Au(null,t,r,!0,e,n);case 19:return zu(e,t,n);case 22:return Tu(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var u=i;i=function(){var e=Wc(o);u.call(e)}}zc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Wc(o);a.call(e)}}var o=qc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=o,e[pi]=o.current,qr(8===e.nodeType?e.parentNode:e),cc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var u=r;r=function(){var e=Wc(s);u.call(e)}}var s=Vc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=s,e[pi]=s.current,qr(8===e.nodeType?e.parentNode:e),cc((function(){zc(t,s,n,r)})),s}(n,t,e,i,r);return Wc(o)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));zc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){zc(null,e,null,null)})),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=It();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ft(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(gt(t,1|n),nc(t,Xe()),0===(6&Es)&&(Vs=Xe()+500,qi()))}break;case 13:var r=Xs();cc((function(){return Zs(e,1,r)})),Hc(e,1)}},bt=function(e){13===e.tag&&(Zs(e,134217728,Xs()),Hc(e,134217728))},xt=function(e){if(13===e.tag){var t=Xs(),n=$s(e);Zs(e,n,t),Hc(e,n)}},It=function(){return kt},Et=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},be=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(a(90));G(r),$(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=sc,Ne=cc;var el={usingClientEntryPoint:!1,Events:[ki,wi,_i,Te,Se,sc]},tl={findFiberByHostInstance:gi,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nl={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rl.isDisabled&&rl.supportsFiber)try{it=rl.inject(nl),at=rl}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(a(200));return Bc(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(a(299));var n=!1,r="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,qr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",u=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(u=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,i,0,o,u),e[pi]=t.current,qr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(a(40));return!!e._reactRootContainer&&(cc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=sc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,r)},t.version="18.1.0-next-22edb9f77-20220426"},250:function(e,t,n){var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:u.current}}t.jsx=c,t.jsxs=c},117:function(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function m(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}function g(){}function k(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var w=k.prototype=new g;w.constructor=k,v(w,m.prototype),w.isPureReactComponent=!0;var _=Array.isArray,b=Object.prototype.hasOwnProperty,x={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,a={},o=null,u=null;if(null!=t)for(i in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)b.call(t,i)&&!I.hasOwnProperty(i)&&(a[i]=t[i]);var s=arguments.length-2;if(1===s)a.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===a[i]&&(a[i]=s[i]);return{$$typeof:n,type:e,key:o,ref:u,props:a,_owner:x.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var S=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,a,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return o=o(s=e),e=""===a?"."+C(s,0):a,_(o)?(i="",null!=e&&(i=e.replace(S,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(s=0,a=""===a?".":a+":",_(e))for(var c=0;c<e.length;c++){var l=a+C(u=e[c],c);s+=N(u,t,i,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=N(u=u.value,t,i,l=a+C(u,c++),o);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function A(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},R={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:R,ReactCurrentOwner:x};t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=i,t.Profiler=o,t.PureComponent=k,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=x.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)b.call(t,c)&&!I.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];i.children=s}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:u}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.1.0"},791:function(e,t,n){e.exports=n(117)},184:function(e,t,n){e.exports=n(374)},813:function(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var u=2*(r+1)-1,s=e[u],c=u+1,l=e[c];if(0>a(s,n))c<i&&0>a(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[u]=n,r=u);else{if(!(c<i&&0>a(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var c=[],l=[],h=1,f=null,d=3,p=!1,v=!1,y=!1,m="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function _(e){if(y=!1,w(e),!v)if(null!==r(c))v=!0,R(b);else{var t=r(l);null!==t&&O(_,t.startTime-e)}}function b(e,n){v=!1,y&&(y=!1,g(T),T=-1),p=!0;var a=d;try{for(w(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!N());){var o=f.callback;if("function"===typeof o){f.callback=null,d=f.priorityLevel;var u=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?f.callback=u:f===r(c)&&i(c),w(n)}else i(c);f=r(c)}if(null!==f)var s=!0;else{var h=r(l);null!==h&&O(_,h.startTime-n),s=!1}return s}finally{f=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,I=!1,E=null,T=-1,S=5,C=-1;function N(){return!(t.unstable_now()-C<S)}function A(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?x():(I=!1,E=null)}}else I=!1}if("function"===typeof k)x=function(){k(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,P=D.port2;D.port1.onmessage=A,x=function(){P.postMessage(null)}}else x=function(){m(A,0)};function R(e){E=e,I||(I=!0,x())}function O(e,n){T=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,R(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var n=d;d=t;try{return e()}finally{d=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=d;d=e;try{return t()}finally{d=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:u=a+u,sortIndex:-1},a>o?(e.sortIndex=a,n(l,e),null===r(c)&&e===r(l)&&(y?(g(T),T=-1):y=!0,O(_,a-o))):(e.sortIndex=u,n(c,e),v||p||(v=!0,R(b))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n}}}},296:function(e,t,n){e.exports=n(813)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={};n.r(e),n.d(e,{FirebaseError:function(){return oe},SDK_VERSION:function(){return Et},_DEFAULT_ENTRY_NAME:function(){return ft},_addComponent:function(){return yt},_addOrOverwriteComponent:function(){return mt},_apps:function(){return pt},_clearComponents:function(){return _t},_components:function(){return vt},_getProvider:function(){return kt},_registerComponent:function(){return gt},_removeServiceInstance:function(){return wt},deleteApp:function(){return Nt},getApp:function(){return St},getApps:function(){return Ct},initializeApp:function(){return Tt},onLog:function(){return Pt},registerVersion:function(){return Dt},setLogLevel:function(){return Rt}});var t=n(791),r=n(250);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function o(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function u(e){return function(e){if(Array.isArray(e))return i(e)}(e)||a(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){if(Array.isArray(e))return e}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){return s(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(s){u=!0,i=s}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(e,t)||o(e,t)||c()}var h=n(184);var f=function(e){function t(t){e.setFiltrName(t.target.textContent)}return(0,h.jsxs)("div",{className:e.leftMenu_acvive?"LeftSide":"LeftSideClose",children:[(0,h.jsxs)("div",{className:"Header",children:[(0,h.jsx)("div",{className:"Name",children:"Denis Matsenko"}),(0,h.jsx)("div",{className:"Email",children:"denismatsenko@gmail.com"})]}),(0,h.jsx)("div",{className:"Line"}),(0,h.jsxs)("div",{className:"Filtr",children:[(0,h.jsx)("div",{className:"FiltrText",children:"Filtr"}),(0,h.jsxs)("div",{className:"FiltrList",children:[(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"All"})]})}),(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"By marks"})]})}),(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"By date"})]})}),(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"Important"})]})}),(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"Complete"})]})}),(0,h.jsx)("div",{className:"FiltrItem",children:(0,h.jsxs)("button",{onClick:t,className:"FilBtn",children:[(0,h.jsx)("div",{className:"Ti2"}),(0,h.jsx)("div",{children:"Uncomplete"})]})})]})]}),(0,h.jsx)("div",{className:"Line"}),(0,h.jsxs)("div",{className:"Footer",children:[(0,h.jsx)("div",{onClick:e.ClickOptBtn,className:"WBtnOpt",children:(0,h.jsx)("button",{className:"BtnOpt",children:"P"})}),(0,h.jsx)("div",{onClick:e.ClickOptBtn,className:"WBtnOpt",children:(0,h.jsx)("button",{className:"BtnOpt",children:"S"})}),(0,h.jsx)("div",{onClick:e.ClickOptBtn,className:"WBtnOpt",children:(0,h.jsx)("button",{className:"BtnOpt",children:"T"})})]})]})};var d=function(e){return(0,h.jsxs)("div",{className:e.done?"ItemOff":"Item",children:[(0,h.jsx)("div",{onClick:function(){e.DoneUdate(e)},className:"DoneBreaker",children:(0,h.jsx)("div",{className:"Ti",children:(0,h.jsx)("img",{className:"DoneSwitherImg",src:e.done?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAAEZ0lEQVR4nO1b/3UaMQxWb4G0E4QNQBOETtB0AhiBETICGzRM0GSCHhMYNiATtEyQPt+TiTGSf9zZBkq/9/gj4Tjr+2xLtix/en9/h5JAxCkA6M8EAEYAMA40twWAHQBsAKBVSrUl7csuACJ+BoBH+nzL9NpXAHjRH6XUn0zv7JBNAETUPbwAgFmWF8pYAcBzrpExWAAa4k8A8JDDoASsdbtDhegtAA31ZYUeD0GPiEXfqdFLAETU8/sZAO4if7I3To0c3E54bkQf4zRT3j9XSr1EPn9AsgCI+BzZ62/kuPR83aQaBh9+ZU4O9T7iJyul1DyljWgBaMi3EWFMz81ln94ItP9ITjbka3QYncZOiSgBEHFEvekjv6W5WDRuk9NdRtgSJUJQAOr5nWc+7skbL0ON5QQiLij6+OwahURoIsi3nkaM0lXJa1CbU7KBg7a5JQ4ivAIE5vyKyPdycDlAbU/JFg5j4iBCnAIBb5/sbUujr72sAORxf14LeYOACN+5yHQiQMDpXSx5A48IrFPkfMBSIL+lOHzpWAiO8Y64HeFoBFCM/SWod1aHlwJaQUrR66u9VnFHwJPQztO1kIeP6CBysf84jABP72+VUpMShpYGIm6EMI6mQ+0RIDm3a5j3muycHKANyfbD/7sRQJ7/N/PgWik1LWJxRmjyAPCD3ngUqRCxFTZQX3REMCPgUTCn+hI3FQ55jZkzEiQOHWefAG+5t7S5wZA3mNF3QBzeQgJw2dtrJQ80DexRwHHpODfk/Tm4DuViEEHedegsF829od2Ui/2lxv0e5M26YM883wnAxXgveb3SCu2zS6AP+QCnSUNZWBfiHtpaZgaTDTkxkDwInEaNsFJi09bOGntcS4QM5EHgNJYyQicPCxuM4iJkIg9Sp4ZSYu4LWBVLiZCRvIhoASiRICUhs4tQg7yGJACbSq4lQi3yGpIAIonSItQkr5HiAw4oJUJt8hqSANza4Ai5RahAnuXUCASCAkBGESr1PMdp2wihLToJMlSEisOe47RrpDVyypv7ilB5zrN7nkZYI9/Ryi8aqSLUJE9cuBR523jO85MNiBXhDN6efZ/mbqLAK/O9lCf0IkKETe1QJ3DpOBsBuJTRPR2SJiMgglTrU4Q8ceDa7Dj7BIAhZwIBEVyUPHSVOHwIQMZyRQYPnpxhEJEiFCNPtnNnAitzSmyvBKX8+aCzgYAIpY/bg5wOAlDicM08PKaCpN4QRChKnmzmsl1rO+EbfTqcui5w4YhQmvwk+XTY+rFUYZFUgHguBAo6T4TndoMLIYc+voazQk8R5Z6LCCcCUA9Lw9M9eLwoBIqk5tzoZfMBdKAo1d5dpAgRZXLsWsdbKuupsIChdfq5EHFvwVvhEkqJ+RYxM9rcnK18xjqrEMmHchteAazQxTlFsHZ41ctoqE1fKe8+JmrFlsvH3BX4N8vlrYZv98KEY8htXplxDLvdS1MGN31tzsbNXpx0Ufnq7DJXDdP/y9M3fX0eAP4Cg1vd9lERRUwAAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAAC7klEQVR4nO1b7XHDIAwVLNBs0GwQj5AN6hEyQkbpCBkh3cAjuBt4hGYC9Uhw4roSHzY4BqI7/sSO0HsIgYUQiAgxRQixBwDVKgDYAsDO0t03AHQA0AJAg4hNVPtCEyCE2ABArdtHILVfAHBWDRF/Aum8iSIgRNMjfFIqIzfVxz6Y3bMV3Ny7WQD4uDUhiJgDfLPQiNuasmEzFcekGCCEqHXHb45/ufRBTQe4jnlvq1sfNH30HxDx7Pj+QyaMvOuoK5CfCsgML6u0js7VG6JNAe3yrePcrEMFqUH/tWOsaX2mhGvnWwfwbcjobLBl72iLEwmuI/9j6Ew9O8YGTth1dLDLSsJct2/nzPEAJFQO9hlJsHVgUj5r+QlIgm05bicRYFHqHW0XIGKSvZyyOiXwjiSQKxPnUlxwWS14BxLIoOijwGt9fSIBpsD9bwDHf94b2HtatJ9AQmXw4j97lfEfuZ3W4ut8ABKO3E6VJMAw+sZlZOUkcFPh7s1y8F10YL6Xjt5fWOsRzvbH7/gIHFZ3SdQLuGl9Dei9B9QMU58Jj34vHIYbZs3SmWCoS330B15A5RNUgvXuAVT21j+7sl6hsFwxS523p+SUEQEkFoVd6uVvLBdEbBc1MaJoLBeihysBFfEgG/ADoTBVUqe7xhL1OOpJQmHaSuasjktbpywUpp1kAJVCAHAEFCMvApjfwx5Br1g4AjalE1CMcARQe4PUhcQkdU1OqQR8S2Z95D6QUhYKUye5PXKGBJDfPJLZI78JIbIhQWOhqk0aaajD45KkKQqJRWHvV4Ev4jmXJ0xRKCxXzD0BVMroXRdDJS0awzuB4Ya59LT48EXuUDR63U9E8Nxp1/2QdPhyVeLRmKu75H84anGZMo7HsfQCiYGCcktksPQiKUdleZfJDZSWWyiJ9oCC2ZfKoj0oYtbF0h6egNmWy3uSgFlemBgZktWVmdelqRmjk8W1uVBBqbyLk8x8XerqbLC9R/GXp8u+Pg8Avwn7WswFZY8nAAAAAElFTkSuQmCC"})})}),(0,h.jsxs)("div",{className:"ItemContent",children:[(0,h.jsx)("div",{className:e.done?"ItemTextOff":"ItemText",children:(0,h.jsx)("div",{children:e.text})}),(0,h.jsx)("div",{className:e.done?"ItemDateOff":"ItemDate",children:(0,h.jsx)("div",{children:e.marks})})]}),(0,h.jsx)("div",{onClick:function(){e.RemoveFromDB(e)},className:"BinWrapper",children:(0,h.jsx)("div",{className:"Ti",children:(0,h.jsx)("img",{className:"DoneSwitherImg",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAB2AAAAdgB+lymcgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAALISURBVHic7Zs9bxNBEIYfgyUKAhhQUhDRICEBCh0fgkhBNIT8gPwZ6Gig5y8QCUhH5AqE3EZJgQRKEDSpKEAQkTMdcijGRvi8Z+/e3eze4X2kKe40t/Pu+LRfN4bIdNNQbLsJ3ATOFWznC7AJ/C6syCMngC3gsCTb7LdZGx5SXucH9kBD6BGNRoGrNWlTLQEa7R5VaFMtAbXBZwLWkVnHxtZ9iZr6N6Bp6TcHXAOOW/qfz7i36un5X8A28NXSfywrQJfypzVtS4D7ZSRgpwKdyWsfJnXOZincxf7VrxoJcHKcg80g2ClFShg6ZTQyD2xQr3GgC7yi+EYs8t+TZ329gKwJfiLzbRU4Cywh/fmuGegpw/PssmYwS5aAfURTD3ikFegKo4PNe61gDrxjWFMPuGj7sMte4JLh3mWH57VYSF03cDg7cEmAabxQ2aM7UkjX1O8GfSRgHmgjM8YO4wfOFWC379umYguZVcyrrkm0U/4JMGvwm2N0tblh0b5Jk+222csbcCd1PYOsI9KYzhvuqij6Bx8JMO0kZyz91HehcRAMLSA0MQGhBYQmJiC0gNDEBIQWEJqYgNACQhMTEFpAaGICQgsITUxAaAGhiQnwEMP0+axr6af+6c1HAjqp6wQpo02zxWhi3moIykveU+FBfUGCfEq7N8Z3GSlrSbD/vl/oVNiFvAnQpvLH4pUmJsDBN2tEDlnHn1UBZppljLgkYC/j/i2HNspmMeP+nkawY8ABowPOa41gFjSQaTKt5wDRqsKaIeAh8Bjd/x+laQBPMrQ80wy8iJSgmAK/QWpzW4rxW8gndNMvPyiPua0YH4DnGcGrYGuK/f7LGeBjgM5Nsl3gtGK/h7gAfFbukIt96mvySgt4WVB4UesBL4BTyn0dy42+iEGxog/bR8ai60XFlzl1NZFiyllknNDgB/ANKbaq1V9pI1XlD82w8ru3YIVHAAAAAElFTkSuQmCC"})})})]})};var p=function(e){return(0,h.jsxs)("div",{className:"Box",children:[(0,h.jsx)("div",{className:"NameOfIventList",children:e.name}),(0,h.jsx)("div",{className:"ItemsList",children:e.post.map((function(t){return(0,h.jsx)(d,{text:t.text,marks:t.marks,id:t.id,done:t.done,RemoveFromDB:e.RemoveFromDB,DoneUdate:e.DoneUdate},t.id)}))})]})};function v(e){var t=["Today","Tomorrow","Everyday","Important","Work","Home","Hobby"],n=function(){for(var e=[],n=0;n<t.length;n++)document.getElementById(t[n]).classList.contains("MarkBtnActive")&&(e=[].concat(u(e),[t[n]+" "]));return e},r=function(e){var t=document.getElementById(e);t.classList.contains("MarkBtnActive")?(t.classList.remove("MarkBtnActive"),t.classList.add("MarkBtn")):(t.classList.remove("MarkBtn"),t.classList.add("MarkBtnActive"))};return(0,h.jsx)("div",{className:"MarkBtnWrapper",children:(0,h.jsx)("button",{onClick:function(){if("Everyday"===e.markName)r(e.markName),(t=document.getElementById("Today")).classList.contains("MarkBtnActive")&&(t.classList.remove("MarkBtnActive"),t.classList.add("MarkBtn")),(t=document.getElementById("Tomorrow")).classList.contains("MarkBtnActive")&&(t.classList.remove("MarkBtnActive"),t.classList.add("MarkBtn"));else if("Today"===e.markName||"Tomorrow"===e.markName){var t;r(e.markName),(t=document.getElementById("Everyday")).classList.contains("MarkBtnActive")&&(t.classList.remove("MarkBtnActive"),t.classList.add("MarkBtn"))}else r(e.markName);e.AddMarksToPost(n)},id:e.markName,className:"MarkBtn",children:e.markName})})}var y=function(e){return(0,h.jsxs)("div",{className:"RightSide",children:[(0,h.jsx)("div",{className:"DivForBtn",children:(0,h.jsx)("div",{className:"WLMBtn",onClick:function(){e.setLeftMenu_acvive(!e.leftMenu_acvive)},children:(0,h.jsx)("div",{className:"CloseBtn",children:(0,h.jsx)("img",{className:e.leftMenu_acvive?"AimgL":"AimgR",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAC9SURBVDhPlZMBDcIwEEXHDIADkEBSASBhDpgDJgEJ4AAJGKkGkAAKyvuXNqFL2bqXXP56yevarluFEJoleO8vRFctInTEldpqPCsi7AkJB2tE/ooIG0LLOltjRBszA2kgXlRREtkbEY7EnbJ9TGEiwo5nCdk+pmiRevJJVUtCe3xTHxstoHXOPUgt9WadSsaHU73X4nesOd2imGACXQB907U1fpgUBbJukK7cyRqRWTHBBNmdrRYTTMBf0vRfLDFYIYqsHGQAAAAASUVORK5CYII="})})})}),(0,h.jsx)("div",{className:"RightWrapper",children:(0,h.jsxs)("div",{className:"RightContent",children:[(0,h.jsx)("div",{className:"EmptyBox"}),(0,h.jsx)("div",{className:e.leftMenu_acvive?"BoxList":"BoxListBig",children:e.filtrBoxes}),(0,h.jsx)("div",{className:"EmptyBoxEnd"})]})})]})};function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e){return(0,h.jsx)("div",{className:"BtnBig",children:(0,h.jsx)("button",{onClick:e.fun,className:"Btn",children:e.text})})}var _=function(e){var n=l((0,t.useState)({id:"",text:"",marks:[]}),2),r=n[0],i=n[1];function a(t){i({id:"",text:"",marks:[]}),!0===t?(console.log("go"),e.setMarksArr(e.marks.map((function(t){return(0,h.jsx)(v,{marks:e.marks,AddMarksToPost:e.AddMarksToPost,bool:!1,markName:t.mark},t.key)})))):e.setMarksArr([]),e.setAddPostWind_active(t)}function o(){var t={id:Date.now(),text:r.text,done:!1,marks:e.myAddMark};console.log(e.myAddMark+"\u043f\u0435\u0440\u0435\u0434 \u043e\u0442\u043f\u0440"),""!==t.text&&e.AddPostToPosts(t),a(!1)}return(0,t.useEffect)((function(){var t=function(t){console.log(t.code),"Enter"===t.key&&e.AddPostWind_active?o():"Enter"!==t.key||e.AddPostWind_active||a(!0)};return document.getElementById("input").focus(),document.addEventListener("keypress",t),function(){document.removeEventListener("keypress",t)}})),(0,h.jsx)("div",{className:e.AddPostWind_active?"AddPostWind":"AddPostWindNone",onClick:function(e){"AddPostWind"===e.target.className&&a(!1)},children:(0,h.jsxs)("div",{className:"APWContent",children:[(0,h.jsxs)("div",{className:"TextInputWrapper",children:[(0,h.jsx)("div",{className:"Titule",children:"Task"}),(0,h.jsx)("input",{placeholder:"Enter your task here:",className:"TaskInput",id:"input",maxLength:35,value:r.text,onChange:function(e){return i(k(k({},r),{},{text:e.target.value}))},type:"text"})]}),(0,h.jsxs)("div",{className:"MarksWrapper",children:[(0,h.jsx)("div",{className:"Titule",children:"Marks"}),(0,h.jsx)("div",{className:"BtnsList",children:e.marksArr})]}),(0,h.jsxs)("div",{className:"FooterWrapper",children:[(0,h.jsx)(w,{fun:function(){a(!1)},text:"Cancel"}),(0,h.jsx)(w,{fun:o,text:"Add"})]})]})})};function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function x(){x=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(C){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),o=new E(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return S()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=w(o,n);if(u){if(u===l)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=c(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=s;var l={};function h(){}function f(){}function d(){}var p={};u(p,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==t&&n.call(y,i)&&(p=y);var m=d.prototype=h.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(i,a,o,u){var s=c(e[i],e,a);if("throw"!==s.type){var l=s.arg,h=l.value;return h&&"object"==b(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,u)}),(function(e){r("throw",e,o,u)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,u)}))}u(s.arg)}var i;this._invoke=function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=d,u(m,"constructor",d),u(d,"constructor",f),f.displayName=u(d,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new k(s(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(m),u(m,o,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function I(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(dn){return void n(dn)}u.done?t(s):Promise.resolve(s).then(r,i)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){I(a,r,i,o,u,"next",e)}function u(e){I(a,r,i,o,u,"throw",e)}o(void 0)}))}}function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t,n){return t&&C(e.prototype,t),n&&C(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D(e,t)}function P(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function O(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function L(e,t){if(t&&("object"===b(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function M(e){var t=O();return function(){var n,r=R(e);if(t){var i=R(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return L(this,n)}}function F(e,t,n){return F=O()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&D(i,n.prototype),i},F.apply(null,arguments)}function U(e){var t="function"===typeof Map?new Map:void 0;return U=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return F(e,arguments,R(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),D(n,e)},U(e)}var V=!1,B=!1,j="${JSCORE_VERSION}",q=function(e,t){if(!e)throw z(t)},z=function(e){return new Error("Firebase Database ("+j+") INTERNAL ASSERT FAILED: "+e)},W=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},K={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(W(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},H=function(e){var t=W(e);return K.encodeByteArray(t,!0)},G=function(e){return H(e).replace(/\./g,"")},Q=function(e){try{return K.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Y(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Y(e[n],t[n]));return e}var J=function(){function e(){var t=this;S(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return N(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function X(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[G(JSON.stringify({alg:"none",type:"JWT"})),G(JSON.stringify(a)),""].join(".")}function $(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Z(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($())}function ee(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function te(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function ne(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function re(){var e=$();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ie(){return!0===V||!0===B}function ae(){return"object"===typeof indexedDB}var oe=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(A(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(A(a),ue.prototype.create),a}return N(n)}(U(Error)),ue=function(){function e(t,n,r){S(this,e),this.service=t,this.serviceName=n,this.errors=r}return N(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?se(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,")."),o=new oe(n,a,t);return o}}]),e}();function se(e,t){return e.replace(ce,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var ce=/\{\$([^}]+)}/g;function le(e){return JSON.parse(e)}function he(e){return JSON.stringify(e)}var fe=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=le(Q(a[0])||""),n=le(Q(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function de(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function pe(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function ve(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function ye(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function me(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var u=e[o],s=t[o];if(ge(u)&&ge(s)){if(!me(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function ge(e){return null!==e&&"object"===typeof e}function ke(e){for(var t=[],n=function(){var e=l(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function we(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=l(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function _e(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var be=function(){function e(){S(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return N(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var u,s,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(u=f^l&(h^f),s=1518500249):(u=l^h^f,s=1859775393):p<60?(u=l&h|f&(l|h),s=2400959708):(u=l^h^f,s=3395469782);var v=(c<<5|c>>>27)+u+d+s+n[p]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=v}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}();function xe(e,t){var n=new Ie(e,t);return n.subscribe.bind(n)}var Ie=function(){function e(t,n){var r=this;S(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return N(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=T(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Ee),void 0===r.error&&(r.error=Ee),void 0===r.complete&&(r.complete=Ee);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function Ee(){}var Te=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Se(e,t){return"".concat(e," failed: ").concat(t," argument ")}function Ce(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(Se(e,t)+"must be a valid function.")}function Ne(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(Se(e,t)+"must be a valid context object.")}var Ae=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function De(e){return e&&e._delegate?e._delegate:e}var Pe=function(){function e(t,n,r){S(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return N(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Re="[DEFAULT]",Oe=function(){function e(t,n){S(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return N(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new J;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Re})}catch(s){}var t,n=T(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=l(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var u=this.getOrInitializeService({instanceIdentifier:o});a.resolve(u)}catch(s){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(u(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),u(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=T(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var u=l(i.value,2),s=u[0],c=u[1],h=this.normalizeInstanceIdentifier(s);r===h&&c.resolve(a)}}catch(f){o.e(f)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(SA){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Re?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(SA){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re;return this.component?this.component.multipleInstances?e:Re:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var Le,Me,Fe=function(){function e(t){S(this,e),this.name=t,this.providers=new Map}return N(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Oe(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),Ue=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Me||(Me={}));var Ve={debug:Me.DEBUG,verbose:Me.VERBOSE,info:Me.INFO,warn:Me.WARN,error:Me.ERROR,silent:Me.SILENT},Be=Me.INFO,je=(m(Le={},Me.DEBUG,"log"),m(Le,Me.VERBOSE,"log"),m(Le,Me.INFO,"info"),m(Le,Me.WARN,"warn"),m(Le,Me.ERROR,"error"),Le),qe=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=je[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},ze=function(){function e(t){S(this,e),this.name=t,this._logLevel=Be,this._logHandler=qe,this._userLogHandler=null,Ue.push(this)}return N(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Me))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Ve[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Me.DEBUG].concat(t)),this._logHandler.apply(this,[this,Me.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Me.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Me.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Me.INFO].concat(t)),this._logHandler.apply(this,[this,Me.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Me.WARN].concat(t)),this._logHandler.apply(this,[this,Me.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Me.ERROR].concat(t)),this._logHandler.apply(this,[this,Me.ERROR].concat(t))}}]),e}();var We,Ke;var He=new WeakMap,Ge=new WeakMap,Qe=new WeakMap,Ye=new WeakMap,Je=new WeakMap;var Xe={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ge.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Qe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return et(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function $e(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ke||(Ke=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(tt(this),n),et(He.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return et(e.apply(tt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[tt(this),t].concat(r));return Qe.set(a,t.sort?t.sort():[t]),et(a)}}function Ze(e){return"function"===typeof e?$e(e):(e instanceof IDBTransaction&&function(e){if(!Ge.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Ge.set(e,t)}}(e),t=e,(We||(We=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,Xe):e);var t}function et(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(et(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((function(t){t instanceof IDBCursor&&He.set(t,e)})).catch((function(){})),Je.set(t,e),t}(e);if(Ye.has(e))return Ye.get(e);var t=Ze(e);return t!==e&&(Ye.set(e,t),Je.set(t,e)),t}var tt=function(e){return Je.get(e)};var nt,rt,it=["get","getKey","getAll","getAllKeys","count"],at=["put","add","delete","clear"],ot=new Map;function ut(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(ot.get(t))return ot.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=at.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||it.includes(n))){var a=function(){var e=E(x().mark((function e(t){var a,o,u,s,c,l,h=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),u=o.store,s=h.length,c=new Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=h[l];return r&&(u=u.index(c.shift())),e.next=6,Promise.all([(a=u)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return ot.set(t,a),a}}}Xe=function(e){return k(k({},e),{},{get:function(t,n,r){return ut(t,n)||e.get(t,n,r)},has:function(t,n){return!!ut(t,n)||e.has(t,n)}})}(Xe);var st=function(){function e(t){S(this,e),this.container=t}return N(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var ct="@firebase/app",lt="0.7.27",ht=new ze("@firebase/app"),ft="[DEFAULT]",dt=(m(nt={},ct,"fire-core"),m(nt,"@firebase/app-compat","fire-core-compat"),m(nt,"@firebase/analytics","fire-analytics"),m(nt,"@firebase/analytics-compat","fire-analytics-compat"),m(nt,"@firebase/app-check","fire-app-check"),m(nt,"@firebase/app-check-compat","fire-app-check-compat"),m(nt,"@firebase/auth","fire-auth"),m(nt,"@firebase/auth-compat","fire-auth-compat"),m(nt,"@firebase/database","fire-rtdb"),m(nt,"@firebase/database-compat","fire-rtdb-compat"),m(nt,"@firebase/functions","fire-fn"),m(nt,"@firebase/functions-compat","fire-fn-compat"),m(nt,"@firebase/installations","fire-iid"),m(nt,"@firebase/installations-compat","fire-iid-compat"),m(nt,"@firebase/messaging","fire-fcm"),m(nt,"@firebase/messaging-compat","fire-fcm-compat"),m(nt,"@firebase/performance","fire-perf"),m(nt,"@firebase/performance-compat","fire-perf-compat"),m(nt,"@firebase/remote-config","fire-rc"),m(nt,"@firebase/remote-config-compat","fire-rc-compat"),m(nt,"@firebase/storage","fire-gcs"),m(nt,"@firebase/storage-compat","fire-gcs-compat"),m(nt,"@firebase/firestore","fire-fst"),m(nt,"@firebase/firestore-compat","fire-fst-compat"),m(nt,"fire-js","fire-js"),m(nt,"firebase","fire-js-all"),nt),pt=new Map,vt=new Map;function yt(e,t){try{e.container.addComponent(t)}catch(n){ht.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function mt(e,t){e.container.addOrOverwriteComponent(t)}function gt(e){var t=e.name;if(vt.has(t))return ht.debug("There were multiple attempts to register component ".concat(t,".")),!1;vt.set(t,e);var n,r=T(pt.values());try{for(r.s();!(n=r.n()).done;){yt(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function kt(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function wt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ft;kt(e,t).clearInstance(n)}function _t(){vt.clear()}var bt=(m(rt={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),m(rt,"bad-app-name","Illegal App name: '{$appName}"),m(rt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),m(rt,"app-deleted","Firebase App named '{$appName}' already deleted"),m(rt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),m(rt,"invalid-log-argument","First argument to `onLog` must be null or a function."),m(rt,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),m(rt,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),m(rt,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),m(rt,"storage-delete","Error thrown when deleting from storage. Original error: {$originalErrorMessage}."),rt),xt=new ue("app","Firebase",bt),It=function(){function e(t,n,r){var i=this;S(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Pe("app",(function(){return i}),"PUBLIC"))}return N(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw xt.create("app-deleted",{appName:this._name})}}]),e}(),Et="9.8.4";function Tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==typeof t){var n=t;t={name:n}}var r=Object.assign({name:ft,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw xt.create("bad-app-name",{appName:String(i)});var a=pt.get(i);if(a){if(me(e,a.options)&&me(r,a.config))return a;throw xt.create("duplicate-app",{appName:i})}var o,u=new Fe(i),s=T(vt.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u.addComponent(c)}}catch(h){s.e(h)}finally{s.f()}var l=new It(e,r,u);return pt.set(i,l),l}function St(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=pt.get(e);if(!t)throw xt.create("no-app",{appName:e});return t}function Ct(){return Array.from(pt.values())}function Nt(e){return At.apply(this,arguments)}function At(){return At=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!pt.has(n)){e.next=6;break}return pt.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)}))),At.apply(this,arguments)}function Dt(e,t,n){var r,i=null!==(r=dt[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ht.warn(u.join(" "))}gt(new Pe("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function Pt(e,t){if(null!==e&&"function"!==typeof e)throw xt.create("invalid-log-argument");!function(e,t){var n,r=T(Ue);try{var i=function(){var r=n.value,i=null;t&&t.level&&(i=Ve[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var u=a.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==i&&void 0!==i?i:t.logLevel)&&e({level:Me[n].toLowerCase(),message:u,args:a,type:t.name})}};for(r.s();!(n=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}(e,t)}function Rt(e){var t;t=e,Ue.forEach((function(e){e.setLogLevel(t)}))}var Ot="firebase-heartbeat-store",Lt=null;function Mt(){return Lt||(Lt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=et(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(et(u.result),e.oldVersion,e.newVersion,et(u.transaction))})),r&&u.addEventListener("blocked",(function(){return r()})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),s}("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(Ot)}}).catch((function(e){throw xt.create("storage-open",{originalErrorMessage:e.message})}))),Lt}function Ft(e){return Ut.apply(this,arguments)}function Ut(){return Ut=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mt();case 3:return r=e.sent,e.abrupt("return",r.transaction(Ot).objectStore(Ot).get(jt(t)));case 7:throw e.prev=7,e.t0=e.catch(0),xt.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Ut.apply(this,arguments)}function Vt(e,t){return Bt.apply(this,arguments)}function Bt(){return Bt=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mt();case 3:return i=e.sent,a=i.transaction(Ot,"readwrite"),o=a.objectStore(Ot),e.next=8,o.put(n,jt(t));case 8:return e.abrupt("return",a.done);case 11:throw e.prev=11,e.t0=e.catch(0),xt.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),Bt.apply(this,arguments)}function jt(e){return"".concat(e.name,"!").concat(e.options.appId)}var qt=function(){function e(t){var n=this;S(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Ht(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return N(e,[{key:"triggerHeartbeat",value:function(){var e=E(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=zt(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=E(x().mark((function e(){var t,n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=zt(),n=Wt(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=G(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function zt(){return(new Date).toISOString().substring(0,10)}function Wt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=T(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),Gt(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),Gt(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var u=o();if("break"===u)break}}catch(s){a.e(s)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var Kt,Ht=function(){function e(t){S(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return N(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ae()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(dn){t(dn)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Ft(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Vt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Vt(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(u(r.heartbeats),u(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Gt(e){return G(JSON.stringify({version:2,heartbeats:e})).length}Kt="",gt(new Pe("platform-logger",(function(e){return new st(e)}),"PRIVATE")),gt(new Pe("heartbeat",(function(e){return new qt(e)}),"PRIVATE")),Dt(ct,lt,Kt),Dt(ct,lt,"esm2017"),Dt("fire-js","");Dt("firebase","9.8.4","app");var Qt="@firebase/database",Yt="0.13.2",Jt="";function Xt(e){Jt=e}var $t=function(){function e(t){S(this,e),this.domStorage_=t,this.prefix_="firebase:"}return N(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),he(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:le(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),Zt=function(){function e(){S(this,e),this.cache_={},this.isInMemoryStorage=!0}return N(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return de(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),en=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new $t(t)}}catch(n){}return new Zt},tn=en("localStorage"),nn=en("sessionStorage"),rn=new ze("@firebase/database"),an=function(){var e=1;return function(){return e++}}(),on=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,q(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new be;n.update(t);var r=n.digest();return K.encodeByteArray(r)},un=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?he(r):r,t+=" "}return t},sn=null,cn=!0,ln=function(e,t){q(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(rn.logLevel=Me.VERBOSE,sn=rn.log.bind(rn),t&&nn.set("logging_enabled",!0)):"function"===typeof e?sn=e:(sn=null,nn.remove("logging_enabled"))},hn=function(){if(!0===cn&&(cn=!1,null===sn&&!0===nn.get("logging_enabled")&&ln(!0)),sn){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=un.apply(null,t);sn(r)}},fn=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];hn.apply(void 0,[e].concat(n))}},dn=function(){var e="FIREBASE INTERNAL ERROR: "+un.apply(void 0,arguments);rn.error(e)},pn=function(){var e="FIREBASE FATAL ERROR: ".concat(un.apply(void 0,arguments));throw rn.error(e),new Error(e)},vn=function(){var e="FIREBASE WARNING: "+un.apply(void 0,arguments);rn.warn(e)},yn=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},mn="[MIN_NAME]",gn="[MAX_NAME]",kn=function(e,t){if(e===t)return 0;if(e===mn||t===gn)return-1;if(t===mn||e===gn)return 1;var n=Nn(e),r=Nn(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},wn=function(e,t){return e===t?0:e<t?-1:1},_n=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+he(t))},bn=function e(t){if("object"!==typeof t||null===t)return he(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=he(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},xn=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function In(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var En=function(e){q(!yn(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(t?1:0),u.reverse();var s=u.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var Tn=new RegExp("^-?(0*)\\d{1,10}$"),Sn=-2147483648,Cn=2147483647,Nn=function(e){if(Tn.test(e)){var t=Number(e);if(t>=Sn&&t<=Cn)return t}return null},An=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw vn("Exception was thrown by user callback.",e),t}),Math.floor(0))}},Dn=function(e,t){var n=setTimeout(e,t);return"object"===typeof n&&n.unref&&n.unref(),n},Pn=function(){function e(t,n){var r=this;S(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return N(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){vn('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),Rn=function(){function e(t,n,r){var i=this;S(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return i.auth_=e}))}return N(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(hn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vn(e)}}]),e}(),On=function(){function e(t){S(this,e),this.accessToken=t}return N(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();On.OWNER="owner";var Ln="5",Mn=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Fn="websocket",Un="long_polling",Vn=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];S(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tn.get("host:"+t)||this._host}return N(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tn.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function Bn(e,t,n){var r;if(q("string"===typeof t,"typeof type must == string"),q("object"===typeof n,"typeof params must == object"),t===Fn)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Un)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return In(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var jn=function(){function e(){S(this,e),this.counters_={}}return N(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;de(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return Y(void 0,this.counters_)}}]),e}(),qn={},zn={};function Wn(e){var t=e.toString();return qn[t]||(qn[t]=new jn),qn[t]}var Kn=function(){function e(t){S(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return N(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&An((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),Hn="start",Gn="close",Qn=function(){function e(t,n,r,i,a,o,u){var s=this;S(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=fn(t),this.stats_=Wn(n),this.urlFn=function(e){return s.appCheckToken&&(e.ac=s.appCheckToken),Bn(n,Un,e)}}return N(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Kn(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(ie()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new Yn((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Hn)n.id=a,n.password=o;else{if(i!==Gn)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=Ln,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&Mn.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=he(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=H(t),r=xn(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!ie()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=he(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!ie()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),Yn=function(){function e(t,n,r,i){if(S(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,ie())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=an(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){hn("frame writing exception"),u.stack&&hn(u.stack),hn(u)}}}return N(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;ie()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){hn("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||hn("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),Jn=null;"undefined"!==typeof MozWebSocket?Jn=MozWebSocket:"undefined"!==typeof WebSocket&&(Jn=WebSocket);var Xn=function(){function e(t,n,r,i,a,o,u){S(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=fn(this.connId),this.stats_=Wn(n),this.connURL=e.connectionURL_(n,o,u,i,r),this.nodeAdmin=n.nodeAdmin}return N(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tn.set("previous_websocket_failure",!0);try{if(ie()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/".concat(Ln,"/").concat(Jt,"/").concat(process.platform,"/").concat(r),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(i.proxy={origin:o})}this.mySock=new Jn(this.connURL,[],undefined)}catch(s){this.log_("Error instantiating WebSocket.");var u=s.message||s.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){tn.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=le(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(q(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=he(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=xn(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var a={};return a.v=Ln,!ie()&&"undefined"!==typeof location&&location.hostname&&Mn.test(location.hostname)&&(a.r="f"),t&&(a.s=t),n&&(a.ls=n),r&&(a.ac=r),i&&(a.p=i),Bn(e,Fn,a)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==Jn&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return tn.isInMemoryStorage||!0===tn.get("previous_websocket_failure")}}]),e}();Xn.responsesRequiredToBeHealthy=2,Xn.healthyTimeout=3e4;var $n=function(){function e(t){S(this,e),this.initTransports_(t)}return N(e,[{key:"initTransports_",value:function(t){var n=Xn&&Xn.isAvailable(),r=n&&!Xn.previouslyFailed();if(t.webSocketOnly&&(n||vn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Xn];else{var i,a=this.transports_=[],o=T(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var u=i.value;u&&u.isAvailable()&&a.push(u)}}catch(s){o.e(s)}finally{o.f()}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[Qn,Xn]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();$n.globalTransportInitialized_=!1;var Zn=function(){function e(t,n,r,i,a,o,u,s,c,l){S(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=s,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=fn("c:"+this.id+":"),this.transportManager_=new $n(n),this.log_("Connection created"),this.start_()}return N(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Dn((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=_n("t",e),n=_n("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=_n("t",e),n=_n("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=_n("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?dn("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):dn("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Ln!==n&&vn("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Dn((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Dn((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),er=function(){function e(){S(this,e)}return N(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),tr=function(){function e(t){S(this,e),this.allowedEvents_=t,this.listeners_={},q(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return N(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=u(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){q(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),nr=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Z()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return N(n,[{key:"getInitialEvent",value:function(e){return q("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(tr),rr=function(){function e(t,n){if(S(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return N(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function ir(){return new rr("")}function ar(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function or(e){return e.pieces_.length-e.pieceNum_}function ur(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new rr(e.pieces_,t)}function sr(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function cr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function lr(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new rr(t,0)}function hr(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof rr)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new rr(n,0)}function fr(e){return e.pieceNum_>=e.pieces_.length}function dr(e,t){var n=ar(e),r=ar(t);if(null===n)return t;if(n===r)return dr(ur(e),ur(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function pr(e,t){for(var n=cr(e,0),r=cr(t,0),i=0;i<n.length&&i<r.length;i++){var a=kn(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1}function vr(e,t){if(or(e)!==or(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function yr(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(or(e)>or(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var mr=N((function e(t,n){S(this,e),this.errorPrefix_=n,this.parts_=cr(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=Ae(this.parts_[r]);gr(this)}));function gr(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+kr(e))}function kr(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var wr=function(e){P(n,e);var t=M(n);function n(){var e,r,i;return S(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(i="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(i="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return N(n,[{key:"getInitialEvent",value:function(e){return q("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(tr),_r=1e3,br=function(e){P(n,e);var t=M(n);function n(e,r,i,a,o,u,s,c){var l;if(S(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=u,l.appCheckTokenProvider_=s,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=fn("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=_r,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!ie())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return wr.getInstance().on("visible",l.onVisible_,A(l)),-1===e.host.indexOf("fblocal")&&nr.getInstance().on("online",l.onOnline_,A(l)),l}return N(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(he(i)),q(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new J,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:function(e){var t=e.d;"ok"===e.s?n.resolve(t):n.reject(t)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;var i=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[i];void 0!==e&&r===e&&(delete t.outstandingGets_[i],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+i+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),q(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),q(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var u=o.d,s=o.s;n.warnOnListenWarnings_(u,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==s&&t.removeListen_(i,a),e.onComplete&&e.onComplete(s,u))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=fe(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=fe(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),q(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+he(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):dn("Unrecognized action received from server: "+he(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;q(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_r,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=_r,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=_r),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=E(x().mark((function e(){var t,r,i,a,o,u,s,c,h,f,d,p,v,y,m=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,u=!1,s=null,c=function(){s?s.close():(u=!0,i())},h=function(e){q(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)},this.realtime_={close:c,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);case 19:d=e.sent,p=l(d,2),v=p[0],y=p[1],u?hn("getToken() completed but was canceled"):(hn("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=y&&y.token,s=new Zn(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,(function(e){vn(e+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),o)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),u||(this.repoInfo_.nodeAdmin&&vn(e.t0),c());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){hn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){hn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ve(this.interruptReasons_)&&(this.reconnectDelay_=_r,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return bn(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new rr(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){hn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){hn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=T(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=T(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(s){r.e(s)}finally{r.f()}}}catch(s){t.e(s)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)}},{key:"sendConnectStats_",value:function(){var e={},t="js";ie()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Jt.replace(/\./g,"-")]=1,Z()?e["framework.cordova"]=1:ne()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=nr.getInstance().currentlyOnline();return ve(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&de(e,"w")){var n=pe(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();vn("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),n}(er);br.nextPersistentConnectionId_=0,br.nextConnectionId_=0;var xr,Ir=function(){function e(t,n){S(this,e),this.name=t,this.node=n}return N(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),Er=function(){function e(){S(this,e)}return N(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new Ir(mn,e),r=new Ir(mn,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return Ir.MIN}}]),e}(),Tr=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"compare",value:function(e,t){return kn(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw z("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return Ir.MIN}},{key:"maxPost",value:function(){return new Ir(gn,xr)}},{key:"makePost",value:function(e,t){return q("string"===typeof e,"KeyIndex indexValue must always be a string."),new Ir(e,xr)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return xr},set:function(e){xr=e}}]),n}(Er),Sr=new Tr,Cr=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;S(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return N(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),Nr=function(){function e(t,n,r,i,a){S(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:Pr.EMPTY_NODE,this.right=null!=a?a:Pr.EMPTY_NODE}return N(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return Pr.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Pr.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();Nr.RED=!0,Nr.BLACK=!1;var Ar,Dr=function(){function e(){S(this,e)}return N(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Nr(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),Pr=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;S(this,e),this.comparator_=t,this.root_=n}return N(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Nr.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Nr.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new Cr(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new Cr(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new Cr(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new Cr(this.root_,null,this.comparator_,!0,e)}}]),e}();function Rr(e,t){return kn(e.name,t.name)}function Or(e,t){return kn(e,t)}Pr.EMPTY_NODE=new Dr;var Lr,Mr,Fr,Ur=function(e){return"number"===typeof e?"number:"+En(e):"string:"+e},Vr=function(e){if(e.isLeafNode()){var t=e.val();q("string"===typeof t||"number"===typeof t||"object"===typeof t&&de(t,".sv"),"Priority must be a string or number.")}else q(e===Ar||e.isEmpty(),"priority of unexpected type.");q(e===Ar||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Br=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;S(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,q(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Vr(this.priorityNode_)}return N(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return fr(t)?this:".priority"===ar(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=ar(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(q(".priority"!==r||1===or(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(ur(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ur(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?En(this.value_):this.value_,this.lazyHash_=on(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(q(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return q(i>=0,"Unknown leaf type: "+n),q(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return Lr},set:function(e){Lr=e}}]),e}();Br.VALUE_TYPE_ORDER=["object","boolean","number","string"];var jr,qr,zr=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?kn(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return Ir.MIN}},{key:"maxPost",value:function(){return new Ir(gn,new Br("[PRIORITY-POST]",Fr))}},{key:"makePost",value:function(e,t){var n=Mr(e);return new Ir(t,new Br("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(Er),Wr=new zr,Kr=Math.log(2),Hr=function(){function e(t){S(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/Kr,10)),this.current_=this.count-1;var r,i=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&i}return N(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),Gr=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,u=i-r;if(0===u)return null;if(1===u)return a=e[r],o=n?n(a):a,new Nr(o,a.node,Nr.BLACK,null,null);var s=parseInt(u/2,10)+r,c=t(r,s),l=t(s+1,i);return a=e[s],o=n?n(a):a,new Nr(o,a.node,Nr.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,u=function(t,r){var a=o-t,u=o;o-=t;var c=i(a+1,u),l=e[a],h=n?n(l):l;s(new Nr(h,l.node,r,null,c))},s=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?u(h,Nr.BLACK):(u(h,Nr.BLACK),u(h,Nr.RED))}return a}(new Hr(e.length));return new Pr(r||t,a)},Qr={},Yr=function(){function e(t,n){S(this,e),this.indexes_=t,this.indexSet_=n}return N(e,[{key:"get",value:function(e){var t=pe(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Pr?t:null}},{key:"hasIndex",value:function(e){return de(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){q(t!==Sr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(Ir.Wrap),u=o.getNext();u;)a=a||t.isDefinedOn(u.node),i.push(u),u=o.getNext();r=a?Gr(i,t.getCompare()):Qr;var s=t.toString(),c=Object.assign({},this.indexSet_);c[s]=t;var l=Object.assign({},this.indexes_);return l[s]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(ye(this.indexes_,(function(e,i){var a=pe(r.indexSet_,i);if(q(a,"Missing index implementation for "+i),e===Qr){if(a.isDefinedOn(t.node)){for(var o=[],u=n.getIterator(Ir.Wrap),s=u.getNext();s;)s.name!==t.name&&o.push(s),s=u.getNext();return o.push(t),Gr(o,a.getCompare())}return Qr}var c=n.get(t.name),l=e;return c&&(l=l.remove(new Ir(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(ye(this.indexes_,(function(e){if(e===Qr)return e;var r=n.get(t.name);return r?e.remove(new Ir(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return q(Qr&&Wr,"ChildrenNode.ts has not been loaded"),jr=jr||new e({".priority":Qr},{".priority":Wr})}}]),e}(),Jr=function(){function e(t,n,r){S(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Vr(this.priorityNode_),this.children_.isEmpty()&&q(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return N(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||qr}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?qr:t}},{key:"getChild",value:function(e){var t=ar(e);return null===t?this:this.getImmediateChild(t).getChild(ur(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(q(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new Ir(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?qr:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=ar(e);if(null===n)return t;q(".priority"!==ar(e)||1===or(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(ur(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(Wr,(function(o,u){n[o]=u.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!t&&a&&i<2*r){var o=[];for(var u in n)o[u]=n[u];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Ur(this.getPriority().val())+":"),this.forEachChild(Wr,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":on(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ir(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new Ir(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new Ir(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Ir.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Ir.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xr?-1:0}},{key:"withIndex",value:function(t){if(t===Sr||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===Sr||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Wr),r=t.getIterator(Wr),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===Sr?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return qr||(qr=new e(new Pr(Or),null,Yr.Default))}}]),e}();Jr.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var Xr=new(function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.call(this,new Pr(Or),Jr.EMPTY_NODE,Yr.Default)}return N(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return Jr.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(Jr));Object.defineProperties(Ir,{MIN:{value:new Ir(mn,Jr.EMPTY_NODE)},MAX:{value:new Ir(gn,Xr)}}),Tr.__EMPTY_NODE=Jr.EMPTY_NODE,Br.__childrenNodeConstructor=Jr,Ar=Xr,function(e){Fr=e}(Xr);function $r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return Jr.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),q(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){var n=e;return new Br(n,$r(t))}if(e instanceof Array){var r=Jr.EMPTY_NODE;return In(e,(function(t,n){if(de(e,t)&&"."!==t.substring(0,1)){var i=$r(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}})),r.updatePriority($r(t))}var i=[],a=!1,o=e;if(In(o,(function(e,t){if("."!==e.substring(0,1)){var n=$r(t);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),i.push(new Ir(e,n)))}})),0===i.length)return Jr.EMPTY_NODE;var u=Gr(i,Rr,(function(e){return e.name}),Or);if(a){var s=Gr(i,Wr.getCompare());return new Jr(u,$r(t),new Yr({".priority":s},{".priority":Wr}))}return new Jr(u,$r(t),Yr.Default)}!function(e){Mr=e}($r);var Zr=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).indexPath_=e,q(!fr(e)&&".priority"!==ar(e),"Can't create PathIndex with empty path or .priority key"),r}return N(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?kn(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=$r(e),r=Jr.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ir(t,r)}},{key:"maxPost",value:function(){var e=Jr.EMPTY_NODE.updateChild(this.indexPath_,Xr);return new Ir(gn,e)}},{key:"toString",value:function(){return cr(this.indexPath_,0).join("/")}}]),n}(Er),ei=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?kn(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return Ir.MIN}},{key:"maxPost",value:function(){return Ir.MAX}},{key:"makePost",value:function(e,t){var n=$r(e);return new Ir(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(Er),ti=new ei,ni="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ri=function(){var e=0,t=[];return function(n){var r,i=n===e;e=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=ni.charAt(n%64),n=Math.floor(n/64);q(0===n,"Cannot push at time == 0");var o=a.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=ni.charAt(t[r]);return q(20===o.length,"nextPushId: Length should be 20."),o}}(),ii=function(e){if("2147483647"===e)return"-";var t=Nn(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return gn;var a=n[i],o=ni.charAt(ni.indexOf(a)+1);return n[i]=o,n.slice(0,i+1).join("")},ai=function(e){if("-2147483648"===e)return mn;var t=Nn(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=ni.charAt(ni.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function oi(e){return{type:"value",snapshotNode:e}}function ui(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function si(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ci(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var li=function(){function e(t){S(this,e),this.index_=t}return N(e,[{key:"updateChild",value:function(e,t,n,r,i,a){q(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(si(t,o)):q(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(ui(t,n)):a.trackChildChange(ci(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Wr,(function(e,r){t.hasChild(e)||n.trackChildChange(si(e,r))})),t.isLeafNode()||t.forEachChild(Wr,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(ci(t,r,i))}else n.trackChildChange(ui(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?Jr.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),hi=function(){function e(t){S(this,e),this.indexedFilter_=new li(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return N(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}},{key:"updateChild",value:function(e,t,n,r,i,a){return this.matches(new Ir(t,n))||(n=Jr.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,a)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=Jr.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Jr.EMPTY_NODE);var i=this;return t.forEachChild(Wr,(function(e,t){i.matches(new Ir(e,t))||(r=r.updateImmediateChild(e,Jr.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),fi=function(){function e(t){S(this,e),this.rangedFilter_=new hi(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return N(e,[{key:"updateChild",value:function(e,t,n,r,i,a){return this.rangedFilter_.matches(new Ir(t,n))||(n=Jr.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,a):this.fullLimitUpdateChild_(e,t,n,i,a)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Jr.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=Jr.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(o.name,o.node),a++}}else{var u,s,c,l;if(r=(r=t.withIndex(this.index_)).updatePriority(Jr.EMPTY_NODE),this.reverse_){l=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),s=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(e,t){return h(t,e)}}else l=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),s=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();for(var f=0,d=!1;l.hasNext();){var p=l.getNext();!d&&c(u,p)<=0&&(d=!0),d&&f<this.limit_&&c(p,s)<=0?f++:r=r.updateImmediateChild(p.name,Jr.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var u=e;q(u.numChildren()===this.limit_,"");var s=new Ir(t,n),c=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(s);if(u.hasChild(t)){for(var h=u.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||u.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:a(f,s);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(ci(t,n,h)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(si(t,h));var p=u.updateImmediateChild(t,Jr.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(ui(f.name,f.node)),p.updateImmediateChild(f.name,f.node)):p}return n.isEmpty()?e:l&&a(c,s)>=0?(null!=i&&(i.trackChildChange(si(c.name,c.node)),i.trackChildChange(ui(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(c.name,Jr.EMPTY_NODE)):e}}]),e}(),di=function(){function e(){S(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Wr}return N(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return q(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return q(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:mn}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return q(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return q(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:gn}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return q(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===Wr}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function pi(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function vi(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function yi(e,t){var n=e.copy();return n.index_=t,n}function mi(e){var t,n={};return e.isDefault()||(e.index_===Wr?t="$priority":e.index_===ti?t="$value":e.index_===Sr?t="$key":(q(e.index_ instanceof Zr,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=he(t),e.startSet_&&(n.startAt=he(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+he(e.indexStartName_))),e.endSet_&&(n.endAt=he(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+he(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function gi(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Wr&&(t.i=e.index_.toString()),t}var ki=function(e){P(n,e);var t=M(n);function n(e,r,i,a){var o;return S(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=fn("p:rest:"),o.listens_={},o}return N(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var u=n.getListenId_(e,r),s={};this.listens_[u]=s;var c=mi(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),pe(a.listens_,u)===s)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=mi(e._queryParams),r=e._path.toString(),i=new J;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=l(i,2),o=a[0],u=a[1];o&&o.accessToken&&(n.auth=o.accessToken),u&&u.token&&(n.ac=u.token);var s=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+ke(n);t.log_("Sending REST request for "+s);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(r&&4===c.readyState){t.log_("REST Response for "+s+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=le(c.responseText)}catch(n){vn("Failed to parse JSON response for "+s+": "+c.responseText)}r(null,e)}else 401!==c.status&&404!==c.status&&vn("Got unsuccessful REST response for "+s+" Status: "+c.status),r(c.status);r=null}},c.open("GET",s,!0),c.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(q(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(er),wi=function(){function e(){S(this,e),this.rootNode_=Jr.EMPTY_NODE}return N(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function _i(){return{value:null,children:new Map}}function bi(e,t,n){if(fr(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=ar(t);e.children.has(r)||e.children.set(r,_i()),bi(e.children.get(r),t=ur(t),n)}}function xi(e,t){if(fr(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Wr,(function(t,n){bi(e,new rr(t),n)})),xi(e,t)}if(e.children.size>0){var r=ar(t);if(t=ur(t),e.children.has(r))xi(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function Ii(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){Ii(r,new rr(t.toString()+"/"+e),n)}))}var Ei,Ti=function(){function e(t){S(this,e),this.collection_=t,this.last_=null}return N(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&In(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),Si=function(){function e(t,n){S(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new Ti(t);var r=1e4+2e4*Math.random();Dn(this.reportStats_.bind(this),Math.floor(r))}return N(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;In(t,(function(t,i){i>0&&de(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),Dn(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function Ci(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ei||(Ei={}));var Ni,Ai=function(){function e(t,n,r){S(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=Ei.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return N(e,[{key:"operationForChild",value:function(t){if(fr(this.path)){if(null!=this.affectedTree.value)return q(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new rr(t));return new e(ir(),n,this.revert)}return q(ar(this.path)===t,"operationForChild called for unrelated child."),new e(ur(this.path),this.affectedTree,this.revert)}}]),e}(),Di=function(){function e(t,n){S(this,e),this.source=t,this.path=n,this.type=Ei.LISTEN_COMPLETE}return N(e,[{key:"operationForChild",value:function(t){return fr(this.path)?new e(this.source,ir()):new e(this.source,ur(this.path))}}]),e}(),Pi=function(){function e(t,n,r){S(this,e),this.source=t,this.path=n,this.snap=r,this.type=Ei.OVERWRITE}return N(e,[{key:"operationForChild",value:function(t){return fr(this.path)?new e(this.source,ir(),this.snap.getImmediateChild(t)):new e(this.source,ur(this.path),this.snap)}}]),e}(),Ri=function(){function e(t,n,r){S(this,e),this.source=t,this.path=n,this.children=r,this.type=Ei.MERGE}return N(e,[{key:"operationForChild",value:function(t){if(fr(this.path)){var n=this.children.subtree(new rr(t));return n.isEmpty()?null:n.value?new Pi(this.source,ir(),n.value):new e(this.source,ir(),n)}return q(ar(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,ur(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),Oi=function(){function e(t,n,r){S(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return N(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(fr(e))return this.isFullyInitialized()&&!this.filtered_;var t=ar(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),Li=N((function e(t){S(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()}));function Mi(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw z("Should only compare child_ events.");var r=new Ir(t.childName,t.snapshotNode),i=new Ir(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Fi(e,t){return{eventCache:e,serverCache:t}}function Ui(e,t,n,r){return Fi(new Oi(t,n,r),e.serverCache)}function Vi(e,t,n,r){return Fi(e.eventCache,new Oi(t,n,r))}function Bi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ji(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var qi=function(){return Ni||(Ni=new Pr(wn)),Ni},zi=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qi();S(this,e),this.value=t,this.children=n}return N(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:ir(),value:this.value};if(fr(e))return null;var n=ar(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(ur(e),t);return null!=i?{path:hr(new rr(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(fr(t))return this;var n=ar(t),r=this.children.get(n);return null!==r?r.subtree(ur(t)):new e(null)}},{key:"set",value:function(t,n){if(fr(t))return new e(n,this.children);var r=ar(t),i=(this.children.get(r)||new e(null)).set(ur(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(fr(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=ar(t),r=this.children.get(n);if(r){var i,a=r.remove(ur(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(fr(e))return this.value;var t=ar(e),n=this.children.get(t);return n?n.get(ur(e)):null}},{key:"setTree",value:function(t,n){if(fr(t))return n;var r,i=ar(t),a=(this.children.get(i)||new e(null)).setTree(ur(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(ir(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(hr(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,ir(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(fr(e))return null;var i=ar(e),a=this.children.get(i);return a?a.findOnPath_(ur(e),hr(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,ir(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(fr(t))return this;this.value&&r(n,this.value);var i=ar(t),a=this.children.get(i);return a?a.foreachOnPath_(ur(t),hr(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(ir(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(hr(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return In(t,(function(e,t){n=n.set(new rr(e),t)})),n}}]),e}(),Wi=function(){function e(t){S(this,e),this.writeTree_=t}return N(e,null,[{key:"empty",value:function(){return new e(new zi(null))}}]),e}();function Ki(e,t,n){if(fr(t))return new Wi(new zi(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=dr(i,t);return a=a.updateChild(o,n),new Wi(e.writeTree_.set(i,a))}var u=new zi(n),s=e.writeTree_.setTree(t,u);return new Wi(s)}function Hi(e,t,n){var r=e;return In(n,(function(e,n){r=Ki(r,hr(t,e),n)})),r}function Gi(e,t){if(fr(t))return Wi.empty();var n=e.writeTree_.setTree(t,new zi(null));return new Wi(n)}function Qi(e,t){return null!=Yi(e,t)}function Yi(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(dr(n.path,t)):null}function Ji(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Wr,(function(e,n){t.push(new Ir(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Ir(e,n.value))})),t}function Xi(e,t){if(fr(t))return e;var n=Yi(e,t);return new Wi(null!=n?new zi(n):e.writeTree_.subtree(t))}function $i(e){return e.writeTree_.isEmpty()}function Zi(e,t){return ea(ir(),e.writeTree_,t)}function ea(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(q(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=ea(hr(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(hr(e,".priority"),r)),n}function ta(e,t){return va(t,e)}function na(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function ra(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));q(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var u=e.allWrites[o];u.visible&&(o>=n&&ia(u,r.path)?i=!1:yr(r.path,u.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=oa(e.allWrites,aa,ir()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=Gi(e.visibleWrites,r.path):In(r.children,(function(t){e.visibleWrites=Gi(e.visibleWrites,hr(r.path,t))}));return!0}return!1}function ia(e,t){if(e.snap)return yr(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&yr(hr(e.path,n),t))return!0;return!1}function aa(e){return e.visible}function oa(e,t,n){for(var r=Wi.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,u=void 0;if(a.snap)yr(n,o)?r=Ki(r,u=dr(n,o),a.snap):yr(o,n)&&(u=dr(o,n),r=Ki(r,ir(),a.snap.getChild(u)));else{if(!a.children)throw z("WriteRecord should have .snap or .children");if(yr(n,o))r=Hi(r,u=dr(n,o),a.children);else if(yr(o,n))if(fr(u=dr(o,n)))r=Hi(r,ir(),a.children);else{var s=pe(a.children,ar(u));if(s){var c=s.getChild(ur(u));r=Ki(r,ir(),c)}}}}}return r}function ua(e,t,n,r,i){if(r||i){var a=Xi(e.visibleWrites,t);if(!i&&$i(a))return n;if(i||null!=n||Qi(a,ir())){return Zi(oa(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(yr(e.path,t)||yr(t,e.path))}),t),n||Jr.EMPTY_NODE)}return null}var o=Yi(e.visibleWrites,t);if(null!=o)return o;var u=Xi(e.visibleWrites,t);return $i(u)?n:null!=n||Qi(u,ir())?Zi(u,n||Jr.EMPTY_NODE):null}function sa(e,t,n,r){return ua(e.writeTree,e.treePath,t,n,r)}function ca(e,t){return function(e,t,n){var r=Jr.EMPTY_NODE,i=Yi(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Wr,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=Xi(e.visibleWrites,t);return n.forEachChild(Wr,(function(e,t){var n=Zi(Xi(a,new rr(e)),t);r=r.updateImmediateChild(e,n)})),Ji(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return Ji(Xi(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function la(e,t,n,r){return function(e,t,n,r,i){q(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=hr(t,n);if(Qi(e.visibleWrites,a))return null;var o=Xi(e.visibleWrites,a);return $i(o)?i.getChild(n):Zi(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function ha(e,t){return function(e,t){return Yi(e.visibleWrites,t)}(e.writeTree,hr(e.treePath,t))}function fa(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var u,s=Xi(e.visibleWrites,t),c=Yi(s,ir());if(null!=c)u=c;else{if(null==n)return[];u=Zi(s,n)}if((u=u.withIndex(o)).isEmpty()||u.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function da(e,t,n){return function(e,t,n,r){var i=hr(t,n),a=Yi(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?Zi(Xi(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function pa(e,t){return va(hr(e.treePath,t),e.writeTree)}function va(e,t){return{treePath:e,writeTree:t}}var ya=function(){function e(){S(this,e),this.changeMap=new Map}return N(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;q("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),q(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,ci(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,si(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ui(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw z("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ci(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),ma=new(function(){function e(){S(this,e)}return N(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),ga=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;S(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return N(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Oi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return da(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ji(this.viewCache_),i=fa(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();function ka(e,t,n,r,i){var a,o,u=new ya;if(n.type===Ei.OVERWRITE){var s=n;s.source.fromUser?a=ba(e,t,s.path,s.snap,r,i,u):(q(s.source.fromServer,"Unknown source."),o=s.source.tagged||t.serverCache.isFiltered()&&!fr(s.path),a=_a(e,t,s.path,s.snap,r,i,o,u))}else if(n.type===Ei.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var u=t;return r.foreach((function(r,s){var c=hr(n,r);xa(t,ar(c))&&(u=ba(e,u,c,s,i,a,o))})),r.foreach((function(r,s){var c=hr(n,r);xa(t,ar(c))||(u=ba(e,u,c,s,i,a,o))})),u}(e,t,c.path,c.children,r,i,u):(q(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=Ea(e,t,c.path,c.children,r,i,o,u))}else if(n.type===Ei.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=ha(r,n))return t;var u,s=new ga(r,t,i),c=t.eventCache.getNode();if(fr(n)||".priority"===ar(n)){var l;if(t.serverCache.isFullyInitialized())l=sa(r,ji(t));else{var h=t.serverCache.getNode();q(h instanceof Jr,"serverChildren would be complete if leaf node"),l=ca(r,h)}u=e.filter.updateFullNode(c,l,a)}else{var f=ar(n),d=da(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(u=null!=d?e.filter.updateChild(c,f,d,ur(n),s,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,Jr.EMPTY_NODE,ur(n),s,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=sa(r,ji(t))).isLeafNode()&&(u=e.filter.updateFullNode(u,o,a))}return o=t.serverCache.isFullyInitialized()||null!=ha(r,ir()),Ui(t,u,o,e.filter.filtersNodes())}(e,t,l.path,r,i,u):function(e,t,n,r,i,a,o){if(null!=ha(i,n))return t;var u=t.serverCache.isFiltered(),s=t.serverCache;if(null!=r.value){if(fr(n)&&s.isFullyInitialized()||s.isCompleteForPath(n))return _a(e,t,n,s.getNode().getChild(n),i,a,u,o);if(fr(n)){var c=new zi(null);return s.getNode().forEachChild(Sr,(function(e,t){c=c.set(new rr(e),t)})),Ea(e,t,n,c,i,a,u,o)}return t}var l=new zi(null);return r.foreach((function(e,t){var r=hr(n,e);s.isCompleteForPath(r)&&(l=l.set(e,s.getNode().getChild(r)))})),Ea(e,t,n,l,i,a,u,o)}(e,t,l.path,l.affectedTree,r,i,u)}else{if(n.type!==Ei.LISTEN_COMPLETE)throw z("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=Vi(t,a.getNode(),a.isFullyInitialized()||fr(n),a.isFiltered());return wa(e,o,n,r,ma,i)}(e,t,n.path,r,u)}var h=u.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Bi(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(oi(Bi(t)))}}(t,a,h),{viewCache:a,changes:h}}function wa(e,t,n,r,i,a){var o,u,s=t.eventCache;if(null!=ha(r,n))return t;if(fr(n))if(q(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=ji(t),l=ca(r,c instanceof Jr?c:Jr.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=sa(r,ji(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=ar(n);if(".priority"===f){q(1===or(n),"Can't have a priority with additional path components");var d=s.getNode(),p=la(r,n,d,u=t.serverCache.getNode());o=null!=p?e.filter.updatePriority(d,p):s.getNode()}else{var v,y=ur(n);if(s.isCompleteForChild(f)){u=t.serverCache.getNode();var m=la(r,n,s.getNode(),u);v=null!=m?s.getNode().getImmediateChild(f).updateChild(y,m):s.getNode().getImmediateChild(f)}else v=da(r,f,t.serverCache);o=null!=v?e.filter.updateChild(s.getNode(),f,v,y,i,a):s.getNode()}}return Ui(t,o,s.isFullyInitialized()||fr(n),e.filter.filtersNodes())}function _a(e,t,n,r,i,a,o,u){var s,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(fr(n))s=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);s=l.updateFullNode(c.getNode(),h,null)}else{var f=ar(n);if(!c.isCompleteForPath(n)&&or(n)>1)return t;var d=ur(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);s=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,ma,null)}var v=Vi(t,s,c.isFullyInitialized()||fr(n),l.filtersNodes());return wa(e,v,n,i,new ga(i,v,a),u)}function ba(e,t,n,r,i,a,o){var u,s,c=t.eventCache,l=new ga(i,t,a);if(fr(n))s=e.filter.updateFullNode(t.eventCache.getNode(),r,o),u=Ui(t,s,!0,e.filter.filtersNodes());else{var h=ar(n);if(".priority"===h)s=e.filter.updatePriority(t.eventCache.getNode(),r),u=Ui(t,s,c.isFullyInitialized(),c.isFiltered());else{var f,d=ur(n),p=c.getNode().getImmediateChild(h);if(fr(d))f=r;else{var v=l.getCompleteChild(h);f=null!=v?".priority"===sr(d)&&v.getChild(lr(d)).isEmpty()?v:v.updateChild(d,r):Jr.EMPTY_NODE}if(p.equals(f))u=t;else u=Ui(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return u}function xa(e,t){return e.eventCache.isCompleteForChild(t)}function Ia(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Ea(e,t,n,r,i,a,o,u){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var s,c=t;s=fr(n)?r:new zi(null).setTree(n,r);var l=t.serverCache.getNode();return s.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var s=Ia(0,t.serverCache.getNode().getImmediateChild(n),r);c=_a(e,c,new rr(n),s,i,a,o,u)}})),s.children.inorderTraversal((function(n,r){var s=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!s){var h=Ia(0,t.serverCache.getNode().getImmediateChild(n),r);c=_a(e,c,new rr(n),h,i,a,o,u)}})),c}var Ta,Sa=function(){function e(t,n){S(this,e),this.query_=t,this.eventRegistrations_=[];var r,i=this.query_._queryParams,a=new li(i.getIndex()),o=(r=i).loadsAllData()?new li(r.getIndex()):r.hasLimit()?new fi(r):new hi(r);this.processor_=function(e){return{filter:e}}(o);var u=n.serverCache,s=n.eventCache,c=a.updateFullNode(Jr.EMPTY_NODE,u.getNode(),null),l=o.updateFullNode(Jr.EMPTY_NODE,s.getNode(),null),h=new Oi(c,u.isFullyInitialized(),a.filtersNodes()),f=new Oi(l,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Fi(f,h),this.eventGenerator_=new Li(this.query_)}return N(e,[{key:"query",get:function(){return this.query_}}]),e}();function Ca(e,t){var n=ji(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!fr(t)&&!n.getImmediateChild(ar(t)).isEmpty())?n.getChild(t):null}function Na(e){return 0===e.eventRegistrations_.length}function Aa(e,t,n){var r=[];if(n){q(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],o=0;o<e.eventRegistrations_.length;++o){var u=e.eventRegistrations_[o];if(u.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(o+1));break}}else a.push(u)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function Da(e,t,n,r){t.type===Ei.MERGE&&null!==t.source.queryId&&(q(ji(e.viewCache_),"We should always have a full cache before handling merges"),q(Bi(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,u=ka(e.processor_,o,t,n,r);return i=e.processor_,a=u.viewCache,q(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),q(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),q(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=u.viewCache,Pa(e,u.changes,u.viewCache.eventCache.getNode(),null)}function Pa(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Mi(e,i,"child_removed",t,r,n),Mi(e,i,"child_added",t,r,n),Mi(e,i,"child_moved",a,r,n),Mi(e,i,"child_changed",t,r,n),Mi(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var Ra,Oa=N((function e(){S(this,e),this.views=new Map}));function La(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return q(null!=a,"SyncTree gave us an op for an invalid query."),Da(a,t,n,r)}var o,u=[],s=T(e.views.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u=u.concat(Da(c,t,n,r))}}catch(l){s.e(l)}finally{s.f()}return u}function Ma(e,t,n,r,i){var a=t._queryIdentifier,o=e.views.get(a);if(!o){var u=sa(n,i?r:null),s=!1;u?s=!0:r instanceof Jr?(u=ca(n,r),s=!1):(u=Jr.EMPTY_NODE,s=!1);var c=Fi(new Oi(u,s,!1),new Oi(r,i,!1));return new Sa(t,c)}return o}function Fa(e,t,n,r,i,a){var o=Ma(e,t,r,i,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Wr,(function(e,t){r.push(ui(e,t))})),n.isFullyInitialized()&&r.push(oi(n.getNode())),Pa(e,r,n.getNode(),t)}(o,n)}function Ua(e,t,n,r){var i=t._queryIdentifier,a=[],o=[],u=za(e);if("default"===i){var s,c=T(e.views.entries());try{for(c.s();!(s=c.n()).done;){var h=l(s.value,2),f=h[0],d=h[1];o=o.concat(Aa(d,n,r)),Na(d)&&(e.views.delete(f),d.query._queryParams.loadsAllData()||a.push(d.query))}}catch(v){c.e(v)}finally{c.f()}}else{var p=e.views.get(i);p&&(o=o.concat(Aa(p,n,r)),Na(p)&&(e.views.delete(i),p.query._queryParams.loadsAllData()||a.push(p.query)))}return u&&!za(e)&&a.push(new(q(Ta,"Reference.ts has not been loaded"),Ta)(t._repo,t._path)),{removed:a,events:o}}function Va(e){var t,n=[],r=T(e.views.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.query._queryParams.loadsAllData()||n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}function Ba(e,t){var n,r=null,i=T(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||Ca(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}function ja(e,t){if(t._queryParams.loadsAllData())return Wa(e);var n=t._queryIdentifier;return e.views.get(n)}function qa(e,t){return null!=ja(e,t)}function za(e){return null!=Wa(e)}function Wa(e){var t,n=T(e.views.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.query._queryParams.loadsAllData())return r}}catch(i){n.e(i)}finally{n.f()}return null}var Ka=1,Ha=N((function e(t){S(this,e),this.listenProvider_=t,this.syncPointTree_=new zi(null),this.pendingWriteTree_={visibleWrites:Wi.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function Ga(e,t,n,r,i){return function(e,t,n,r,i){q(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Ki(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?ro(e,new Pi({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Qa(e,t,n,r){!function(e,t,n,r){q(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Hi(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=zi.fromObject(n);return ro(e,new Ri({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Ya(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=na(e.pendingWriteTree_,t),i=ra(e.pendingWriteTree_,t);if(i){var a=new zi(null);return null!=r.snap?a=a.set(ir(),!0):In(r.children,(function(e){a=a.set(new rr(e),!0)})),ro(e,new Ai(r.path,a,n))}return[]}function Ja(e,t,n){return ro(e,new Pi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Xa(e,t,n,r){var i=t._path,a=e.syncPointTree_.get(i),o=[];if(a&&("default"===t._queryIdentifier||qa(a,t))){var u=Ua(a,t,n,r);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var s=u.removed;o=u.events;var c=-1!==s.findIndex((function(e){return e._queryParams.loadsAllData()})),l=e.syncPointTree_.findOnPath(i,(function(e,t){return za(t)}));if(c&&!l){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=function(e){return e.fold((function(e,t,n){if(t&&za(t))return[Wa(t)];var r=[];return t&&(r=Va(t)),In(n,(function(e,t){r=r.concat(t)})),r}))}(h),d=0;d<f.length;++d){var p=f[d],v=p.query,y=oo(e,p);e.listenProvider_.startListening(fo(v),uo(e,v),y.hashFn,y.onComplete)}}if(!l&&s.length>0&&!r)if(c){e.listenProvider_.stopListening(fo(t),null)}else s.forEach((function(t){var n=e.queryToTagMap.get(so(t));e.listenProvider_.stopListening(fo(t),n)}));!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=so(r),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}(e,s)}return o}function $a(e,t,n,r){var i=co(e,r);if(null!=i){var a=lo(i),o=a.path,u=a.queryId,s=dr(o,t);return ho(e,o,new Pi(Ci(u),s,n))}return[]}function Za(e,t){var n=e._path,r=null,i=!1;t.syncPointTree_.foreachOnPath(n,(function(e,t){var a=dr(e,n);r=r||Ba(t,a),i=i||za(t)}));var a,o=t.syncPointTree_.get(n);(o?(i=i||za(o),r=r||Ba(o,ir())):(o=new Oa,t.syncPointTree_=t.syncPointTree_.set(n,o)),null!=r)?a=!0:(a=!1,r=Jr.EMPTY_NODE,t.syncPointTree_.subtree(n).foreachChild((function(e,t){var n=Ba(t,ir());n&&(r=r.updateImmediateChild(e,n))})));var u=qa(o,e);if(!u&&!e._queryParams.loadsAllData()){var s=so(e);q(!t.queryToTagMap.has(s),"View does not exist, but we have a tag");var c=Ka++;t.queryToTagMap.set(s,c),t.tagToQueryMap.set(c,s)}return{syncPoint:o,writesCache:ta(t.pendingWriteTree_,n),serverCache:r,serverCacheComplete:a,foundAncestorDefaultView:i,viewAlreadyExists:u}}function eo(e,t,n){var r=Za(t,e),i=r.syncPoint,a=r.serverCache,o=r.writesCache,u=r.serverCacheComplete,s=r.viewAlreadyExists,c=r.foundAncestorDefaultView,l=Fa(i,t,n,o,a,u);if(!s&&!c){var h=ja(i,t);l=l.concat(function(e,t,n){var r=t._path,i=uo(e,t),a=oo(e,n),o=e.listenProvider_.startListening(fo(t),i,a.hashFn,a.onComplete),u=e.syncPointTree_.subtree(r);if(i)q(!za(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var s=u.fold((function(e,t,n){if(!fr(e)&&t&&za(t))return[Wa(t).query];var r=[];return t&&(r=r.concat(Va(t).map((function(e){return e.query})))),In(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<s.length;++c){var l=s[c];e.listenProvider_.stopListening(fo(l),uo(e,l))}return o}(e,t,h))}return l}function to(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Ba(n,dr(e,t));if(r)return r}));return ua(r,t,i,n,!0)}function no(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=dr(e,n);r=r||Ba(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||Ba(i,ir()):(i=new Oa,e.syncPointTree_=e.syncPointTree_.set(n,i));var a=null!=r,o=a?new Oi(r,!0,!1):null;return function(e){return Bi(e.viewCache_)}(Ma(i,t,ta(e.pendingWriteTree_,t._path),a?o.getNode():Jr.EMPTY_NODE,a))}function ro(e,t){return io(t,e.syncPointTree_,null,ta(e.pendingWriteTree_,ir()))}function io(e,t,n,r){if(fr(e.path))return ao(e,t,n,r);var i=t.get(ir());null==n&&null!=i&&(n=Ba(i,ir()));var a=[],o=ar(e.path),u=e.operationForChild(o),s=t.children.get(o);if(s&&u){var c=n?n.getImmediateChild(o):null,l=pa(r,o);a=a.concat(io(u,s,c,l))}return i&&(a=a.concat(La(i,e,r,n))),a}function ao(e,t,n,r){var i=t.get(ir());null==n&&null!=i&&(n=Ba(i,ir()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,u=pa(r,t),s=e.operationForChild(t);s&&(a=a.concat(ao(s,i,o,u)))})),i&&(a=a.concat(La(i,e,r,n))),a}function oo(e,t){var n=t.query,r=uo(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||Jr.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=co(e,n);if(r){var i=lo(r),a=i.path,o=i.queryId,u=dr(a,t);return ho(e,a,new Di(Ci(o),u))}return[]}(e,n._path,r):function(e,t){return ro(e,new Di({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Xa(e,n,null,i)}}}function uo(e,t){var n=so(t);return e.queryToTagMap.get(n)}function so(e){return e._path.toString()+"$"+e._queryIdentifier}function co(e,t){return e.tagToQueryMap.get(t)}function lo(e){var t=e.indexOf("$");return q(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new rr(e.substr(0,t))}}function ho(e,t,n){var r=e.syncPointTree_.get(t);return q(r,"Missing sync point for query tag that we're tracking"),La(r,n,ta(e.pendingWriteTree_,t),null)}function fo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(q(Ra,"Reference.ts has not been loaded"),Ra)(e._repo,e._path):e}var po=function(){function e(t){S(this,e),this.node_=t}return N(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),vo=function(){function e(t,n){S(this,e),this.syncTree_=t,this.path_=n}return N(e,[{key:"getImmediateChild",value:function(t){var n=hr(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return to(this.syncTree_,this.path_)}}]),e}(),yo=function(e,t,n){return e&&"object"===typeof e?(q(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?mo(e[".sv"],t,n):"object"===typeof e[".sv"]?go(e[".sv"],t):void q(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},mo=function(e,t,n){if("timestamp"===e)return n.timestamp;q(!1,"Unexpected server value: "+e)},go=function(e,t,n){e.hasOwnProperty("increment")||q(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&q(!1,"Unexpected increment value: "+r);var i=t.node();if(q(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},ko=function(e,t,n,r){return _o(t,new vo(n,e),r)},wo=function(e,t,n){return _o(e,new po(t),n)};function _o(e,t,n){var r,i=e.getPriority().val(),a=yo(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,u=yo(o.getValue(),t,n);return u!==o.getValue()||a!==o.getPriority().val()?new Br(u,$r(a)):e}var s=e;return r=s,a!==s.getPriority().val()&&(r=r.updatePriority(new Br(a))),s.forEachChild(Wr,(function(e,i){var a=_o(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}var bo=N((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};S(this,e),this.name=t,this.parent=n,this.node=r}));function xo(e,t){for(var n=t instanceof rr?t:new rr(t),r=e,i=ar(n);null!==i;){var a=pe(r.node.children,i)||{children:{},childCount:0};r=new bo(i,r,a),i=ar(n=ur(n))}return r}function Io(e){return e.node.value}function Eo(e,t){e.node.value=t,Ao(e)}function To(e){return e.node.childCount>0}function So(e,t){In(e.node.children,(function(n,r){t(new bo(n,e,r))}))}function Co(e,t,n,r){n&&!r&&t(e),So(e,(function(e){Co(e,t,!0,r)})),n&&r&&t(e)}function No(e){return new rr(null===e.parent?e.name:No(e.parent)+"/"+e.name)}function Ao(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===Io(e)&&!To(e)}(n),i=de(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Ao(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Ao(e))}(e.parent,e.name,e)}var Do=/[\[\].#$\/\u0000-\u001F\u007F]/,Po=/[\[\].#$\u0000-\u001F\u007F]/,Ro=10485760,Oo=function(e){return"string"===typeof e&&0!==e.length&&!Do.test(e)},Lo=function(e){return"string"===typeof e&&0!==e.length&&!Po.test(e)},Mo=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!yn(e)||e&&"object"===typeof e&&de(e,".sv")},Fo=function(e,t,n,r){r&&void 0===t||Uo(Se(e,"value"),t,n)},Uo=function e(t,n,r){var i=r instanceof rr?new mr(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+kr(i));if("function"===typeof n)throw new Error(t+"contains a function "+kr(i)+" with contents = "+n.toString());if(yn(n))throw new Error(t+"contains "+n.toString()+" "+kr(i));if("string"===typeof n&&n.length>Ro/3&&Ae(n)>Ro)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+kr(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,o=!1;if(In(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!Oo(n)))throw new Error(t+" contains an invalid key ("+n+") "+kr(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var u,s;s=n,(u=i).parts_.length>0&&(u.byteLength_+=1),u.parts_.push(s),u.byteLength_+=Ae(s),gr(u),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=Ae(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&o)throw new Error(t+' contains ".value" child '+kr(i)+" in addition to actual children.")}},Vo=function(e,t,n,r){if(!r||void 0!==t){var i=Se(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];In(t,(function(e,t){var r=new rr(e);if(Uo(i,t,hr(n,r)),".priority"===sr(r)&&!Mo(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=cr(r=t[n]),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!Oo(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(pr);var o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&yr(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(i,a)}},Bo=function(e,t,n){if(!n||void 0!==t){if(yn(t))throw new Error(Se(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Mo(t))throw new Error(Se(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jo=function(e,t,n,r){if((!r||void 0!==n)&&!Oo(n))throw new Error(Se(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},qo=function(e,t,n,r){if((!r||void 0!==n)&&!Lo(n))throw new Error(Se(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},zo=function(e,t){if(".info"===ar(t))throw new Error(e+" failed = Can't modify data under /.info/")},Wo=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Oo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Lo(e)}(n))throw new Error(Se(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Ko=N((function e(){S(this,e),this.eventLists_=[],this.recursionDepth_=0}));function Ho(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||vr(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function Go(e,t,n){Ho(e,n),Yo(e,(function(e){return vr(e,t)}))}function Qo(e,t,n){Ho(e,n),Yo(e,(function(e){return yr(e,t)||yr(t,e)}))}function Yo(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(Jo(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Jo(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();sn&&hn("event: "+n.toString()),An(r)}}}var Xo="repo_interrupt",$o=function(){function e(t,n,r,i){S(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ko,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=_i(),this.transactionQueueTree_=new bo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return N(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function Zo(e,t,n){if(e.stats_=Wn(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new ki(e.repoInfo_,(function(t,n,r,i){nu(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return ru(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{he(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new br(e.repoInfo_,t,(function(t,n,r,i){nu(e,t,n,r,i)}),(function(t){ru(e,t)}),(function(t){!function(e,t){In(t,(function(t,n){iu(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return zn[n]||(zn[n]=t()),zn[n]}(e.repoInfo_,(function(){return new Si(e.stats_,e.server_)})),e.infoData_=new wi,e.infoSyncTree_=new Ha({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=Ja(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),iu(e,"connected",!1),e.serverSyncTree_=new Ha({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);Qo(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function eu(e){var t=e.infoData_.getNode(new rr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function tu(e){return(t=(t={timestamp:eu(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function nu(e,t,n,r,i){e.dataUpdateCount++;var a=new rr(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var u=ye(n,(function(e){return $r(e)}));o=function(e,t,n,r){var i=co(e,r);if(i){var a=lo(i),o=a.path,u=a.queryId,s=dr(o,t),c=zi.fromObject(n);return ho(e,o,new Ri(Ci(u),s,c))}return[]}(e.serverSyncTree_,a,u,i)}else{var s=$r(n);o=$a(e.serverSyncTree_,a,s,i)}else if(r){var c=ye(n,(function(e){return $r(e)}));o=function(e,t,n){var r=zi.fromObject(n);return ro(e,new Ri({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=$r(n);o=Ja(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=mu(e,a)),Qo(e.eventQueue_,h,o)}function ru(e,t){iu(e,"connected",t),!1===t&&function(e){fu(e,"onDisconnectEvents");var t=tu(e),n=_i();Ii(e.onDisconnect_,ir(),(function(r,i){var a=ko(r,i,e.serverSyncTree_,t);bi(n,r,a)}));var r=[];Ii(n,ir(),(function(t,n){r=r.concat(Ja(e.serverSyncTree_,t,n));var i=bu(e,t);mu(e,i)})),e.onDisconnect_=_i(),Qo(e.eventQueue_,ir(),r)}(e)}function iu(e,t,n){var r=new rr("/.info/"+t),i=$r(n);e.infoData_.updateSnapshot(r,i);var a=Ja(e.infoSyncTree_,r,i);Qo(e.eventQueue_,r,a)}function au(e){return e.nextWriteId_++}function ou(e,t){var n=no(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=$r(n).withIndex(t._queryParams.getIndex());if(t._queryParams.loadsAllData())Ja(e.serverSyncTree_,t._path,r);else{var i=function(e,t){var n=Za(t,e),r=n.syncPoint,i=n.serverCache,a=Ma(r,t,n.writesCache,i,n.serverCacheComplete);return r.views.has(t._queryIdentifier)||r.views.set(t._queryIdentifier,a),t._queryParams.loadsAllData()?null:uo(e,t)}(e.serverSyncTree_,t);$a(e.serverSyncTree_,t._path,r,i)}return Xa(e.serverSyncTree_,t,null).length>0&&fu(e,"unexpected cancel events in repoGetValue"),r}),(function(n){return fu(e,"get for query "+he(t)+" failed: "+n),Promise.reject(new Error(n))}))}function uu(e,t,n,r,i){fu(e,"set",{path:t.toString(),value:n,priority:r});var a=tu(e),o=$r(n,r),u=to(e.serverSyncTree_,t),s=wo(o,u,a),c=au(e),l=Ga(e.serverSyncTree_,t,s,c,!0);Ho(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),(function(n,r){var a="ok"===n;a||vn("set at "+t+" failed: "+n);var o=Ya(e.serverSyncTree_,c,!a);Qo(e.eventQueue_,t,o),du(e,i,n,r)}));var h=bu(e,t);mu(e,h),Qo(e.eventQueue_,h,[])}function su(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&xi(e.onDisconnect_,t),du(e,n,r,i)}))}function cu(e,t,n,r){var i=$r(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,a){"ok"===n&&bi(e.onDisconnect_,t,i),du(e,r,n,a)}))}function lu(e,t,n){var r;r=".info"===ar(t._path)?Xa(e.infoSyncTree_,t,n):Xa(e.serverSyncTree_,t,n),Go(e.eventQueue_,t._path,r)}function hu(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Xo)}function fu(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];hn.apply(void 0,[t].concat(r))}function du(e,t,n,r){t&&An((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var a=new Error(i);a.code=e,t(a)}}))}function pu(e,t,n){return to(e.serverSyncTree_,t,n)||Jr.EMPTY_NODE}function vu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||_u(e,t),Io(t)){var n=ku(e,t);q(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&yu(e,No(t),n)}else To(t)&&So(t,(function(t){vu(e,t)}))}function yu(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=pu(e,t,r),a=i,o=i.hash(),u=0;u<n.length;u++){var s=n[u];q(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;var c=dr(t,s.path);a=a.updateChild(c,s.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){fu(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(Ya(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},u=0;u<n.length;u++)o(u);_u(e,xo(e.transactionQueueTree_,t)),vu(e,e.transactionQueueTree_),Qo(e.eventQueue_,t,i);for(var s=0;s<a.length;s++)An(a[s])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{vn("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}mu(e,t)}}),o)}function mu(e,t){var n=gu(e,t),r=No(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})),o=a.map((function(e){return e.currentWriteId})),u=function(a){var u,s=t[a],c=dr(n,s.path),l=!1,h=void 0;if(q(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,h=s.abortReason,i=i.concat(Ya(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,h="maxretry",i=i.concat(Ya(e.serverSyncTree_,s.currentWriteId,!0));else{var f=pu(e,s.path,o);s.currentInputSnapshot=f;var d=t[a].update(f.val());if(void 0!==d){Uo("transaction failed: Data returned ",d,s.path);var p=$r(d);"object"===typeof d&&null!=d&&de(d,".priority")||(p=p.updatePriority(f.getPriority()));var v=s.currentWriteId,y=tu(e),m=wo(p,f,y);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=m,s.currentWriteId=au(e),o.splice(o.indexOf(v),1),i=(i=i.concat(Ga(e.serverSyncTree_,s.path,m,s.currentWriteId,s.applyLocally))).concat(Ya(e.serverSyncTree_,v,!0))}else l=!0,h="nodata",i=i.concat(Ya(e.serverSyncTree_,s.currentWriteId,!0))}Qo(e.eventQueue_,n,i),i=[],l&&(t[a].status=2,u=t[a].unwatcher,setTimeout(u,Math.floor(0)),t[a].onComplete&&("nodata"===h?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(h),!1,null)}))))},s=0;s<t.length;s++)u(s);_u(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)An(r[c]);vu(e,e.transactionQueueTree_)}(e,ku(e,n),r),r}function gu(e,t){var n,r=e.transactionQueueTree_;for(n=ar(t);null!==n&&void 0===Io(r);)r=xo(r,n),n=ar(t=ur(t));return r}function ku(e,t){var n=[];return wu(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function wu(e,t,n){var r=Io(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);So(t,(function(t){wu(e,t,n)}))}function _u(e,t){var n=Io(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Eo(t,n.length>0?n:void 0)}So(t,(function(t){_u(e,t)}))}function bu(e,t){var n=No(gu(e,t)),r=xo(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){xu(e,t)})),xu(e,r),Co(r,(function(t){xu(e,t)})),n}function xu(e,t){var n=Io(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(q(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(q(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Ya(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?Eo(t,void 0):n.length=a+1,Qo(e.eventQueue_,No(t),i);for(var u=0;u<r.length;u++)An(r[u])}}var Iu=function(e,t){var n=Eu(e),r=n.namespace;"firebase.com"===n.domain&&pn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||pn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&vn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Vn(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new rr(n.pathString)}},Eu=function(e){var t="",n="",r="",i="",a="",o=!0,u="https",s=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(u=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=T(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):vn("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===u||"wss"===u,s=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:u,pathString:i,namespace:a}},Tu=function(){function e(t,n,r,i){S(this,e),this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}return N(e,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+he(this.snapshot.exportVal())}}]),e}(),Su=function(){function e(t,n,r){S(this,e),this.eventRegistration=t,this.error=n,this.path=r}return N(e,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),e}(),Cu=function(){function e(t,n){S(this,e),this.snapshotCallback=t,this.cancelCallback=n}return N(e,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return q(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),e}(),Nu=function(){function e(t,n){S(this,e),this._repo=t,this._path=n}return N(e,[{key:"cancel",value:function(){var e=new J;return su(this._repo,this._path,e.wrapCallback((function(){}))),e.promise}},{key:"remove",value:function(){zo("OnDisconnect.remove",this._path);var e=new J;return cu(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise}},{key:"set",value:function(e){zo("OnDisconnect.set",this._path),Fo("OnDisconnect.set",e,this._path,!1);var t=new J;return cu(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}},{key:"setWithPriority",value:function(e,t){zo("OnDisconnect.setWithPriority",this._path),Fo("OnDisconnect.setWithPriority",e,this._path,!1),Bo("OnDisconnect.setWithPriority",t,!1);var n=new J;return function(e,t,n,r,i){var a=$r(n,r);e.server_.onDisconnectPut(t.toString(),a.val(!0),(function(n,r){"ok"===n&&bi(e.onDisconnect_,t,a),du(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise}},{key:"update",value:function(e){zo("OnDisconnect.update",this._path),Vo("OnDisconnect.update",e,this._path,!1);var t=new J;return function(e,t,n,r){if(ve(n))return hn("onDisconnect().update() called with empty data.  Don't do anything."),void du(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,a){"ok"===i&&In(n,(function(n,r){var i=$r(r);bi(e.onDisconnect_,hr(t,n),i)})),du(0,r,i,a)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise}}]),e}(),Au=function(){function e(t,n,r,i){S(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return N(e,[{key:"key",get:function(){return fr(this._path)?null:sr(this._path)}},{key:"ref",get:function(){return new Ou(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=gi(this._queryParams),t=bn(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return gi(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=De(t))instanceof e))return!1;var n=this._repo===t._repo,r=vr(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();function Du(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Pu(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Sr){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==mn)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==gn)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===Wr){if(null!=t&&!Mo(t)||null!=n&&!Mo(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(q(e.getIndex()instanceof Zr||e.getIndex()===ti,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ru(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Ou=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,r,new di,!1)}return N(n,[{key:"parent",get:function(){var e=lr(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(Au),Lu=function(){function e(t,n,r){S(this,e),this._node=t,this.ref=n,this._index=r}return N(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(t){var n=new rr(t),r=Uu(this.ref,t);return new e(this._node.getChild(n),r,Wr)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,Uu(n.ref,r),Wr))}))}},{key:"hasChild",value:function(e){var t=new rr(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function Mu(e,t){return(e=De(e))._checkNotDeleted("ref"),void 0!==t?Uu(e._root,t):e._root}function Fu(e,t){(e=De(e))._checkNotDeleted("refFromURL");var n=Iu(t,e._repo.repoInfo_.nodeAdmin);Wo("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||pn("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Mu(e,n.path.toString())}function Uu(e,t){var n,r,i,a;return null===ar((e=De(e))._path)?(n="child",r="path",a=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),qo(n,r,i,a)):qo("child","path",t,!1),new Ou(e._repo,hr(e._path,t))}function Vu(e,t){e=De(e),zo("push",e._path),Fo("push",t,e._path,!0);var n,r=eu(e._repo),i=ri(r),a=Uu(e,i),o=Uu(e,i);return n=null!=t?ju(o,t).then((function(){return o})):Promise.resolve(o),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Bu(e){return zo("remove",e._path),ju(e,null)}function ju(e,t){e=De(e),zo("set",e._path),Fo("set",t,e._path,!1);var n=new J;return uu(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function qu(e,t){e=De(e),zo("setPriority",e._path),Bo("setPriority",t,!1);var n=new J;return uu(e._repo,hr(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function zu(e,t,n){if(zo("setWithPriority",e._path),Fo("setWithPriority",t,e._path,!1),Bo("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new J;return uu(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function Wu(e,t){Vo("update",t,e._path,!1);var n=new J;return function(e,t,n,r){fu(e,"update",{path:t.toString(),value:n});var i=!0,a=tu(e),o={};if(In(n,(function(n,r){i=!1,o[n]=ko(hr(t,n),$r(r),e.serverSyncTree_,a)})),i)hn("update() called with empty data.  Don't do anything."),du(0,r,"ok",void 0);else{var u=au(e),s=Qa(e.serverSyncTree_,t,o,u);Ho(e.eventQueue_,s),e.server_.merge(t.toString(),n,(function(n,i){var a="ok"===n;a||vn("update at "+t+" failed: "+n);var o=Ya(e.serverSyncTree_,u,!a),s=o.length>0?mu(e,t):t;Qo(e.eventQueue_,s,o),du(0,r,n,i)})),In(n,(function(n){var r=bu(e,hr(t,n));mu(e,r)})),Qo(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}var Ku=function(){function e(t){S(this,e),this.callbackContext=t}return N(e,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new Tu("value",this,new Lu(e.snapshotNode,new Ou(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new Su(this,e,t):null}},{key:"matches",value:function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),e}(),Hu=function(){function e(t,n){S(this,e),this.eventType=t,this.callbackContext=n}return N(e,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new Su(this,e,t):null}},{key:"createEvent",value:function(e,t){q(null!=e.childName,"Child events should have a childName.");var n=Uu(new Ou(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Tu(e.type,this,new Lu(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),e}();function Gu(e,t,n,r,i){var a;if("object"===typeof r&&(a=void 0,i=r),"function"===typeof r&&(a=r),i&&i.onlyOnce){var o=n,u=function(t,n){lu(e._repo,e,c),o(t,n)};u.userCallback=n.userCallback,u.context=n.context,n=u}var s=new Cu(n,a||void 0),c="value"===t?new Ku(s):new Hu(t,s);return function(e,t,n){var r;r=".info"===ar(t._path)?eo(e.infoSyncTree_,t,n):eo(e.serverSyncTree_,t,n),Go(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return lu(e._repo,e,c)}}function Qu(e,t,n,r){return Gu(e,"value",t,n,r)}function Yu(e,t,n,r){return Gu(e,"child_added",t,n,r)}function Ju(e,t,n,r){return Gu(e,"child_changed",t,n,r)}function Xu(e,t,n,r){return Gu(e,"child_moved",t,n,r)}function $u(e,t,n,r){return Gu(e,"child_removed",t,n,r)}function Zu(e,t,n){var r=null,i=n?new Cu(n):null;"value"===t?r=new Ku(i):t&&(r=new Hu(t,i)),lu(e._repo,e,r)}var es=N((function e(){S(this,e)})),ts=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this))._value=e,i._key=r,i}return N(n,[{key:"_apply",value:function(e){Fo("endAt",this._value,e._path,!0);var t=vi(e._queryParams,this._value,this._key);if(Ru(t),Pu(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Au(e._repo,e._path,t,e._orderByCalled)}}]),n}(es);function ns(e,t){return jo("endAt","key",t,!0),new ts(e,t)}var rs=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this))._value=e,i._key=r,i}return N(n,[{key:"_apply",value:function(e){Fo("endBefore",this._value,e._path,!1);var t=function(e,t,n){var r;return e.index_===Sr?("string"===typeof t&&(t=ai(t)),r=vi(e,t,n)):r=vi(e,t,null==n?mn:ai(n)),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(Ru(t),Pu(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Au(e._repo,e._path,t,e._orderByCalled)}}]),n}(es);function is(e,t){return jo("endBefore","key",t,!0),new rs(e,t)}var as=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this))._value=e,i._key=r,i}return N(n,[{key:"_apply",value:function(e){Fo("startAt",this._value,e._path,!0);var t=pi(e._queryParams,this._value,this._key);if(Ru(t),Pu(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Au(e._repo,e._path,t,e._orderByCalled)}}]),n}(es);function os(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return jo("startAt","key",t,!0),new as(e,t)}var us=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this))._value=e,i._key=r,i}return N(n,[{key:"_apply",value:function(e){Fo("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;return e.index_===Sr?("string"===typeof t&&(t=ii(t)),r=pi(e,t,n)):r=pi(e,t,null==n?gn:ii(n)),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Ru(t),Pu(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Au(e._repo,e._path,t,e._orderByCalled)}}]),n}(es);function ss(e,t){return jo("startAfter","key",t,!0),new us(e,t)}var cs=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this))._limit=e,r}return N(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Au(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(es);function ls(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new cs(e)}var hs=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this))._limit=e,r}return N(n,[{key:"_apply",value:function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Au(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}]),n}(es);function fs(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new hs(e)}var ds=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this))._path=e,r}return N(n,[{key:"_apply",value:function(e){Du(e,"orderByChild");var t=new rr(this._path);if(fr(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new Zr(t),r=yi(e._queryParams,n);return Pu(r),new Au(e._repo,e._path,r,!0)}}]),n}(es);function ps(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return qo("orderByChild","path",e,!1),new ds(e)}var vs=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"_apply",value:function(e){Du(e,"orderByKey");var t=yi(e._queryParams,Sr);return Pu(t),new Au(e._repo,e._path,t,!0)}}]),n}(es);function ys(){return new vs}var ms=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"_apply",value:function(e){Du(e,"orderByPriority");var t=yi(e._queryParams,Wr);return Pu(t),new Au(e._repo,e._path,t,!0)}}]),n}(es);function gs(){return new ms}var ks=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"_apply",value:function(e){Du(e,"orderByValue");var t=yi(e._queryParams,ti);return Pu(t),new Au(e._repo,e._path,t,!0)}}]),n}(es);function ws(){return new ks}var _s=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this))._value=e,i._key=r,i}return N(n,[{key:"_apply",value:function(e){if(Fo("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ts(this._value,this._key)._apply(new as(this._value,this._key)._apply(e))}}]),n}(es);function bs(e,t){return jo("equalTo","key",t,!0),new _s(e,t)}function xs(e){for(var t=De(e),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];t=u._apply(t)}return t}!function(e){q(!Ta,"__referenceConstructor has already been defined"),Ta=e}(Ou),function(e){q(!Ra,"__referenceConstructor has already been defined"),Ra=e}(Ou);var Is={},Es=!1;function Ts(e,t,n,r){e.repoInfo_=new Vn("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}function Ss(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||pn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),hn("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,u=Iu(a,i),s=u.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,a="http://".concat(c,"?ns=").concat(s.namespace),s=(u=Iu(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new On(On.OWNER):new Rn(e.name,e.options,t);Wo("Invalid Firebase Database URL",u),fr(u.path)||pn("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Is[t.name];i||(i={},Is[t.name]=i);var a=i[e.toURLString()];a&&pn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new $o(e,Es,n,r),i[e.toURLString()]=a,a}(s,e,l,new Pn(e.name,n));return new Cs(h,e)}var Cs=function(){function e(t,n){S(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return N(e,[{key:"_repo",get:function(){return this._instanceStarted||(Zo(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Ou(this._repo,ir())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=Is[t];n&&n[e.key]===e||pn("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),hu(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&pn("Cannot call "+e+" on a deleted database.")}}]),e}();function Ns(){$n.IS_TRANSPORT_INITIALIZED&&vn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function As(){Ns(),Qn.forceDisallow()}function Ds(){Ns(),Xn.forceDisallow(),Qn.forceAllow()}function Ps(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=De(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&pn("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&pn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new On(On.OWNER);else if(r.mockUserToken){var o="string"===typeof r.mockUserToken?r.mockUserToken:X(r.mockUserToken,e.app.options.projectId);a=new On(o)}Ts(i,t,n,a)}function Rs(e){(e=De(e))._checkNotDeleted("goOffline"),hu(e._repo)}function Os(e){var t;(e=De(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Xo)}function Ls(e,t){ln(e,t)}var Ms={".sv":"timestamp"};var Fs=function(){function e(t,n){S(this,e),this.committed=t,this.snapshot=n}return N(e,[{key:"toJSON",value:function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}();function Us(e,t,n){var r;if(e=De(e),zo("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new J,o=Qu(e,(function(){}));return function(e,t,n,r,i,a){fu(e,"transaction on "+t);var o={path:t,update:n,onComplete:r,status:null,order:an(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=pu(e,t,void 0);o.currentInputSnapshot=u;var s=o.update(u.val());if(void 0===s)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Uo("transaction failed: Data returned ",s,o.path),o.status=0;var c,l=xo(e.transactionQueueTree_,t),h=Io(l)||[];h.push(o),Eo(l,h),"object"===typeof s&&null!==s&&de(s,".priority")?(c=pe(s,".priority"),q(Mo(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(to(e.serverSyncTree_,t)||Jr.EMPTY_NODE).getPriority().val();var f=tu(e),d=$r(s,c),p=wo(d,u,f);o.currentOutputSnapshotRaw=d,o.currentOutputSnapshotResolved=p,o.currentWriteId=au(e);var v=Ga(e.serverSyncTree_,t,p,o.currentWriteId,o.applyLocally);Qo(e.eventQueue_,t,v),vu(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?a.reject(t):(i=new Lu(r,new Ou(e._repo,e._path),Wr),a.resolve(new Fs(n,i)))}),o,i),a.promise}br.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},br.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Vs;!function(e){Xt(Et),gt(new Pe("database",(function(e,t){var n=t.instanceIdentifier;return Ss(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Dt(Qt,Yt,e),Dt(Qt,Yt,"esm2017")}();var Bs=function(){function e(t,n){var r=this;S(this,e),this._delegate=t,this.firebase=n,yt(t,new Pe("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return N(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),Nt(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ft;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ft;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){yt(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){mt(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),js=(m(Vs={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),m(Vs,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Vs),qs=new ue("app-compat","Firebase",js);var zs=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var i=Tt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(de(n,i.name))return n[i.name];var a=new t(i,r);return n[i.name]=a,a},app:i,registerVersion:Dt,setLogLevel:Rt,onLog:Pt,apps:null,SDK_VERSION:Et,INTERNAL:{registerComponent:function(e){var n=e.name,a=n.replace("-compat","");if(gt(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw qs.create("invalid-app-argument",{appName:n});return e[a]()};void 0!==e.serviceProps&&Y(o,e.serviceProps),r[a]=o,t.prototype[a]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!de(n,e=e||ft))throw qs.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),i.App=t,r}(Bs);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){Y(n,e)},createSubscribe:xe,ErrorFactory:ue,deepExtend:Y}),n}(),Ws=new ze("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){Ws.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ks=self.firebase.SDK_VERSION;Ks&&Ks.indexOf("LITE")>=0&&Ws.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Hs=zs;!function(e){Dt("@firebase/app-compat","0.1.28",e)}();function Gs(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}function Qs(){return Qs="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Gs(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Qs.apply(this,arguments)}Hs.registerVersion("firebase","9.8.4","app-compat");function Ys(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;var Js;Object.create;var Xs="facebook.com",$s="github.com",Zs="google.com",ec="password",tc="twitter.com",nc="EMAIL_SIGNIN",rc="PASSWORD_RESET",ic="RECOVER_EMAIL",ac="REVERT_SECOND_FACTOR_ADDITION",oc="VERIFY_AND_CHANGE_EMAIL",uc="VERIFY_EMAIL";function sc(){return m({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var cc=function(){var e;return m(e={},"admin-restricted-operation","This operation is restricted to administrators only."),m(e,"argument-error",""),m(e,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),m(e,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),m(e,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),m(e,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),m(e,"cordova-not-ready","Cordova framework is not ready."),m(e,"cors-unsupported","This browser is not supported."),m(e,"credential-already-in-use","This credential is already associated with a different user account."),m(e,"custom-token-mismatch","The custom token corresponds to a different audience."),m(e,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),m(e,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),m(e,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),m(e,"email-change-needs-verification","Multi-factor users must always have a verified email."),m(e,"email-already-in-use","The email address is already in use by another account."),m(e,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),m(e,"expired-action-code","The action code has expired."),m(e,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),m(e,"internal-error","An internal AuthError has occurred."),m(e,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),m(e,"invalid-app-id","The mobile app identifier is not registed for the current project."),m(e,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),m(e,"invalid-auth-event","An internal AuthError has occurred."),m(e,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),m(e,"invalid-continue-uri","The continue URL provided in the request is invalid."),m(e,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),m(e,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),m(e,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),m(e,"invalid-email","The email address is badly formatted."),m(e,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),m(e,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),m(e,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),m(e,"invalid-credential","The supplied auth credential is malformed or has expired."),m(e,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),m(e,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),m(e,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),m(e,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),m(e,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),m(e,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),m(e,"wrong-password","The password is invalid or the user does not have a password."),m(e,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),m(e,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),m(e,"invalid-provider-id","The specified provider ID is invalid."),m(e,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),m(e,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),m(e,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),m(e,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),m(e,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),m(e,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),m(e,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),m(e,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),m(e,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),m(e,"missing-continue-uri","A continue URL must be provided in the request."),m(e,"missing-iframe-start","An internal AuthError has occurred."),m(e,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),m(e,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),m(e,"missing-multi-factor-info","No second factor identifier is provided."),m(e,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),m(e,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),m(e,"missing-verification-id","The phone auth credential was created with an empty verification ID."),m(e,"app-deleted","This instance of FirebaseApp has been deleted."),m(e,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),m(e,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),m(e,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),m(e,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),m(e,"no-auth-event","An internal AuthError has occurred."),m(e,"no-such-provider","User was not linked to an account with the given provider."),m(e,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),m(e,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),m(e,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),m(e,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),m(e,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),m(e,"provider-already-linked","User can only be linked to one identity for the given provider."),m(e,"quota-exceeded","The project's quota for this operation has been exceeded."),m(e,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),m(e,"redirect-operation-pending","A redirect sign-in operation is already pending."),m(e,"rejected-credential","The request contains malformed or mismatching credentials."),m(e,"second-factor-already-in-use","The second factor is already enrolled on this account."),m(e,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),m(e,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),m(e,"timeout","The operation has timed out."),m(e,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),m(e,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),m(e,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),m(e,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),m(e,"unsupported-persistence-type","The current environment does not support the specified persistence type."),m(e,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),m(e,"unverified-email","The operation requires a verified email."),m(e,"user-cancelled","The user did not grant your application the permissions it requested."),m(e,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),m(e,"user-disabled","The user account has been disabled by an administrator."),m(e,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),m(e,"user-signed-out",""),m(e,"weak-password","The password must be 6 characters long or more."),m(e,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),m(e,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),e},lc=sc,hc=new ue("auth","Firebase",sc()),fc=new ze("@firebase/auth");function dc(e){if(fc.logLevel<=Me.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];fc.error.apply(fc,["Auth (".concat(Et,"): ").concat(e)].concat(n))}}function pc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw gc.apply(void 0,[e].concat(n))}function vc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return gc.apply(void 0,[e].concat(n))}function yc(e,t,n){var r=Object.assign(Object.assign({},lc()),m({},t,n));return new ue("auth","Firebase",r).create(t,{appName:e.name})}function mc(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&pc(e,"argument-error"),yc(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function gc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var i,a=n[0],o=u(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(u(o)))}return hc.create.apply(hc,[e].concat(n))}function kc(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw gc.apply(void 0,[t].concat(r))}}function wc(e){var t="INTERNAL ASSERTION FAILED: "+e;throw dc(t),new Error(t)}function _c(e,t){e||wc(t)}var bc=new Map;function xc(e){_c(e instanceof Function,"Expected a class definition");var t=bc.get(e);return t?(_c(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,bc.set(e,t),t)}function Ic(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ec(){return"http:"===Tc()||"https:"===Tc()}function Tc(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Sc=function(){function e(t,n){S(this,e),this.shortDelay=t,this.longDelay=n,_c(n>t,"Short delay should be less than long delay!"),this.isMobile=Z()||ne()}return N(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Ec()||te()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function Cc(e,t){_c(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Nc=function(){function e(){S(this,e)}return N(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void wc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void wc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void wc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Ac=(m(Js={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),m(Js,"MISSING_CUSTOM_TOKEN","internal-error"),m(Js,"INVALID_IDENTIFIER","invalid-email"),m(Js,"MISSING_CONTINUE_URI","internal-error"),m(Js,"INVALID_PASSWORD","wrong-password"),m(Js,"MISSING_PASSWORD","internal-error"),m(Js,"EMAIL_EXISTS","email-already-in-use"),m(Js,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),m(Js,"INVALID_IDP_RESPONSE","invalid-credential"),m(Js,"INVALID_PENDING_TOKEN","invalid-credential"),m(Js,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),m(Js,"MISSING_REQ_TYPE","internal-error"),m(Js,"EMAIL_NOT_FOUND","user-not-found"),m(Js,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),m(Js,"EXPIRED_OOB_CODE","expired-action-code"),m(Js,"INVALID_OOB_CODE","invalid-action-code"),m(Js,"MISSING_OOB_CODE","internal-error"),m(Js,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),m(Js,"INVALID_ID_TOKEN","invalid-user-token"),m(Js,"TOKEN_EXPIRED","user-token-expired"),m(Js,"USER_NOT_FOUND","user-token-expired"),m(Js,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),m(Js,"INVALID_CODE","invalid-verification-code"),m(Js,"INVALID_SESSION_INFO","invalid-verification-id"),m(Js,"INVALID_TEMPORARY_PROOF","invalid-credential"),m(Js,"MISSING_SESSION_INFO","missing-verification-id"),m(Js,"SESSION_EXPIRED","code-expired"),m(Js,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),m(Js,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),m(Js,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),m(Js,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),m(Js,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),m(Js,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),m(Js,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),m(Js,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),m(Js,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),m(Js,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),m(Js,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),Js),Dc=new Sc(3e4,6e4);function Pc(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Rc(e,t,n,r){return Oc.apply(this,arguments)}function Oc(){return Oc=E(x().mark((function e(t,n,r,i){var a,o=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Lc(t,a,E(x().mark((function e(){var a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),u=ke(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(s=e.sent)["Content-Type"]="application/json",t.languageCode&&(s["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",Nc.fetch()(Vc(t,t.config.apiHost,r,u),Object.assign({method:n,headers:s,referrerPolicy:"no-referrer"},a)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Oc.apply(this,arguments)}function Lc(e,t,n){return Mc.apply(this,arguments)}function Mc(){return(Mc=E(x().mark((function e(t,n,r){var i,a,o,u,s,c,h,f,d,p;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},Ac),n),e.prev=2,a=new Bc(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(u=e.sent))){e.next=13;break}throw jc(t,"account-exists-with-different-credential",u);case 13:if(!o.ok||"errorMessage"in u){e.next=17;break}return e.abrupt("return",u);case 17:if(s=o.ok?u.errorMessage:u.error.message,c=s.split(" : "),h=l(c,2),f=h[0],d=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=23;break}throw jc(t,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==f){e.next=27;break}throw jc(t,"email-already-in-use",u);case 27:if("USER_DISABLED"!==f){e.next=29;break}throw jc(t,"user-disabled",u);case 29:if(p=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!d){e.next=34;break}throw yc(t,p,d);case 34:pc(t,p);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof oe)){e.next=41;break}throw e.t0;case 41:pc(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])})))).apply(this,arguments)}function Fc(e,t,n,r){return Uc.apply(this,arguments)}function Uc(){return Uc=E(x().mark((function e(t,n,r,i){var a,o,u=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>4&&void 0!==u[4]?u[4]:{},e.next=3,Rc(t,n,r,i,a);case 3:return"mfaPendingCredential"in(o=e.sent)&&pc(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Uc.apply(this,arguments)}function Vc(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Cc(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Bc=function(){function e(t){var n=this;S(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(vc(n.auth,"network-request-failed"))}),Dc.get())}))}return N(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function jc(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=vc(e,t,r);return i.customData._tokenResponse=n,i}function qc(e,t){return zc.apply(this,arguments)}function zc(){return(zc=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wc(e,t){return Kc.apply(this,arguments)}function Kc(){return(Kc=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hc(e,t){return Gc.apply(this,arguments)}function Gc(){return(Gc=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qc(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function Yc(){return Yc=E(x().mark((function e(t){var n,r,i,a,o,u,s=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]&&s[1],r=De(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,kc((a=Xc(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"===typeof a.firebase?a.firebase:void 0,u=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:Qc(Jc(a.auth_time)),issuedAtTime:Qc(Jc(a.iat)),expirationTime:Qc(Jc(a.exp)),signInProvider:u||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),Yc.apply(this,arguments)}function Jc(e){return 1e3*Number(e)}function Xc(e){var t,n=l(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return dc("JWT malformed, contained fewer than 3 sections"),null;try{var o=Q(i);return o?JSON.parse(o):(dc("Failed to decode base64 JWT payload"),null)}catch(u){return dc("Caught error parsing JWT payload as JSON",null===(t=u)||void 0===t?void 0:t.toString()),null}}function $c(e,t){return Zc.apply(this,arguments)}function Zc(){return Zc=E(x().mark((function e(t,n){var r=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof oe&&el(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),Zc.apply(this,arguments)}function el(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var tl=function(){function e(t){S(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return N(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===(t=e.t0)||void 0===t?void 0:t.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),nl=function(){function e(t,n){S(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return N(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=Qc(this.lastLoginAt),this.creationTime=Qc(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function rl(e){return il.apply(this,arguments)}function il(){return il=E(x().mark((function e(t){var n,r,i,a,o,u,s,c,l,h,f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,$c(t,Hc(r,{idToken:i}));case 6:kc(null===(a=e.sent)||void 0===a?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),u=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?ul(o.providerUserInfo):[],s=ol(t.providerData,u),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===s||void 0===s?void 0:s.length),h=!!c&&l,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new nl(o.createdAt,o.lastLoginAt),isAnonymous:h},Object.assign(t,f);case 17:case"end":return e.stop()}}),e)}))),il.apply(this,arguments)}function al(){return(al=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=De(t),e.next=3,rl(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ol(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(u(n),u(t))}function ul(e){return e.map((function(e){var t=e.providerId,n=Ys(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function sl(e,t){return cl.apply(this,arguments)}function cl(){return(cl=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lc(t,{},E(x().mark((function e(){var r,i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ke({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,u=Vc(t,a,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(s=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",Nc.fetch()(u,{method:"POST",headers:s,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ll=function(){function e(){S(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return N(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){kc(e.idToken,"internal-error"),kc("undefined"!==typeof e.idToken,"internal-error"),kc("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=Xc(e);return kc(t,"internal-error"),kc("undefined"!==typeof t.exp,"internal-error"),kc("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=E(x().mark((function e(t){var n,r=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],kc(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sl(t,n);case 2:r=e.sent,i=r.accessToken,a=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(i,a,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return wc("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(kc("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(kc("string"===typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(kc("number"===typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function hl(e,t){kc("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var fl=function(){function e(t){S(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=Ys(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new tl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?u(a.providerData):[],this.metadata=new nl(a.createdAt||void 0,a.lastLoginAt||void 0)}return N(e,[{key:"getIdToken",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$c(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(kc(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return Yc.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return al.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(kc(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){kc(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=E(x().mark((function e(t){var n,r,i=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,rl(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,$c(this,qc(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,u,s,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,p=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,w=n.emailVerified,_=n.isAnonymous,b=n.providerData,x=n.stsTokenManager;kc(k&&x,t,"internal-error");var I=ll.fromJSON(this.name,x);kc("string"===typeof k,t,"internal-error"),hl(h,t.name),hl(f,t.name),kc("boolean"===typeof w,t,"internal-error"),kc("boolean"===typeof _,t,"internal-error"),hl(d,t.name),hl(p,t.name),hl(v,t.name),hl(y,t.name),hl(m,t.name),hl(g,t.name);var E=new e({uid:k,auth:t,email:f,emailVerified:w,displayName:h,isAnonymous:_,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:I,createdAt:m,lastLoginAt:g});return b&&Array.isArray(b)&&(E.providerData=b.map((function(e){return Object.assign({},e)}))),y&&(E._redirectEventId=y),E}},{key:"_fromIdTokenResponse",value:function(){var t=E(x().mark((function t(n,r){var i,a,o,u=arguments;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]&&u[2],(a=new ll).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:a,isAnonymous:i}),t.next=6,rl(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),dl=function(){function e(){S(this,e),this.type="NONE",this.storage={}}return N(e,[{key:"_isAvailable",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();dl.type="NONE";var pl=dl;function vl(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var yl=function(){function e(t,n,r){S(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=vl(this.userKey,a.apiKey,o),this.fullPersistenceKey=vl("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return N(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?fl._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=E(x().mark((function t(n,r){var i,a,o,u,s,c,l,h,f,d,p,v=arguments;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(xc(pl),n,i));case 3:return t.next=5,Promise.all(r.map(function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:a=t.sent.filter((function(e){return e})),o=a[0]||xc(pl),u=vl(i,n.config.apiKey,n.name),s=null,c=T(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return h=l.value,t.prev=14,t.next=17,h._get(u);case 17:if(!(f=t.sent)){t.next=23;break}return d=fl._fromJSON(n,f),h!==o&&(s=d),o=h,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(p=a.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&p.length){t.next=40;break}return t.abrupt("return",new e(o,n,i));case 40:if(o=p[0],!s){t.next=44;break}return t.next=44,o._set(u,s.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(u);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,i));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function ml(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(_l(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(gl(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(xl(t))return"Blackberry";if(Il(t))return"Webos";if(kl(t))return"Safari";if((t.includes("chrome/")||wl(t))&&!t.includes("edge/"))return"Chrome";if(bl(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function gl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/firefox\//i.test(e)}function kl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function wl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/crios\//i.test(e)}function _l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/iemobile/i.test(e)}function bl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/android/i.test(e)}function xl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/blackberry/i.test(e)}function Il(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/webos/i.test(e)}function El(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/iphone|ipad|ipod/i.test(e)}function Tl(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return El(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function Sl(){return re()&&10===document.documentMode}function Cl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return El(e)||bl(e)||Il(e)||xl(e)||/windows phone/i.test(e)||_l(e)}function Nl(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ml($());break;case"Worker":t="".concat(ml($()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Et,"/").concat(r)}var Al=function(){function e(t){S(this,e),this.auth=t,this.queue=[]}return N(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(i){r(i)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=E(x().mark((function e(t){var n,r,i,a,o,u,s,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:r=[],e.prev=3,i=T(this.queue),e.prev=5,i.s();case 7:if((a=i.n()).done){e.next=14;break}return o=a.value,e.next=11,o(t);case 11:o.onAbort&&r.push(o.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),r.reverse(),u=T(r);try{for(u.s();!(s=u.n()).done;){c=s.value;try{c()}catch(l){}}}catch(h){u.e(h)}finally{u.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(n=e.t1)||void 0===n?void 0:n.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Dl=function(){function e(t,n,r){S(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rl(this),this.idTokenSubscription=new Rl(this),this.beforeStateQueue=new Al(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hc,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return N(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=xc(t)),this._initializationPromise=this.queue(E(x().mark((function r(){var i,a;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,yl.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=E(x().mark((function e(t){var n,r,i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,i=r,a=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,u=null===i||void 0===i?void 0:i._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:s=e.sent,o&&o!==u||!(null===s||void 0===s?void 0:s.user)||(i=s.user,a=!0);case 14:if(i){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(i._redirectEventId){e.next=32;break}if(!a){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(i);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),i=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!i){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return kc(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==i._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(i));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(i));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rl(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===(n=e.t0)||void 0===n?void 0:n.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?De(t):null)&&kc(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=E(x().mark((function e(t){var n,r=this,i=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&kc(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(E(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(xc(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new ue("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return kc(n=t&&xc(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,yl.create(this,[xc(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=E(x().mark((function e(t){var n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return kc(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,!t){e.next=7;break}return e.next=5,this.assertedPersistence.setCurrentUser(t);case 5:e.next=9;break;case 7:return e.next=9,this.assertedPersistence.removeCurrentUser();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return kc(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nl(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=E(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Pl(e){return De(e)}var Rl=function(){function e(t){var n=this;S(this,e),this.auth=t,this.observer=null,this.addObserver=xe((function(e){return n.observer=e}))}return N(e,[{key:"next",get:function(){return kc(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function Ol(e,t,n){var r=Pl(e);kc(r._canInitEmulator,r,"emulator-config-failed"),kc(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=Ll(t),o=function(e){var t=Ll(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:Ml(r.substr(a.length+1))}}var o=l(r.split(":"),2);return{host:o[0],port:Ml(o[1])}}(t),u=o.host,s=o.port,c=null===s?"":":".concat(s);r.config.emulator={url:"".concat(a,"//").concat(u).concat(c,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:s,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ll(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ml(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Fl=function(){function e(t,n){S(this,e),this.providerId=t,this.signInMethod=n}return N(e,[{key:"toJSON",value:function(){return wc("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return wc("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return wc("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return wc("not implemented")}}]),e}();function Ul(e,t){return Vl.apply(this,arguments)}function Vl(){return(Vl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:resetPassword",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bl(e,t){return jl.apply(this,arguments)}function jl(){return(jl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ql(e,t){return zl.apply(this,arguments)}function zl(){return(zl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:update",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wl(e,t){return Kl.apply(this,arguments)}function Kl(){return(Kl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithPassword",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Hl(e,t){return Gl.apply(this,arguments)}function Gl(){return(Gl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:sendOobCode",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ql(e,t){return Yl.apply(this,arguments)}function Yl(){return(Yl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hl(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jl(e,t){return Xl.apply(this,arguments)}function Xl(){return(Xl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hl(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $l(e,t){return Zl.apply(this,arguments)}function Zl(){return(Zl=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hl(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eh(e,t){return th.apply(this,arguments)}function th(){return(th=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hl(t,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nh(e,t){return rh.apply(this,arguments)}function rh(){return(rh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithEmailLink",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ih(e,t){return ah.apply(this,arguments)}function ah(){return(ah=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithEmailLink",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oh=function(e){P(n,e);var t=M(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return S(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return N(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Wl(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",nh(t,{email:this._email,oobCode:this._password}));case 5:pc(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Bl(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",ih(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:pc(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Fl);function uh(e,t){return sh.apply(this,arguments)}function sh(){return(sh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithIdp",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ch=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return N(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return uh(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,uh(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,uh(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ke(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pc("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=Ys(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(Fl);function lh(e,t){return hh.apply(this,arguments)}function hh(){return(hh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:sendVerificationCode",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fh(){return(fh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithPhoneNumber",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dh(){return(dh=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fc(t,"POST","/v1/accounts:signInWithPhoneNumber",Pc(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw jc(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ph=m({},"USER_NOT_FOUND","user-not-found");function vh(){return(vh=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithPhoneNumber",Pc(t,r),ph));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yh=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this,"phone","phone")).params=e,r}return N(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return fh.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return dh.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return vh.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,i=t.verificationCode,a=t.phoneNumber,o=t.temporaryProof;return i||r||a||o?new n({verificationId:r,verificationCode:i,phoneNumber:a,temporaryProof:o}):null}}]),n}(Fl);var mh=function(){function e(t){var n,r,i,a,o,u;S(this,e);var s=we(_e(t)),c=null!==(n=s.apiKey)&&void 0!==n?n:null,l=null!==(r=s.oobCode)&&void 0!==r?r:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=s.mode)&&void 0!==i?i:null);kc(c&&l&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=l,this.continueUrl=null!==(a=s.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=s.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(u=s.tenantId)&&void 0!==u?u:null}return N(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=we(_e(e)).link,n=t?we(_e(t)).deep_link_id:null,r=we(_e(e)).deep_link_id;return(r?we(_e(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(SA){return null}}}]),e}();var gh=function(){function e(){S(this,e),this.providerId=e.PROVIDER_ID}return N(e,null,[{key:"credential",value:function(e,t){return oh._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=mh.parseLink(t);return kc(n,"argument-error"),oh._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();gh.PROVIDER_ID="password",gh.EMAIL_PASSWORD_SIGN_IN_METHOD="password",gh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var kh=function(){function e(t){S(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return N(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),wh=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.apply(this,arguments)).scopes=[],e}return N(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return u(this.scopes)}}]),n}(kh),_h=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return kc(e.idToken||e.accessToken,"argument-error"),ch._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;return kc("providerId"in t&&"signInMethod"in t,"argument-error"),ch._fromParams(t)}},{key:"credentialFromResult",value:function(e){return n.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!i&&!a&&!r&&!o)return null;if(!s)return null;try{return new n(s)._credential({idToken:r,accessToken:i,nonce:u,pendingToken:o})}catch(c){return null}}}]),n}(wh),bh=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.call(this,"facebook.com")}return N(n,null,[{key:"credential",value:function(e){return ch._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(SA){return null}}}]),n}(wh);bh.FACEBOOK_SIGN_IN_METHOD="facebook.com",bh.PROVIDER_ID="facebook.com";var xh=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return N(n,null,[{key:"credential",value:function(e,t){return ch._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(SA){return null}}}]),n}(wh);xh.GOOGLE_SIGN_IN_METHOD="google.com",xh.PROVIDER_ID="google.com";var Ih=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.call(this,"github.com")}return N(n,null,[{key:"credential",value:function(e){return ch._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(SA){return null}}}]),n}(wh);Ih.GITHUB_SIGN_IN_METHOD="github.com",Ih.PROVIDER_ID="github.com";var Eh=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,e)).pendingToken=r,i}return N(n,[{key:"_getIdTokenResponse",value:function(e){return uh(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,uh(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,uh(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=t.pendingToken;return r&&i&&a&&r===i?new n(r,a):null}},{key:"_create",value:function(e,t){return new n(e,t)}}]),n}(Fl),Th=function(e){P(n,e);var t=M(n);function n(e){return S(this,n),kc(e.startsWith("saml."),"argument-error"),t.call(this,e)}return N(n,null,[{key:"credentialFromResult",value:function(e){return n.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=Eh.fromJSON(e);return kc(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return Eh._create(r,n)}catch(i){return null}}}]),n}(kh),Sh=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.call(this,"twitter.com")}return N(n,null,[{key:"credential",value:function(e,t){return ch._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,i=t.oauthTokenSecret;if(!r||!i)return null;try{return n.credential(r,i)}catch(SA){return null}}}]),n}(wh);function Ch(e,t){return Nh.apply(this,arguments)}function Nh(){return(Nh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signUp",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Sh.TWITTER_SIGN_IN_METHOD="twitter.com",Sh.PROVIDER_ID="twitter.com";var Ah=function(){function e(t){S(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return N(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=E(x().mark((function t(n,r,i){var a,o,u,s,c=arguments;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>3&&void 0!==c[3]&&c[3],t.next=3,fl._fromIdTokenResponse(n,i,a);case 3:return o=t.sent,u=Dh(i),s=new e({user:o,providerId:u,_tokenResponse:i,operationType:r}),t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=E(x().mark((function t(n,r,i){var a;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(i,!0);case 2:return a=Dh(i),t.abrupt("return",new e({user:n,providerId:a,_tokenResponse:i,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function Dh(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function Ph(){return Ph=E(x().mark((function e(t){var n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pl(t),e.next=3,r._initializationPromise;case 3:if(!(null===(n=r.currentUser)||void 0===n?void 0:n.isAnonymous)){e.next=5;break}return e.abrupt("return",new Ah({user:r.currentUser,providerId:null,operationType:"signIn"}));case 5:return e.next=7,Ch(r,{returnSecureToken:!0});case 7:return i=e.sent,e.next=10,Ah._fromIdTokenResponse(r,"signIn",i,!0);case 10:return a=e.sent,e.next=13,r._updateCurrentUser(a.user);case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)}))),Ph.apply(this,arguments)}var Rh=function(e){P(n,e);var t=M(n);function n(e,r,i,a){var o,u;return S(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(A(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(u=e.tenantId)&&void 0!==u?u:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return N(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(oe);function Oh(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw Rh._fromErrorAndOperation(e,n,t,r);throw n}))}function Lh(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function Mh(e,t){return Fh.apply(this,arguments)}function Fh(){return Fh=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=De(t),e.next=3,Bh(!0,r,n);case 3:return e.t0=Wc,e.t1=r.auth,e.next=7,r.getIdToken();case 7:return e.t2=e.sent,e.t3=[n],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return i=e.sent,a=i.providerUserInfo,o=Lh(a||[]),r.providerData=r.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(r.phoneNumber=null),e.next=19,r.auth._persistUserIfCurrent(r);case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e)}))),Fh.apply(this,arguments)}function Uh(e,t){return Vh.apply(this,arguments)}function Vh(){return Vh=E(x().mark((function e(t,n){var r,i,a=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=$c,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",Ah._forOperation(t,"link",i));case 14:case"end":return e.stop()}}),e)}))),Vh.apply(this,arguments)}function Bh(e,t,n){return jh.apply(this,arguments)}function jh(){return(jh=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rl(n);case 2:i=Lh(n.providerData),a=!1===t?"provider-already-linked":"no-such-provider",kc(i.has(r)===t,n.auth,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qh(e,t){return zh.apply(this,arguments)}function zh(){return zh=E(x().mark((function e(t,n){var r,i,a,o,u,s,c,l=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=3,e.next=6,$c(t,Oh(a,o,n,t),r);case 6:return kc((u=e.sent).idToken,a,"internal-error"),kc(s=Xc(u.idToken),a,"internal-error"),c=s.sub,kc(t.uid===c,a,"user-mismatch"),e.abrupt("return",Ah._forOperation(t,o,u));case 15:throw e.prev=15,e.t0=e.catch(3),(null===(i=e.t0)||void 0===i?void 0:i.code)==="auth/".concat("user-not-found")&&pc(a,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),zh.apply(this,arguments)}function Wh(e,t){return Kh.apply(this,arguments)}function Kh(){return Kh=E(x().mark((function e(t,n){var r,i,a,o,u=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],i="signIn",e.next=4,Oh(t,i,n);case 4:return a=e.sent,e.next=7,Ah._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),Kh.apply(this,arguments)}function Hh(e,t){return Gh.apply(this,arguments)}function Gh(){return(Gh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Wh(Pl(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qh(e,t){return Yh.apply(this,arguments)}function Yh(){return(Yh=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=De(t),e.next=3,Bh(!1,r,n.providerId);case 3:return e.abrupt("return",Uh(r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jh(e,t){return Xh.apply(this,arguments)}function Xh(){return(Xh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qh(De(t),n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $h(e,t){return Zh.apply(this,arguments)}function Zh(){return(Zh=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fc(t,"POST","/v1/accounts:signInWithCustomToken",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ef(){return(ef=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pl(t),e.next=3,$h(r,{token:n,returnSecureToken:!0});case 3:return i=e.sent,e.next=6,Ah._fromIdTokenResponse(r,"signIn",i);case 6:return a=e.sent,e.next=9,r._updateCurrentUser(a.user);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var tf=function(){function e(t,n){S(this,e),this.factorId=t,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}return N(e,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?nf._fromServerResponse(e,t):pc(e,"internal-error")}}]),e}(),nf=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this,"phone",e)).phoneNumber=e.phoneInfo,r}return N(n,null,[{key:"_fromServerResponse",value:function(e,t){return new n(t)}}]),n}(tf);function rf(e,t,n){var r;kc((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),kc("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(kc(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(kc(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function af(){return(af=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),a={requestType:"PASSWORD_RESET",email:n},r&&rf(i,a,r),e.next=5,Jl(i,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function of(){return(of=E(x().mark((function e(t,n,r){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ul(De(t),{oobCode:n,newPassword:r});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uf(){return(uf=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ql(De(t),{oobCode:n});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function sf(e,t){return cf.apply(this,arguments)}function cf(){return(cf=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=De(t),e.next=3,Ul(r,{oobCode:n});case 3:i=e.sent,kc(a=i.requestType,r,"internal-error"),e.t0=a,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return kc(i.newEmail,r,"internal-error"),e.abrupt("break",14);case 12:kc(i.mfaInfo,r,"internal-error");case 13:kc(i.email,r,"internal-error");case 14:return o=null,i.mfaInfo&&(o=tf._fromServerResponse(Pl(r),i.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:a});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lf(){return(lf=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sf(De(t),n);case 2:return r=e.sent,i=r.data,e.abrupt("return",i.email);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hf(e,t,n){return ff.apply(this,arguments)}function ff(){return(ff=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pl(t),e.next=3,Ch(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,Ah._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function df(){return(df=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),a={requestType:"EMAIL_SIGNIN",email:n},kc(r.handleCodeInApp,i,"argument-error"),r&&rf(i,a,r),e.next=6,$l(i,a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pf(){return(pf=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),kc((a=gh.credentialWithLink(n,r||Ic()))._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),e.abrupt("return",Hh(i,a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vf(e,t){return yf.apply(this,arguments)}function yf(){return(yf=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:createAuthUri",Pc(t,n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mf(){return(mf=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ec()?Ic():"http://localhost",i={identifier:n,continueUri:r},e.next=4,vf(De(t),i);case 4:return a=e.sent,o=a.signinMethods,e.abrupt("return",o||[]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gf(){return(gf=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=De(t),e.next=3,t.getIdToken();case 3:return i=e.sent,a={requestType:"VERIFY_EMAIL",idToken:i},n&&rf(r.auth,a,n),e.next=8,Ql(r.auth,a);case 8:if(o=e.sent,o.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kf(){return(kf=E(x().mark((function e(t,n,r){var i,a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),e.next=3,t.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:a,newEmail:n},r&&rf(i.auth,o,r),e.next=8,eh(i.auth,o);case 8:if(u=e.sent,u.email===t.email){e.next=13;break}return e.next=13,t.reload();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wf(e,t){return _f.apply(this,arguments)}function _f(){return(_f=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Rc(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bf(){return(bf=E(x().mark((function e(t,n){var r,i,a,o,u,s,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=De(t),e.next=6,a.getIdToken();case 6:return o=e.sent,u={idToken:o,displayName:r,photoUrl:i,returnSecureToken:!0},e.next=10,$c(a,wf(a.auth,u));case 10:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(c=a.providerData.find((function(e){return"password"===e.providerId})))&&(c.displayName=a.displayName,c.photoURL=a.photoURL),e.next=17,a._updateTokensIfNecessary(s);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xf(e,t,n){return If.apply(this,arguments)}function If(){return(If=E(x().mark((function e(t,n,r){var i,a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,o={idToken:a,returnSecureToken:!0},n&&(o.email=n),r&&(o.password=r),e.next=9,$c(t,Bl(i,o));case 9:return u=e.sent,e.next=12,t._updateTokensIfNecessary(u,!0);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ef=N((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};S(this,e),this.isNewUser=t,this.providerId=n,this.profile=r})),Tf=function(e){P(n,e);var t=M(n);function n(e,r,i,a){var o;return S(this,n),(o=t.call(this,e,r,i)).username=a,o}return N(n)}(Ef),Sf=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"facebook.com",r)}return N(n)}(Ef),Cf=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"github.com",r,"string"===typeof(null===r||void 0===r?void 0:r.login)?null===r||void 0===r?void 0:r.login:null)}return N(n)}(Tf),Nf=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"google.com",r)}return N(n)}(Ef),Af=function(e){P(n,e);var t=M(n);function n(e,r,i){return S(this,n),t.call(this,e,"twitter.com",r,i)}return N(n)}(Tf);function Df(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){var o=null===(n=null===(t=Xc(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new Ef(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new Sf(a,i);case"github.com":return new Cf(a,i);case"google.com":return new Nf(a,i);case"twitter.com":return new Af(a,i,e.screenName||null);case"custom":case"anonymous":return new Ef(a,null);default:return new Ef(a,r,i)}}(n)}var Pf=function(){function e(t,n){S(this,e),this.type=t,this.credential=n}return N(e,[{key:"toJSON",value:function(){return{multiFactorSession:m({},"enroll"===this.type?"idToken":"pendingCredential",this.credential)}}}],[{key:"_fromIdtoken",value:function(t){return new e("enroll",t)}},{key:"_fromMfaPendingCredential",value:function(t){return new e("signin",t)}},{key:"fromJSON",value:function(t){var n,r;if(null===t||void 0===t?void 0:t.multiFactorSession){if(null===(n=t.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return e._fromMfaPendingCredential(t.multiFactorSession.pendingCredential);if(null===(r=t.multiFactorSession)||void 0===r?void 0:r.idToken)return e._fromIdtoken(t.multiFactorSession.idToken)}return null}}]),e}(),Rf=function(){function e(t,n,r){S(this,e),this.session=t,this.hints=n,this.signInResolver=r}return N(e,[{key:"resolveSignIn",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.abrupt("return",this.signInResolver(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromError",value:function(t,n){var r=Pl(t),i=n.customData._serverResponse,a=(i.mfaInfo||[]).map((function(e){return tf._fromServerResponse(r,e)}));kc(i.mfaPendingCredential,r,"internal-error");var o=Pf._fromMfaPendingCredential(i.mfaPendingCredential);return new e(o,a,function(){var e=E(x().mark((function e(t){var a,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._process(r,o);case 2:a=e.sent,delete i.mfaInfo,delete i.mfaPendingCredential,u=Object.assign(Object.assign({},i),{idToken:a.idToken,refreshToken:a.refreshToken}),e.t0=n.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,Ah._fromIdTokenResponse(r,n.operationType,u);case 11:return s=e.sent,e.next=14,r._updateCurrentUser(s.user);case 14:return e.abrupt("return",s);case 15:return kc(n.user,r,"internal-error"),e.abrupt("return",Ah._forOperation(n.user,n.operationType,u));case 17:pc(r,"internal-error");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}();function Of(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:start",Pc(e,t))}var Lf=function(){function e(t){var n=this;S(this,e),this.user=t,this.enrolledFactors=[],t._onReload((function(e){e.mfaInfo&&(n.enrolledFactors=e.mfaInfo.map((function(e){return tf._fromServerResponse(t.auth,e)})))}))}return N(e,[{key:"getSession",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Pf,e.next=3,this.user.getIdToken();case 3:return e.t1=e.sent,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enroll",value:function(){var e=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.getSession();case 3:return i=e.sent,e.next=6,$c(this.user,r._process(this.user.auth,i,n));case 6:return a=e.sent,e.next=9,this.user._updateTokensIfNecessary(a);case 9:return e.abrupt("return",this.user.reload());case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unenroll",value:function(){var e=E(x().mark((function e(t){var n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="string"===typeof t?t:t.uid,e.next=3,this.user.getIdToken();case 3:return i=e.sent,e.next=6,$c(this.user,Rc(o=this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",Pc(o,{idToken:i,mfaEnrollmentId:r})));case 6:return a=e.sent,this.enrolledFactors=this.enrolledFactors.filter((function(e){return e.uid!==r})),e.next=10,this.user._updateTokensIfNecessary(a);case 10:return e.prev=10,e.next=13,this.user.reload();case 13:e.next=19;break;case 15:if(e.prev=15,e.t0=e.catch(10),(null===(n=e.t0)||void 0===n?void 0:n.code)==="auth/".concat("user-token-expired")){e.next=19;break}throw e.t0;case 19:case"end":return e.stop()}var o}),e,this,[[10,15]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"_fromUser",value:function(t){return new e(t)}}]),e}(),Mf=new WeakMap;var Ff="__sak",Uf=function(){function e(t,n){S(this,e),this.storageRetriever=t,this.type=n}return N(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Ff,"1"),this.storage.removeItem(Ff),Promise.resolve(!0)):Promise.resolve(!1)}catch(SA){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var Vf=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=$();return kl(e)||El(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=Cl(),e._shouldAllowMigration=!0,e}return N(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);Sl()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=E(x().mark((function e(t,r){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(R(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=E(x().mark((function e(t){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(R(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(R(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Uf);Vf.type="LOCAL";var Bf=Vf,jf=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return N(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(Uf);jf.type="SESSION";var qf=jf;function zf(e){return Promise.all(e.map(function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var Wf=function(){function e(t){S(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return N(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=E(x().mark((function e(t){var n,r,i,a,o,u,s,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,i=r.eventId,a=r.eventType,o=r.data,null===(u=this.handlersMap[a])||void 0===u?void 0:u.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:i,eventType:a}),s=Array.from(u).map(function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,zf(s);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function Kf(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Wf.receivers=[];var Hf=function(){function e(t){S(this,e),this.target=t,this.handlers=new Set}return N(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=E(x().mark((function e(t,n){var r,i,a,o,u=this,s=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:50,i="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,s){var c=Kf("",20);i.port1.start();var l=setTimeout((function(){s(new Error("unsupported_event"))}),r);o={messageChannel:i,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),a=setTimeout((function(){s(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),e(n.data.response);break;default:clearTimeout(l),clearTimeout(a),s(new Error("invalid_response"))}}},u.handlers.add(o),i.port1.addEventListener("message",o.onMessage),u.target.postMessage({eventType:t,eventId:c,data:n},[i.port2])})).finally((function(){o&&u.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function Gf(){return window}function Qf(){return"undefined"!==typeof Gf().WorkerGlobalScope&&"function"===typeof Gf().importScripts}function Yf(){return Jf.apply(this,arguments)}function Jf(){return(Jf=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function Xf(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var $f="firebaseLocalStorageDb",Zf="firebaseLocalStorage",ed="fbase_key",td=function(){function e(t){S(this,e),this.request=t}return N(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function nd(e,t){return e.transaction([Zf],t?"readwrite":"readonly").objectStore(Zf)}function rd(){var e=indexedDB.deleteDatabase($f);return new td(e).toPromise()}function id(){var e=indexedDB.open($f,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(Zf,{keyPath:ed})}catch(r){n(r)}})),e.addEventListener("success",E(x().mark((function n(){var r;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(Zf)){n.next=12;break}return r.close(),n.next=5,rd();case 5:return n.t0=t,n.next=8,id();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function ad(e,t,n){return od.apply(this,arguments)}function od(){return od=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=nd(t,!0).put((m(i={},ed,n),m(i,"value",r),i)),e.abrupt("return",new td(a).toPromise());case 2:case"end":return e.stop()}}),e)}))),od.apply(this,arguments)}function ud(e,t){return sd.apply(this,arguments)}function sd(){return sd=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=nd(t,!1).get(n),e.next=3,new td(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}}),e)}))),sd.apply(this,arguments)}function cd(e,t){var n=nd(e,!0).delete(t);return new td(n).toPromise()}var ld=function(){function e(){S(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return N(e,[{key:"_openDb",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,id();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qf()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=E(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=Wf._getInstance(Qf()?self:null),this.receiver._subscribe("keyChanged",function(){var e=E(x().mark((function e(n,r){var i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return i=e.sent,e.abrupt("return",{keyProcessed:i.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=E(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yf();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new Hf(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&Xf()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,id();case 5:return t=e.sent,e.next=8,ad(t,Ff,"1");case 8:return e.next=10,cd(t,Ff);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=E(x().mark((function e(t,n){var r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return ad(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return ud(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=E(x().mark((function e(t){var n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return cd(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=E(x().mark((function e(){var t,n,r,i,a,o,u,s,c,l,h;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=nd(e,!1).getAll();return new td(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,i=T(t);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.fbase_key,s=o.value,r.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(s)&&(this.notifyListeners(u,s),n.push(u))}catch(f){i.e(f)}finally{i.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)h=l[c],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();ld.type="LOCAL";var hd=ld;function fd(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:start",Pc(e,t))}function dd(e){return pd.apply(this,arguments)}function pd(){return(pd=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rc(t,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vd(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=vc("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function yd(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var md=1e12,gd=function(){function e(t){S(this,e),this.auth=t,this.counter=md,this._widgets=new Map}return N(e,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new kd(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||md;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||md;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t||md,null===(n=this._widgets.get(r))||void 0===n||n.execute(),e.abrupt("return","");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),kd=function(){function e(t,n,r){var i=this;S(this,e),this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){i.execute()};var a="string"===typeof t?document.getElementById(t):t;kc(a,"argument-error",{appName:n}),this.container=a,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return N(e,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);var t=e.params,n=t.callback,r=t["expired-callback"];if(n)try{n(e.responseToken)}catch(i){}e.timerId=window.setTimeout((function(){if(e.timerId=null,e.responseToken=null,r)try{r()}catch(i){}e.isVisible&&e.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),e}();var wd=yd("rcb"),_d=new Sc(3e4,6e4),bd="https://www.google.com/recaptcha/api.js?",xd=function(){function e(){S(this,e),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Gf().grecaptcha}return N(e,[{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return kc(Id(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(Gf().grecaptcha):new Promise((function(r,i){var a=Gf().setTimeout((function(){i(vc(e,"network-request-failed"))}),_d.get());Gf()[wd]=function(){Gf().clearTimeout(a),delete Gf()[wd];var o=Gf().grecaptcha;if(o){var u=o.render;o.render=function(e,n){var r=u(e,n);return t.counter++,r},t.hostLanguage=n,r(o)}else i(vc(e,"internal-error"))},vd("".concat(bd,"?").concat(ke({onload:wd,render:"explicit",hl:n}))).catch((function(){clearTimeout(a),i(vc(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){return!!Gf().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),e}();function Id(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}var Ed=function(){function e(){S(this,e)}return N(e,[{key:"load",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new gd(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearedOneInstance",value:function(){}}]),e}(),Td="recaptcha",Sd={theme:"light",type:"image"},Cd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},Sd),r=arguments.length>2?arguments[2]:void 0;S(this,e),this.parameters=n,this.type=Td,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Pl(r),this.isInvisible="invisible"===this.parameters.size,kc("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");var i="string"===typeof t?document.getElementById(t):t;kc(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ed:new xd,this.validateStartingState()}return N(e,[{key:"verify",value:function(){var e=E(x().mark((function e(){var t,n,r,i=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertNotDestroyed(),e.next=3,this.render();case 3:if(t=e.sent,n=this.getAssertedRecaptcha(),!(r=n.getResponse(t))){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new Promise((function(e){i.tokenChangeListeners.add((function t(n){n&&(i.tokenChangeListeners.delete(t),e(n))})),i.isInvisible&&n.execute(t)})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(t){return Promise.reject(t)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){kc(!this.parameters.sitekey,this.auth,"argument-error"),kc(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),kc("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"===typeof e)e(n);else if("string"===typeof e){var r=Gf()[e];"function"===typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){kc(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var e=E(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.widgetId||(t=this.container,this.isInvisible||(n=document.createElement("div"),t.appendChild(n),t=n),this.widgetId=this.getAssertedRecaptcha().render(t,this.parameters)),e.abrupt("return",this.widgetId);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kc(Ec()&&!Qf(),this.auth,"internal-error"),e.next=3,Nd();case 3:return e.next=5,this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);case 5:return this.recaptcha=e.sent,e.next=8,dd(this.auth);case 8:kc(t=e.sent,this.auth,"internal-error"),this.parameters.sitekey=t;case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAssertedRecaptcha",value:function(){return kc(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),e}();function Nd(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}var Ad=function(){function e(t,n){S(this,e),this.verificationId=t,this.onConfirmation=n}return N(e,[{key:"confirm",value:function(e){var t=yh._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),e}();function Dd(){return(Dd=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pl(t),e.next=3,Ld(i,n,De(r));case 3:return a=e.sent,e.abrupt("return",new Ad(a,(function(e){return Hh(i,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pd(e,t,n){return Rd.apply(this,arguments)}function Rd(){return(Rd=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),e.next=3,Bh(!1,i,"phone");case 3:return e.next=5,Ld(i.auth,n,De(r));case 5:return a=e.sent,e.abrupt("return",new Ad(a,(function(e){return Qh(i,e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Od(){return(Od=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=De(t),e.next=3,Ld(i.auth,n,De(r));case 3:return a=e.sent,e.abrupt("return",new Ad(a,(function(e){return Jh(i,e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ld(e,t,n){return Md.apply(this,arguments)}function Md(){return Md=E(x().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(a=e.sent,e.prev=3,kc("string"===typeof a,t,"argument-error"),kc(r.type===Td,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(u=o.session,!("phoneNumber"in o)){e.next=17;break}return kc("enroll"===u.type,t,"internal-error"),e.next=13,Of(t,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:a}});case 13:return s=e.sent,e.abrupt("return",s.phoneSessionInfo.sessionInfo);case 17:return kc("signin"===u.type,t,"internal-error"),kc(c=(null===(i=o.multiFactorHint)||void 0===i?void 0:i.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,fd(t,{mfaPendingCredential:u.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:a}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,lh(t,{phoneNumber:o.phoneNumber,recaptchaToken:a});case 28:return h=e.sent,f=h.sessionInfo,e.abrupt("return",f);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),Md.apply(this,arguments)}function Fd(){return(Fd=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Uh(De(t),n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ud=function(){function e(t){S(this,e),this.providerId=e.PROVIDER_ID,this.auth=Pl(t)}return N(e,[{key:"verifyPhoneNumber",value:function(e,t){return Ld(this.auth,e,De(t))}}],[{key:"credential",value:function(e,t){return yh._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?yh._fromTokenResponse(n,r):null}}]),e}();function Vd(e,t){return t?xc(t):(kc(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ud.PROVIDER_ID="phone",Ud.PHONE_SIGN_IN_METHOD="phone";var Bd=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this,"custom","custom")).params=e,r}return N(n,[{key:"_getIdTokenResponse",value:function(e){return uh(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return uh(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return uh(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Fl);function jd(e){return Wh(e.auth,new Bd(e),e.bypassAuthState)}function qd(e){var t=e.auth,n=e.user;return kc(n,t,"internal-error"),qh(n,new Bd(e),e.bypassAuthState)}function zd(e){return Wd.apply(this,arguments)}function Wd(){return(Wd=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,kc(r=t.user,n,"internal-error"),e.abrupt("return",Uh(r,new Bd(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Kd=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];S(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return N(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=E(x().mark((function t(n,r){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=E(x().mark((function e(t){var n,r,i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,i=t.postBody,a=t.tenantId,o=t.error,u=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return s={auth:this.auth,requestUri:n,sessionId:r,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(u)(s);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jd;case"linkViaPopup":case"linkViaRedirect":return zd;case"reauthViaPopup":case"reauthViaRedirect":return qd;default:pc(this.auth,"internal-error")}}},{key:"resolve",value:function(e){_c(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){_c(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),Hd=new Sc(2e3,1e4);function Gd(e,t,n){return Qd.apply(this,arguments)}function Qd(){return(Qd=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pl(t),mc(t,n,kh),a=Vd(i,r),o=new $d(i,"signInViaPopup",n,a),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yd(){return(Yd=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mc((i=De(t)).auth,n,kh),a=Vd(i.auth,r),o=new $d(i.auth,"reauthViaPopup",n,a,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jd(e,t,n){return Xd.apply(this,arguments)}function Xd(){return(Xd=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mc((i=De(t)).auth,n,kh),a=Vd(i.auth,r),o=new $d(i.auth,"linkViaPopup",n,a,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $d=function(e){P(n,e);var t=M(n);function n(e,r,i,a,o){var u;return S(this,n),(u=t.call(this,e,r,a,o)).provider=i,u.authWindow=null,u.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=A(u),u}return N(n,[{key:"executeNotNull",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return kc(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=E(x().mark((function e(){var t,n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _c(1===this.filter.length,"Popup operations only handle one event"),t=Kf(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(vc(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(vc(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(vc(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,Hd.get())}()}}]),n}(Kd);$d.currentPopupAction=null;var Zd=new Map,ep=function(e){P(n,e);var t=M(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return S(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return N(n,[{key:"execute",value:function(){var e=E(x().mark((function e(){var t,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Zd.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,tp(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,Qs(R(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:Zd.set(this.auth._key(),t);case 21:return this.bypassAuthState||Zd.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=E(x().mark((function e(t){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",Qs(R(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",Qs(R(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(Kd);function tp(e,t){return np.apply(this,arguments)}function np(){return(np=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=up(n),i=op(t),e.next=4,i._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,i._get(r);case 8:return e.t0=e.sent,a="true"===e.t0,e.next=12,i._remove(r);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rp(e,t){return ip.apply(this,arguments)}function ip(){return(ip=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",op(t)._set(up(n),"true"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ap(e,t){Zd.set(e._key(),t)}function op(e){return xc(e._redirectPersistence)}function up(e){return vl("pendingRedirect",e.config.apiKey,e.name)}function sp(e,t,n){return function(e,t,n){return cp.apply(this,arguments)}(e,t,n)}function cp(){return(cp=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pl(t),mc(t,n,kh),a=Vd(i,r),e.next=5,rp(a,i);case 5:return e.abrupt("return",a._openRedirect(i,n,"signInViaRedirect"));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lp(e,t,n){return function(e,t,n){return hp.apply(this,arguments)}(e,t,n)}function hp(){return(hp=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mc((i=De(t)).auth,n,kh),a=Vd(i.auth,r),e.next=5,rp(a,i.auth);case 5:return e.next=7,gp(i);case 7:return o=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"reauthViaRedirect",o));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fp(e,t,n){return function(e,t,n){return dp.apply(this,arguments)}(e,t,n)}function dp(){return(dp=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return mc((i=De(t)).auth,n,kh),a=Vd(i.auth,r),e.next=5,Bh(!1,i,n.providerId);case 5:return e.next=7,rp(a,i.auth);case 7:return e.next=9,gp(i);case 9:return o=e.sent,e.abrupt("return",a._openRedirect(i.auth,n,"linkViaRedirect",o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pp(e,t){return vp.apply(this,arguments)}function vp(){return(vp=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pl(t)._initializationPromise;case 2:return e.abrupt("return",yp(t,n,!1));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yp(e,t){return mp.apply(this,arguments)}function mp(){return mp=E(x().mark((function e(t,n){var r,i,a,o,u,s=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=Pl(t),a=Vd(i,n),o=new ep(i,a,r),e.next=6,o.execute();case 6:if(!(u=e.sent)||r){e.next=13;break}return delete u.user._redirectEventId,e.next=11,i._persistUserIfCurrent(u.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)}))),mp.apply(this,arguments)}function gp(e){return kp.apply(this,arguments)}function kp(){return(kp=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Kf("".concat(t.uid,":::")),t._redirectEventId=n,e.next=4,t.auth._setRedirectUser(t);case 4:return e.next=6,t.auth._persistUserIfCurrent(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wp=function(){function e(t){S(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return N(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bp(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!bp(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(vc(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_p(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(_p(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function _p(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function bp(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function xp(e){return Ip.apply(this,arguments)}function Ip(){return Ip=E(x().mark((function e(t){var n,r=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Rc(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Ip.apply(this,arguments)}var Ep=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tp=/^https?/;function Sp(){return(Sp=E(x().mark((function e(t){var n,r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,xp(t);case 4:n=e.sent,r=n.authorizedDomains,i=T(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!Cp(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:pc(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])})))).apply(this,arguments)}function Cp(e){var t=Ic(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Tp.test(r))return!1;if(Ep.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var Np=new Sc(3e4,6e4);function Ap(){var e=Gf().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=u(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var Dp=null;function Pp(e){return Dp=Dp||function(e){return new Promise((function(t,n){var r,i,a;function o(){Ap(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Ap(),n(vc(e,"network-request-failed"))},timeout:Np.get()})}if(null===(i=null===(r=Gf().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=Gf().gapi)||void 0===a?void 0:a.load)){var u=yd("iframefcb");return Gf()[u]=function(){gapi.load?o():n(vc(e,"network-request-failed"))},vd("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Dp=null,e}))}(e),Dp}var Rp=new Sc(5e3,15e3),Op={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Lp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Mp(e){var t=e.config;kc(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Cc(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Et},i=Lp.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(ke(r).slice(1))}function Fp(e){return Up.apply(this,arguments)}function Up(){return Up=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pp(t);case 2:return n=e.sent,kc(r=Gf().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:Mp(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Op,dontclear:!0},(function(e){return new Promise(function(){var n=E(x().mark((function n(r,i){var a,o,u;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=function(){Gf().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=vc(t,"network-request-failed"),o=Gf().setTimeout((function(){i(a)}),Rp.get()),e.ping(u).then(u,(function(){i(a)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),Up.apply(this,arguments)}var Vp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Bp="_blank",jp="http://localhost",qp=function(){function e(t){S(this,e),this.window=t,this.associatedEvent=null}return N(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function zp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",s=Object.assign(Object.assign({},Vp),{width:r.toString(),height:i.toString(),top:a,left:o}),c=$().toLowerCase();n&&(u=wl(c)?Bp:n),gl(c)&&(t=t||jp,s.scrollbars="yes");var h=Object.entries(s).reduce((function(e,t){var n=l(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(Tl(c)&&"_self"!==u)return Wp(t||"",u),new qp(null);var f=window.open(t||"",u,h);kc(f,e,"popup-blocked");try{f.focus()}catch(d){}return new qp(f)}function Wp(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var Kp="__/auth/handler",Hp="emulator/auth/handler";function Gp(e,t,n,r,i,a){kc(e.config.authDomain,e,"auth-domain-config-required"),kc(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Et,eventId:i};if(t instanceof kh){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",ve(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var u=0,s=Object.entries(a||{});u<s.length;u++){var c=l(s[u],2),h=c[0],f=c[1];o[h]=f}}if(t instanceof wh){var d=t.getScopes().filter((function(e){return""!==e}));d.length>0&&(o.scopes=d.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var p=o,v=0,y=Object.keys(p);v<y.length;v++){var m=y[v];void 0===p[m]&&delete p[m]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Kp);return Cc(t,Hp)}(e),"?").concat(ke(p).slice(1))}var Qp="webStorageSupport",Yp=function(){function e(){S(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qf,this._completeRedirectFn=yp,this._overrideRedirectResult=ap}return N(e,[{key:"_openPopup",value:function(){var e=E(x().mark((function e(t,n,r,i){var a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _c(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()"),o=Gp(t,n,r,Ic(),i),e.abrupt("return",zp(t,o,Kf()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=E(x().mark((function e(t,n,r,i){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return a=Gp(t,n,r,Ic(),i),Gf().location.href=a,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var a}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(_c(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fp(t);case 2:return n=e.sent,r=new wp(t),n.register("authEvent",(function(e){return kc(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(Qp,{type:Qp},(function(n){var r,i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),pc(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Sp.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return Cl()||kl()||El()}}]),e}(),Jp=Yp,Xp=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this,"phone")).credential=e,r}return N(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:finalize",Pc(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:finalize",Pc(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(function(){function e(t){S(this,e),this.factorId=t}return N(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return wc("unexpected MultiFactorSessionType")}}}]),e}()),$p=function(){function e(){S(this,e)}return N(e,null,[{key:"assertion",value:function(e){return Xp._fromCredential(e)}}]),e}();$p.FACTOR_ID="phone";var Zp,ev="@firebase/auth",tv="0.20.4",nv=function(){function e(t){S(this,e),this.auth=t,this.internalListeners=new Map}return N(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){kc(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();function rv(){return window}Zp="Browser",gt(new Pe("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,u=a.authDomain;return function(e,t){kc(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),kc(!(null===u||void 0===u?void 0:u.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:u,clientPlatform:Zp,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nl(Zp)},i=new Dl(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(xc);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),gt(new Pe("auth-internal",(function(e){return function(e){return new nv(e)}(Pl(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),Dt(ev,tv,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Zp)),Dt(ev,tv,"esm2017");function iv(e,t,n){return av.apply(this,arguments)}function av(){return av=E(x().mark((function e(t,n,r){var i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=rv(),o=a.BuildInfo,_c(n.sessionId,"AuthEvent did not contain a session ID"),e.next=4,hv(n.sessionId);case 4:return u=e.sent,s={},El()?s.ibi=o.packageName:bl()?s.apn=o.packageName:pc(t,"operation-not-supported-in-this-environment"),o.displayName&&(s.appDisplayName=o.displayName),s.sessionId=u,e.abrupt("return",Gp(t,r,n.type,void 0,null!==(i=n.eventId)&&void 0!==i?i:void 0,s));case 10:case"end":return e.stop()}}),e)}))),av.apply(this,arguments)}function ov(){return(ov=E(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=rv(),r=n.BuildInfo,i={},El()?i.iosBundleId=r.packageName:bl()?i.androidPackageName=r.packageName:pc(t,"operation-not-supported-in-this-environment"),e.next=5,xp(t,i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uv(e){var t=rv().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}function sv(e,t,n){return cv.apply(this,arguments)}function cv(){return cv=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=rv(),a=i.cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,i){var u=null;function s(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"===typeof n&&n(),"function"===typeof(null===r||void 0===r?void 0:r.close)&&r.close()}function c(){u||(u=window.setTimeout((function(){i(vc(t,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}n.addPassiveListener(s),document.addEventListener("resume",c,!1),bl()&&document.addEventListener("visibilitychange",l,!1),o=function(){n.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),u&&window.clearTimeout(u)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[2,,5,8]])}))),cv.apply(this,arguments)}function lv(e){var t,n,r,i,a,o,u,s,c,l,h=rv();kc("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),kc("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),kc("function"===typeof(null===(a=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),kc("function"===typeof(null===(s=null===(u=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),kc("function"===typeof(null===(l=null===(c=null===h||void 0===h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function hv(e){return fv.apply(this,arguments)}function fv(){return(fv=E(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=dv(t),e.next=3,crypto.subtle.digest("SHA-256",n);case 3:return r=e.sent,i=Array.from(new Uint8Array(r)),e.abrupt("return",i.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dv(e){if(_c(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}var pv=function(e){P(n,e);var t=M(n);function n(){var e;return S(this,n),(e=t.apply(this,arguments)).passiveListeners=new Set,e.initPromise=new Promise((function(t){e.resolveInialized=t})),e}return N(n,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(e){return this.resolveInialized(),this.passiveListeners.forEach((function(t){return t(e)})),Qs(R(n.prototype),"onEvent",this).call(this,e)}},{key:"initialized",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPromise;case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(wp);function vv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,eventId:n,urlResponse:null,sessionId:wv(),postBody:null,tenantId:e.tenantId,error:vc(e,"no-auth-event")}}function yv(e,t){return _v()._set(bv(e),t)}function mv(e){return gv.apply(this,arguments)}function gv(){return(gv=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_v()._get(bv(t));case 2:if(!(n=e.sent)){e.next=6;break}return e.next=6,_v()._remove(bv(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kv(e,t){var n,r,i=function(e){var t=xv(e),n=t.link?decodeURIComponent(t.link):void 0,r=xv(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return xv(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=xv(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null===o||void 0===o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?vc(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function wv(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<20;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function _v(){return xc(Bf)}function bv(e){return vl("authEvent",e.config.apiKey,e.name)}function xv(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};var t,n=e.split("?"),r=s(t=n)||a(t)||o(t)||c();r[0];return we(r.slice(1).join("?"))}var Iv=function(){function e(){S(this,e),this._redirectPersistence=qf,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=yp,this._overrideRedirectResult=ap}return N(e,[{key:"_initialize",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._key(),(r=this.eventManagers.get(n))||(r=new pv(t),this.eventManagers.set(n,r),this.attachCallbackListeners(t,r)),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(e){pc(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(){var e=E(x().mark((function e(t,n,r,i){var a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lv(t),e.next=3,this._initialize(t);case 3:return a=e.sent,e.next=6,a.initialized();case 6:return a.resetRedirect(),Zd.clear(),e.next=10,this._originValidation(t);case 10:return o=vv(t,r,i),e.next=13,yv(t,o);case 13:return e.next=15,iv(t,o,n);case 15:return u=e.sent,e.next=18,uv(u);case 18:return s=e.sent,e.abrupt("return",sv(t,a,s));case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return ov.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(e,t){var n=rv(),r=n.universalLinks,i=n.handleOpenURL,a=n.BuildInfo,o=setTimeout(E(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,mv(e);case 2:t.onEvent(Tv());case 3:case"end":return n.stop()}}),n)}))),500),u=function(){var n=E(x().mark((function n(r){var i,a;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return clearTimeout(o),n.next=3,mv(e);case 3:i=n.sent,a=null,i&&(null===r||void 0===r?void 0:r.url)&&(a=kv(i,r.url)),t.onEvent(a||Tv());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();"undefined"!==typeof r&&"function"===typeof r.subscribe&&r.subscribe(null,u);var s=i,c="".concat(a.packageName.toLowerCase(),"://");rv().handleOpenURL=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.toLowerCase().startsWith(c)&&u({url:t}),"function"===typeof s)try{s(t)}catch(n){console.error(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}]),e}(),Ev=Iv;function Tv(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:vc("no-auth-event")}}function Sv(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Cv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return!("file:"!==Sv()&&"ionic:"!==Sv()&&"capacitor:"!==Sv()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Nv(){return re()&&11===(null===document||void 0===document?void 0:document.documentMode)}function Av(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return/Edge\/\d+/.test(e)}function Dv(){try{var e=self.localStorage,t=Kf();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();return Nv()||Av(e)}()||ae()}catch(n){return Pv()&&ae()}return!1}function Pv(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Rv(){return("http:"===Sv()||"https:"===Sv()||te()||Cv())&&!(ne()||ee())&&Dv()&&!Pv()}function Ov(){return Cv()&&"undefined"!==typeof document}function Lv(){return Mv.apply(this,arguments)}function Mv(){return(Mv=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ov()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),1e3);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fv={LOCAL:"local",NONE:"none",SESSION:"session"},Uv=kc,Vv="persistence";function Bv(e,t){Uv(Object.values(Fv).includes(t),e,"invalid-persistence-type"),ne()?Uv(t!==Fv.SESSION,e,"unsupported-persistence-type"):ee()?Uv(t===Fv.NONE,e,"unsupported-persistence-type"):Pv()?Uv(t===Fv.NONE||t===Fv.LOCAL&&ae(),e,"unsupported-persistence-type"):Uv(t===Fv.NONE||Dv(),e,"unsupported-persistence-type")}function jv(e){return qv.apply(this,arguments)}function qv(){return(qv=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._initializationPromise;case 2:n=zv(),r=vl(Vv,t.config.apiKey,t.name),n&&n.setItem(r,t._getPersistence());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zv(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}var Wv=kc,Kv=function(){function e(){S(this,e),this.browserResolver=xc(Jp),this.cordovaResolver=xc(Ev),this.underlyingResolver=null,this._redirectPersistence=qf,this._completeRedirectFn=yp,this._overrideRedirectResult=ap}return N(e,[{key:"_initialize",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_openPopup",value:function(){var e=E(x().mark((function e(t,n,r,i){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=E(x().mark((function e(t,n,r,i){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectUnderlyingResolver();case 2:return e.abrupt("return",this.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return Ov()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return Wv(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Lv();case 4:t=e.sent,this.underlyingResolver=t?this.cordovaResolver:this.browserResolver;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Hv(e){return e.unwrap()}function Gv(e,t){var n,r,i=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===(r=t)||void 0===r?void 0:r.code))t.resolver=new $v(e,function(e,t){var n,r=De(e),i=t;return kc(t.customData.operationType,r,"argument-error"),kc(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Rf._fromError(r,i)}(e,t));else if(i){var a=Qv(t),o=t;a&&(o.credential=a,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function Qv(e){var t=(e instanceof oe?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof oe)&&"temporaryProof"in t&&"phoneNumber"in t)return Ud.credentialFromResult(e);var n,r=t.providerId;if(!r||r===ec)return null;switch(r){case Zs:n=xh;break;case Xs:n=bh;break;case $s:n=Ih;break;case tc:n=Sh;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?Eh._create(r,u):ch._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new _h(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof oe?n.credentialFromError(e):n.credentialFromResult(e)}function Yv(e,t){return t.catch((function(t){throw t instanceof oe&&Gv(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,Qv(t)),additionalUserInfo:Df(e),user:Zv.getOrCreate(r)}}))}function Jv(e,t){return Xv.apply(this,arguments)}function Xv(){return(Xv=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:return r=e.sent,e.abrupt("return",{verificationId:r.verificationId,confirm:function(e){return Yv(t,r.confirm(e))}});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $v=function(){function e(t,n){S(this,e),this.resolver=n,this.auth=t.wrapped()}return N(e,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return Yv(Hv(this.auth),this.resolver.resolveSignIn(e))}}]),e}(),Zv=function(){function e(t){S(this,e),this._delegate=t,this.multiFactor=function(e){var t=De(e);return Mf.has(t)||Mf.set(t,Lf._fromUser(t)),Mf.get(t)}(t)}return N(e,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yv(this.auth,Qh(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithPhoneNumber",value:function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Jv(this.auth,Pd(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"linkWithPopup",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yv(this.auth,Jd(this._delegate,t,Kv)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkWithRedirect",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jv(Pl(this.auth));case 2:return e.abrupt("return",fp(this._delegate,t,Kv));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yv(this.auth,Jh(this._delegate,t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return Jv(this.auth,function(e,t,n){return Od.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return Yv(this.auth,function(e,t,n){return Yd.apply(this,arguments)}(this._delegate,e,Kv))}},{key:"reauthenticateWithRedirect",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jv(Pl(this.auth));case 2:return e.abrupt("return",lp(this._delegate,t,Kv));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmailVerification",value:function(e){return function(e,t){return gf.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mh(this._delegate,t);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEmail",value:function(e){return function(e,t){return xf(De(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return xf(De(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return Fd.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return bf.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return kf.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(t){return e.USER_MAP.has(t)||e.USER_MAP.set(t,new e(t)),e.USER_MAP.get(t)}}]),e}();Zv.USER_MAP=new WeakMap;var ey=kc,ty=function(){function e(t,n){if(S(this,e),this.app=t,n.isInitialized())return this._delegate=n.getImmediate(),void this.linkUnderlyingAuth();var r=t.options.apiKey;ey(r,"invalid-api-key",{appName:t.name}),ey(r,"invalid-api-key",{appName:t.name});var i="undefined"!==typeof window?Kv:void 0;this._delegate=n.initialize({options:{persistence:ry(r,t.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(cc),this.linkUnderlyingAuth()}return N(e,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?Zv.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){Ol(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return uf.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return sf(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return of.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Yv(this._delegate,hf(this._delegate,t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return mf.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=mh.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ey(Rv(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,pp(this._delegate,Kv);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",Yv(this._delegate,Promise.resolve(t)));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addFrameworkForLogging",value:function(e){!function(e,t){Pl(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=ny(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=ny(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return df.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return af.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(){var e=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bv(this._delegate,t),e.t0=t,e.next=e.t0===Fv.SESSION?4:e.t0===Fv.LOCAL?6:e.t0===Fv.NONE?11:13;break;case 4:return n=qf,e.abrupt("break",14);case 6:return e.next=8,xc(hd)._isAvailable();case 8:return r=e.sent,n=r?hd:Bf,e.abrupt("break",14);case 11:return n=pl,e.abrupt("break",14);case 13:return e.abrupt("return",pc("argument-error",{appName:this._delegate.name}));case 14:return e.abrupt("return",this._delegate.setPersistence(n));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return Yv(this._delegate,function(e){return Ph.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return Yv(this._delegate,Hh(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return Yv(this._delegate,function(e,t){return ef.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return Yv(this._delegate,function(e,t,n){return Hh(De(e),gh.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return Yv(this._delegate,function(e,t,n){return pf.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return Jv(this._delegate,function(e,t,n){return Dd.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ey(Rv(),this._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",Yv(this._delegate,Gd(this._delegate,t,Kv)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signInWithRedirect",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ey(Rv(),this._delegate,"operation-not-supported-in-this-environment"),e.next=3,jv(this._delegate);case 3:return e.abrupt("return",sp(this._delegate,t,Kv));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return lf.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),e}();function ny(e,t,n){var r=e;"function"!==typeof e&&(r=e.next,t=e.error,n=e.complete);var i=r;return{next:function(e){return i(e&&Zv.getOrCreate(e))},error:t,complete:n}}function ry(e,t){var n=function(e,t){var n=zv();if(!n)return[];var r=vl(Vv,e,t);switch(n.getItem(r)){case Fv.NONE:return[pl];case Fv.LOCAL:return[hd,qf];case Fv.SESSION:return[qf];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(hd)||n.push(hd),"undefined"!==typeof window)for(var r=0,i=[Bf,qf];r<i.length;r++){var a=i[r];n.includes(a)||n.push(a)}return n.includes(pl)||n.push(pl),n}ty.Persistence=Fv;var iy=function(){function e(){S(this,e),this.providerId="phone",this._delegate=new Ud(Hv(Hs.auth()))}return N(e,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return Ud.credential(e,t)}}]),e}();iy.PHONE_SIGN_IN_METHOD=Ud.PHONE_SIGN_IN_METHOD,iy.PROVIDER_ID=Ud.PROVIDER_ID;var ay,oy=kc,uy=function(){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hs.app();S(this,e),oy(null===(r=i.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new Cd(t,n,i.auth()),this.type=this._delegate.type}return N(e,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),e}();(ay=Hs).INTERNAL.registerComponent(new Pe("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new ty(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:nc,PASSWORD_RESET:rc,RECOVER_EMAIL:ic,REVERT_SECOND_FACTOR_ADDITION:ac,VERIFY_AND_CHANGE_EMAIL:oc,VERIFY_EMAIL:uc}},EmailAuthProvider:gh,FacebookAuthProvider:bh,GithubAuthProvider:Ih,GoogleAuthProvider:xh,OAuthProvider:_h,SAMLAuthProvider:Th,PhoneAuthProvider:iy,PhoneMultiFactorGenerator:$p,RecaptchaVerifier:uy,TwitterAuthProvider:Sh,Auth:ty,AuthCredential:Fl,Error:oe}).setInstantiationMode("LAZY").setMultipleInstances(!1)),ay.registerVersion("@firebase/auth-compat","0.2.17");var sy,cy="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},ly={},hy=hy||{},fy=cy||self;function dy(){}function py(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function vy(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var yy="closure_uid_"+(1e9*Math.random()>>>0),my=0;function gy(e,t,n){return e.call.apply(e.bind,arguments)}function ky(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function wy(e,t,n){return(wy=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?gy:ky).apply(null,arguments)}function _y(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function by(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function xy(){this.s=this.s,this.o=this.o}var Iy={};xy.prototype.s=!1,xy.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,yy)&&e[yy]||(e[yy]=++my)}(this);delete Iy[e]}},xy.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ey=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Ty=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"===typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function Sy(e){return Array.prototype.concat.apply([],arguments)}function Cy(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Ny(e){return/^[\s\xa0]*$/.test(e)}var Ay,Dy=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Py(e,t){return-1!=e.indexOf(t)}function Ry(e,t){return e<t?-1:e>t?1:0}e:{var Oy=fy.navigator;if(Oy){var Ly=Oy.userAgent;if(Ly){Ay=Ly;break e}}Ay=""}function My(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Fy(e){var t={};for(var n in e)t[n]=e[n];return t}var Uy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Vy(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Uy.length;a++)n=Uy[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function By(e){return By[" "](e),e}By[" "]=dy;var jy,qy=Py(Ay,"Opera"),zy=Py(Ay,"Trident")||Py(Ay,"MSIE"),Wy=Py(Ay,"Edge"),Ky=Wy||zy,Hy=Py(Ay,"Gecko")&&!(Py(Ay.toLowerCase(),"webkit")&&!Py(Ay,"Edge"))&&!(Py(Ay,"Trident")||Py(Ay,"MSIE"))&&!Py(Ay,"Edge"),Gy=Py(Ay.toLowerCase(),"webkit")&&!Py(Ay,"Edge");function Qy(){var e=fy.document;return e?e.documentMode:void 0}e:{var Yy="",Jy=function(){var e=Ay;return Hy?/rv:([^\);]+)(\)|;)/.exec(e):Wy?/Edge\/([\d\.]+)/.exec(e):zy?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Gy?/WebKit\/(\S+)/.exec(e):qy?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Jy&&(Yy=Jy?Jy[1]:""),zy){var Xy=Qy();if(null!=Xy&&Xy>parseFloat(Yy)){jy=String(Xy);break e}}jy=Yy}var $y,Zy={};function em(){return function(e){var t=Zy;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Dy(String(jy)).split("."),n=Dy("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=Ry(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||Ry(0==a[2].length,0==o[2].length)||Ry(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(fy.document&&zy){var tm=Qy();$y=tm||(parseInt(jy,10)||void 0)}else $y=void 0;var nm=$y,rm=function(){if(!fy.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{fy.addEventListener("test",dy,t),fy.removeEventListener("test",dy,t)}catch(n){}return e}();function im(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function am(e,t){if(im.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Hy){e:{try{By(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:om[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&am.Z.h.call(this)}}im.prototype.h=function(){this.defaultPrevented=!0},by(am,im);var om={2:"touch",3:"pen",4:"mouse"};am.prototype.h=function(){am.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var um="closure_listenable_"+(1e6*Math.random()|0),sm=0;function cm(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++sm,this.ca=this.fa=!1}function lm(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function hm(e){this.src=e,this.g={},this.h=0}function fm(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Ey(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(lm(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function dm(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}hm.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=dm(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new cm(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var pm="closure_lm_"+(1e6*Math.random()|0),vm={};function ym(e,t,n,r,i){if(r&&r.once)return gm(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)ym(e,t[a],n,r,i);return null}return n=Em(n),e&&e[um]?e.N(t,n,vy(r)?!!r.capture:!!r,i):mm(e,t,n,!1,r,i)}function mm(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=vy(i)?!!i.capture:!!i,u=xm(e);if(u||(e[pm]=u=new hm(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=bm;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)rm||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(_m(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function gm(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)gm(e,t[a],n,r,i);return null}return n=Em(n),e&&e[um]?e.O(t,n,vy(r)?!!r.capture:!!r,i):mm(e,t,n,!0,r,i)}function km(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)km(e,t[a],n,r,i);else r=vy(r)?!!r.capture:!!r,n=Em(n),e&&e[um]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=dm(a=e.g[t],n,r,i))&&(lm(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=xm(e))&&(t=e.g[t.toString()],e=-1,t&&(e=dm(t,n,r,i)),(n=-1<e?t[e]:null)&&wm(n))}function wm(e){if("number"!==typeof e&&e&&!e.ca){var t=e.src;if(t&&t[um])fm(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(_m(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=xm(t))?(fm(n,e),0==n.h&&(n.src=null,t[pm]=null)):lm(e)}}}function _m(e){return e in vm?vm[e]:vm[e]="on"+e}function bm(e,t){if(e.ca)e=!0;else{t=new am(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&wm(e),e=n.call(r,t)}return e}function xm(e){return(e=e[pm])instanceof hm?e:null}var Im="__closure_events_fn_"+(1e9*Math.random()>>>0);function Em(e){return"function"===typeof e?e:(e[Im]||(e[Im]=function(t){return e.handleEvent(t)}),e[Im])}function Tm(){xy.call(this),this.i=new hm(this),this.P=this,this.I=null}function Sm(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new im(t,e);else if(t instanceof im)t.target=t.target||e;else{var i=t;Vy(t=new im(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Cm(o,r,!0,t)&&i}if(i=Cm(o=t.g=e,r,!0,t)&&i,i=Cm(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Cm(o=t.g=n[a],r,!1,t)&&i}function Cm(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var u=o.listener,s=o.ia||o.src;o.fa&&fm(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}by(Tm,xy),Tm.prototype[um]=!0,Tm.prototype.removeEventListener=function(e,t,n,r){km(this,e,t,n,r)},Tm.prototype.M=function(){if(Tm.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)lm(n[r]);delete t.g[e],t.h--}}this.I=null},Tm.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Tm.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Nm=fy.JSON.stringify;function Am(){var e=Um,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Dm,Pm=function(){function e(){S(this,e),this.h=this.g=null}return N(e,[{key:"add",value:function(e,t){var n=Rm.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Rm=new(function(){function e(t,n){S(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return N(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new Om}),(function(e){return e.reset()})),Om=function(){function e(){S(this,e),this.next=this.g=this.h=null}return N(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Lm(e){fy.setTimeout((function(){throw e}),0)}function Mm(e,t){Dm||function(){var e=fy.Promise.resolve(void 0);Dm=function(){e.then(Vm)}}(),Fm||(Dm(),Fm=!0),Um.add(e,t)}var Fm=!1,Um=new Pm;function Vm(){for(var e;e=Am();){try{e.h.call(e.g)}catch(n){Lm(n)}var t=Rm;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fm=!1}function Bm(e,t){Tm.call(this),this.h=e||1,this.g=t||fy,this.j=wy(this.kb,this),this.l=Date.now()}function jm(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function qm(e,t,n){if("function"===typeof e)n&&(e=wy(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=wy(e.handleEvent,e)}return 2147483647<Number(t)?-1:fy.setTimeout(e,t||0)}function zm(e){e.g=qm((function(){e.g=null,e.i&&(e.i=!1,zm(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}by(Bm,Tm),(sy=Bm.prototype).da=!1,sy.S=null,sy.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Sm(this,"tick"),this.da&&(jm(this),this.start()))}},sy.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},sy.M=function(){Bm.Z.M.call(this),jm(this),delete this.g};var Wm=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return N(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:zm(this)}},{key:"M",value:function(){Qs(R(n.prototype),"M",this).call(this),this.g&&(fy.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(xy);function Km(e){xy.call(this),this.h=e,this.g={}}by(Km,xy);var Hm=[];function Gm(e,t,n,r){Array.isArray(n)||(n&&(Hm[0]=n.toString()),n=Hm);for(var i=0;i<n.length;i++){var a=ym(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function Qm(e){My(e.g,(function(e,t){this.g.hasOwnProperty(t)&&wm(e)}),e),e.g={}}function Ym(){this.g=!0}function Jm(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Nm(n)}catch(u){return t}}(e,n)+(r?" "+r:"")}))}Km.prototype.M=function(){Km.Z.M.call(this),Qm(this)},Km.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ym.prototype.Aa=function(){this.g=!1},Ym.prototype.info=function(){};var Xm={},$m=null;function Zm(){return $m=$m||new Tm}function eg(e){im.call(this,Xm.Ma,e)}function tg(e){var t=Zm();Sm(t,new eg(t,e))}function ng(e,t){im.call(this,Xm.STAT_EVENT,e),this.stat=t}function rg(e){var t=Zm();Sm(t,new ng(t,e))}function ig(e,t){im.call(this,Xm.Na,e),this.size=t}function ag(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return fy.setTimeout((function(){e()}),t)}Xm.Ma="serverreachability",by(eg,im),Xm.STAT_EVENT="statevent",by(ng,im),Xm.Na="timingevent",by(ig,im);var og={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ug={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function sg(){}function cg(e){return e.h||(e.h=e.i())}function lg(){}sg.prototype.h=null;var hg,fg={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function dg(){im.call(this,"d")}function pg(){im.call(this,"c")}function vg(){}function yg(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Km(this),this.P=gg,e=Ky?125:void 0,this.W=new Bm(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new mg}function mg(){this.i=null,this.g="",this.h=!1}by(dg,im),by(pg,im),by(vg,sg),vg.prototype.g=function(){return new XMLHttpRequest},vg.prototype.i=function(){return{}},hg=new vg;var gg=45e3,kg={},wg={};function _g(e,t,n){e.K=1,e.v=Wg(Ug(t)),e.s=n,e.U=!0,bg(e,null)}function bg(e,t){e.F=Date.now(),Tg(e),e.A=Ug(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),rk(n.h,"t",r),e.C=0,n=e.l.H,e.h=new mg,e.g=aw(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Wm(wy(e.Ia,e,e.g),e.O)),Gm(e.V,e.g,"readystatechange",e.gb),t=e.H?Fy(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),tg(1),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function xg(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function Ig(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=Eg(e,n))==wg){4==t&&(e.o=4,rg(14),i=!1),Jm(e.j,e.m,null,"[Incomplete Response]");break}if(r==kg){e.o=4,rg(15),Jm(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Jm(e.j,e.m,r,null),Dg(e,r)}xg(e)&&r!=wg&&r!=kg&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,rg(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xk(t),t.L=!0,rg(11))):(Jm(e.j,e.m,n,"[Invalid Chunked Response]"),Ag(e),Ng(e))}function Eg(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?wg:(n=Number(t.substring(n,r)),isNaN(n)?kg:(r+=1)+n>t.length?wg:(t=t.substr(r,n),e.C=r+n,t))}function Tg(e){e.Y=Date.now()+e.P,Sg(e,e.P)}function Sg(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ag(wy(e.eb,e),t)}function Cg(e){e.B&&(fy.clearTimeout(e.B),e.B=null)}function Ng(e){0==e.l.G||e.I||ew(e.l,e)}function Ag(e){Cg(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,jm(e.W),Qm(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Dg(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||hk(n.i,e)))if(n.I=e.N,!e.J&&hk(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zk(n),qk(n)}Jk(n),rg(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=ag(wy(n.ab,n),6e3));if(1>=lk(n.i)&&n.ka){try{n.ka()}catch(a){}n.ka=void 0}}else nw(n,11)}else if((e.J||n.g==e)&&Zk(n),!Ny(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var u=a[4];null!=u&&(n.za=u,n.h.info("SVER="+n.za));var s=a[5];null!=s&&"number"===typeof s&&0<s&&(r=1.5*s,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(Py(l,"spdy")||Py(l,"quic")||Py(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(fk(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,zg(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=iw(r,r.H?r.la:null,r.W),d.J){dk(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(Cg(p),Tg(p)),r.g=d}else Yk(r);0<n.l.length&&Kk(n)}else"stop"!=a[0]&&"close"!=a[0]||nw(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?nw(n,7):jk(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}tg(4)}catch(a){}}function Pg(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(py(e)||"string"===typeof e)Ty(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(py(e)||"string"===typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"===typeof e)return e.split("");if(py(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function Rg(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Rg)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Og(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Lg(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)Lg(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function Lg(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(sy=yg.prototype).setTimeout=function(e){this.P=e},sy.gb=function(e){e=e.target;var t=this.L;t&&3==Mk(e)?t.l():this.Ia(e)},sy.Ia=function(e){try{if(e==this.g)e:{var t=Mk(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||Ky||this.g&&(this.h.h||this.g.ga()||Fk(this.g)))){this.I||4!=t||7==n||tg(8==n||0>=r?3:2),Cg(this);var i=this.g.ba();this.N=i;t:if(xg(this)){var a=Fk(this.g);e="";var o=a.length,u=4==Mk(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ag(this),Ng(this);var s="";break t}this.h.i=new fy.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:u&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ny(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,rg(12),Ag(this),Ng(this);break e}Jm(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Dg(this,i)}this.U?(Ig(this,t,s),Ky&&this.i&&3==t&&(Gm(this.V,this.W,"tick",this.fb),this.W.start())):(Jm(this.j,this.m,s,null),Dg(this,s)),4==t&&Ag(this),this.i&&!this.I&&(4==t?ew(this.l,this):(this.i=!1,Tg(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.o=3,rg(12)):(this.o=0,rg(13)),Ag(this),Ng(this)}}}catch(t){}},sy.fb=function(){if(this.g){var e=Mk(this.g),t=this.g.ga();this.C<t.length&&(Cg(this),Ig(this,e,t),this.i&&4!=e&&Tg(this))}},sy.cancel=function(){this.I=!0,Ag(this)},sy.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(tg(3),rg(17)),Ag(this),this.o=2,Ng(this)):Sg(this,this.Y-e)},(sy=Rg.prototype).R=function(){Og(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},sy.T=function(){return Og(this),this.g.concat()},sy.get=function(e,t){return Lg(this.h,e)?this.h[e]:t},sy.set=function(e,t){Lg(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},sy.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var Mg=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fg(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Fg){this.g=void 0!==t?t:e.g,Vg(this,e.j),this.s=e.s,Bg(this,e.i),jg(this,e.m),this.l=e.l,t=e.h;var n=new Zg;n.i=t.i,t.g&&(n.g=new Rg(t.g),n.h=t.h),qg(this,n),this.o=e.o}else e&&(n=String(e).match(Mg))?(this.g=!!t,Vg(this,n[1]||"",!0),this.s=Kg(n[2]||""),Bg(this,n[3]||"",!0),jg(this,n[4]),this.l=Kg(n[5]||"",!0),qg(this,n[6]||"",!0),this.o=Kg(n[7]||"")):(this.g=!!t,this.h=new Zg(null,this.g))}function Ug(e){return new Fg(e)}function Vg(e,t,n){e.j=n?Kg(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Bg(e,t,n){e.i=n?Kg(t,!0):t}function jg(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function qg(e,t,n){t instanceof Zg?(e.h=t,function(e,t){t&&!e.j&&(ek(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(tk(this,t),rk(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Hg(t,Xg)),e.h=new Zg(t,e.g))}function zg(e,t,n){e.h.set(t,n)}function Wg(e){return zg(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Kg(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Hg(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Gg),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Gg(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Fg.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Hg(t,Qg,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Hg(t,Qg,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Hg(n,"/"==n.charAt(0)?Jg:Yg,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Hg(n,$g)),e.join("")};var Qg=/[#\/\?@]/g,Yg=/[#\?:]/g,Jg=/[#\?]/g,Xg=/[#\?@]/g,$g=/#/g;function Zg(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ek(e){e.g||(e.g=new Rg,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function tk(e,t){ek(e),t=ik(e,t),Lg(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,Lg((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Og(e)))}function nk(e,t){return ek(e),t=ik(e,t),Lg(e.g.h,t)}function rk(e,t,n){tk(e,t),0<n.length&&(e.i=null,e.g.set(ik(e,t),Cy(n)),e.h+=n.length)}function ik(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(sy=Zg.prototype).add=function(e,t){ek(this),this.i=null,e=ik(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},sy.forEach=function(e,t){ek(this),this.g.forEach((function(n,r){Ty(n,(function(n){e.call(t,n,r,this)}),this)}),this)},sy.T=function(){ek(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},sy.R=function(e){ek(this);var t=[];if("string"===typeof e)nk(this,e)&&(t=Sy(t,this.g.get(ik(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Sy(t,e[n])}return t},sy.set=function(e,t){return ek(this),this.i=null,nk(this,e=ik(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},sy.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},sy.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var ak=N((function e(t,n){S(this,e),this.h=t,this.g=n}));function ok(e){this.l=e||sk,fy.PerformanceNavigationTiming?e=0<(e=fy.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(fy.g&&fy.g.Ea&&fy.g.Ea()&&fy.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var uk,sk=10;function ck(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lk(e){return e.h?1:e.g?e.g.size:0}function hk(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function fk(e,t){e.g?e.g.add(t):e.h=t}function dk(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pk(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=T(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return Cy(e.i)}function vk(){}function yk(){this.g=new vk}function mk(e,t,n){var r=n||"";try{Pg(e,(function(e,n){var i=e;vy(e)&&(i=Nm(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function gk(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function kk(e){this.l=e.$b||null,this.j=e.ib||!1}function wk(e,t){Tm.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=_k,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ok.prototype.cancel=function(){if(this.i=pk(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=T(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},vk.prototype.stringify=function(e){return fy.JSON.stringify(e,void 0)},vk.prototype.parse=function(e){return fy.JSON.parse(e,void 0)},by(kk,sg),kk.prototype.g=function(){return new wk(this.l,this.j)},kk.prototype.i=(uk={},function(){return uk}),by(wk,Tm);var _k=0;function bk(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function xk(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Ik(e)}function Ik(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(sy=wk.prototype).open=function(e,t){if(this.readyState!=_k)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Ik(this)},sy.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||fy).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},sy.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xk(this)),this.readyState=_k},sy.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ik(this)),this.g&&(this.readyState=3,Ik(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof fy.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bk(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},sy.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?xk(this):Ik(this),3==this.readyState&&bk(this)}},sy.Ua=function(e){this.g&&(this.response=this.responseText=e,xk(this))},sy.Ta=function(e){this.g&&(this.response=e,xk(this))},sy.ha=function(){this.g&&xk(this)},sy.setRequestHeader=function(e,t){this.v.append(e,t)},sy.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},sy.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(wk.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Ek=fy.JSON.parse;function Tk(e){Tm.call(this),this.headers=new Rg,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Sk,this.K=this.L=!1}by(Tk,Tm);var Sk="",Ck=/^https?$/i,Nk=["POST","PUT"];function Ak(e){return"content-type"==e.toLowerCase()}function Dk(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Pk(e),Ok(e)}function Pk(e){e.D||(e.D=!0,Sm(e,"complete"),Sm(e,"error"))}function Rk(e){if(e.h&&"undefined"!=typeof hy&&(!e.C[1]||4!=Mk(e)||2!=e.ba()))if(e.v&&4==Mk(e))qm(e.Fa,0,e);else if(Sm(e,"readystatechange"),4==Mk(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(Mg)[1]||null;if(!a&&fy.self&&fy.self.location){var o=fy.self.location.protocol;a=o.substr(0,o.length-1)}i=!Ck.test(a?a.toLowerCase():"")}t=i}if(t)Sm(e,"complete"),Sm(e,"success");else{e.m=6;try{var u=2<Mk(e)?e.g.statusText:""}catch(s){u=""}e.j=u+" ["+e.ba()+"]",Pk(e)}}finally{Ok(e)}}}function Ok(e,t){if(e.g){Lk(e);var n=e.g,r=e.C[0]?dy:null;e.g=null,e.C=null,t||Sm(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Lk(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(fy.clearTimeout(e.A),e.A=null)}function Mk(e){return e.g?e.g.readyState:0}function Fk(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Sk:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Uk(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return My(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):zg(e,t,n))}function Vk(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Bk(e){this.za=0,this.l=[],this.h=new Ym,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Vk("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Vk("baseRetryDelayMs",5e3,e),this.$a=Vk("retryDelaySeedMs",1e4,e),this.Ya=Vk("forwardChannelMaxRetries",2,e),this.ra=Vk("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new ok(e&&e.concurrentRequestLimit),this.Ca=new yk,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function jk(e){if(zk(e),3==e.G){var t=e.V++,n=Ug(e.F);zg(n,"SID",e.J),zg(n,"RID",t),zg(n,"TYPE","terminate"),Gk(e,n),(t=new yg(e,e.h,t,void 0)).K=2,t.v=Wg(Ug(n)),n=!1,fy.navigator&&fy.navigator.sendBeacon&&(n=fy.navigator.sendBeacon(t.v.toString(),"")),!n&&fy.Image&&((new Image).src=t.v,n=!0),n||(t.g=aw(t.l,null),t.g.ea(t.v)),t.F=Date.now(),Tg(t)}rw(e)}function qk(e){e.g&&(Xk(e),e.g.cancel(),e.g=null)}function zk(e){qk(e),e.u&&(fy.clearTimeout(e.u),e.u=null),Zk(e),e.i.cancel(),e.m&&("number"===typeof e.m&&fy.clearTimeout(e.m),e.m=null)}function Wk(e,t){e.l.push(new ak(e.Za++,t)),3==e.G&&Kk(e)}function Kk(e){ck(e.i)||e.m||(e.m=!0,Mm(e.Ha,e),e.C=0)}function Hk(e,t){var n;n=t?t.m:e.V++;var r=Ug(e.F);zg(r,"SID",e.J),zg(r,"RID",n),zg(r,"AID",e.U),Gk(e,r),e.o&&e.s&&Uk(r,e.o,e.s),n=new yg(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Qk(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),fk(e.i,n),_g(n,r,t)}function Gk(e,t){e.j&&Pg({},(function(e,n){zg(t,n,e)}))}function Qk(e,t,n){n=Math.min(e.l.length,n);var r=e.j?wy(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{mk(l,o,"req"+c+"_")}catch(Rw){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Yk(e){e.g||e.u||(e.Y=1,Mm(e.Ga,e),e.A=0)}function Jk(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=ag(wy(e.Ga,e),tw(e,e.A)),e.A++,!0)}function Xk(e){null!=e.B&&(fy.clearTimeout(e.B),e.B=null)}function $k(e){e.g=new yg(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Ug(e.oa);zg(t,"RID","rpc"),zg(t,"SID",e.J),zg(t,"CI",e.N?"0":"1"),zg(t,"AID",e.U),Gk(e,t),zg(t,"TYPE","xmlhttp"),e.o&&e.s&&Uk(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Wg(Ug(t)),n.s=null,n.U=!0,bg(n,e)}function Zk(e){null!=e.v&&(fy.clearTimeout(e.v),e.v=null)}function ew(e,t){var n=null;if(e.g==t){Zk(e),Xk(e),e.g=null;var r=2}else{if(!hk(e.i,t))return;n=t.D,dk(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Sm(r=Zm(),new ig(r,n,t,i)),Kk(e)}else Yk(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(lk(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.l=t.D.concat(e.l),!0):!(1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya))&&(e.m=ag(wy(e.Ha,e,t),tw(e,e.C)),e.C++,!0))}(e,t)||2==r&&Jk(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:nw(e,5);break;case 4:nw(e,10);break;case 3:nw(e,6);break;default:nw(e,2)}}function tw(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function nw(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=wy(e.jb,e);n||(n=new Fg("//www.google.com/images/cleardot.gif"),fy.location&&"http"==fy.location.protocol||Vg(n,"https"),Wg(n)),function(e,t){var n=new Ym;if(fy.Image){var r=new Image;r.onload=_y(gk,n,r,"TestLoadImage: loaded",!0,t),r.onerror=_y(gk,n,r,"TestLoadImage: error",!1,t),r.onabort=_y(gk,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=_y(gk,n,r,"TestLoadImage: timeout",!1,t),fy.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else rg(2);e.G=0,e.j&&e.j.va(t),rw(e),zk(e)}function rw(e){e.G=0,e.I=-1,e.j&&(0==pk(e.i).length&&0==e.l.length||(e.i.i.length=0,Cy(e.l),e.l.length=0),e.j.ua())}function iw(e,t,n){var r=function(e){return e instanceof Fg?Ug(e):new Fg(e,void 0)}(n);if(""!=r.i)t&&Bg(r,t+"."+r.i),jg(r,r.m);else{var i=fy.location;r=function(e,t,n,r){var i=new Fg(null,void 0);return e&&Vg(i,e),t&&Bg(i,t),n&&jg(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&My(e.aa,(function(e,t){zg(r,t,e)})),t=e.D,n=e.sa,t&&n&&zg(r,t,n),zg(r,"VER",e.ma),Gk(e,r),r}function aw(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new Tk(new kk({ib:!0})):new Tk(e.qa)).L=e.H,t}function ow(){}function uw(){if(zy&&!(10<=Number(nm)))throw Error("Environmental error: no available transport.")}function sw(e,t){Tm.call(this),this.g=new Bk(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Ny(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Ny(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new hw(this)}function cw(e){dg.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function lw(){pg.call(this),this.status=1}function hw(e){this.g=e}(sy=Tk.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():hg.g(),this.C=this.u?cg(this.u):cg(hg),this.g.onreadystatechange=wy(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void Dk(this,a)}e=n||"";var i=new Rg(this.headers);r&&Pg(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=Ak,n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(i.T()),n=fy.FormData&&e instanceof fy.FormData,!(0<=Ey(Nk,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Lk(this),0<this.B&&((this.K=function(e){return zy&&em()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=wy(this.pa,this)):this.A=qm(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){Dk(this,a)}},sy.pa=function(){"undefined"!=typeof hy&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Sm(this,"timeout"),this.abort(8))},sy.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Sm(this,"complete"),Sm(this,"abort"),Ok(this))},sy.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ok(this,!0)),Tk.Z.M.call(this)},sy.Fa=function(){this.s||(this.F||this.v||this.l?Rk(this):this.cb())},sy.cb=function(){Rk(this)},sy.ba=function(){try{return 2<Mk(this)?this.g.status:-1}catch(uk){return-1}},sy.ga=function(){try{return this.g?this.g.responseText:""}catch(uk){return""}},sy.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ek(t)}},sy.Da=function(){return this.m},sy.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(sy=Bk.prototype).ma=8,sy.G=1,sy.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},sy.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new yg(this,this.h,e,void 0),n=this.s;if(this.P&&(n?Vy(n=Fy(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"===typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Qk(this,t,r),zg(i=Ug(this.F),"RID",e),zg(i,"CVER",22),this.D&&zg(i,"X-HTTP-Session-Id",this.D),Gk(this,i),this.o&&n&&Uk(i,this.o,n),fk(this.i,t),this.Ra&&zg(i,"TYPE","init"),this.ja?(zg(i,"$req",r),zg(i,"SID","null"),t.$=!0,_g(t,i,null)):_g(t,i,r),this.G=2}}else 3==this.G&&(e?Hk(this,e):0==this.l.length||ck(this.i)||Hk(this))},sy.Ga=function(){if(this.u=null,$k(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=ag(wy(this.bb,this),e)}},sy.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,rg(10),qk(this),$k(this))},sy.ab=function(){null!=this.v&&(this.v=null,qk(this),Jk(this),rg(19))},sy.jb=function(e){e?(this.h.info("Successfully pinged google.com"),rg(2)):(this.h.info("Failed to ping google.com"),rg(1))},(sy=ow.prototype).xa=function(){},sy.wa=function(){},sy.va=function(){},sy.ua=function(){},sy.Oa=function(){},uw.prototype.g=function(e,t){return new sw(e,t)},by(sw,Tm),sw.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Mm(wy(e.hb,e,t))),rg(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=iw(e,null,e.W),Kk(e)},sw.prototype.close=function(){jk(this.g)},sw.prototype.u=function(e){if("string"===typeof e){var t={};t.__data__=e,Wk(this.g,t)}else this.v?((t={}).__data__=Nm(e),Wk(this.g,t)):Wk(this.g,e)},sw.prototype.M=function(){this.g.j=null,delete this.j,jk(this.g),delete this.g,sw.Z.M.call(this)},by(cw,dg),by(lw,pg),by(hw,ow),hw.prototype.xa=function(){Sm(this.g,"a")},hw.prototype.wa=function(e){Sm(this.g,new cw(e))},hw.prototype.va=function(e){Sm(this.g,new lw(e))},hw.prototype.ua=function(){Sm(this.g,"b")},uw.prototype.createWebChannel=uw.prototype.g,sw.prototype.send=sw.prototype.u,sw.prototype.open=sw.prototype.m,sw.prototype.close=sw.prototype.close,og.NO_ERROR=0,og.TIMEOUT=8,og.HTTP_ERROR=6,ug.COMPLETE="complete",lg.EventType=fg,fg.OPEN="a",fg.CLOSE="b",fg.ERROR="c",fg.MESSAGE="d",Tm.prototype.listen=Tm.prototype.N,Tk.prototype.listenOnce=Tk.prototype.O,Tk.prototype.getLastError=Tk.prototype.La,Tk.prototype.getLastErrorCode=Tk.prototype.Da,Tk.prototype.getStatus=Tk.prototype.ba,Tk.prototype.getResponseJson=Tk.prototype.Qa,Tk.prototype.getResponseText=Tk.prototype.ga,Tk.prototype.send=Tk.prototype.ea;var fw=ly.createWebChannelTransport=function(){return new uw},dw=ly.getStatEventTarget=function(){return Zm()},pw=ly.ErrorCode=og,vw=ly.EventType=ug,yw=ly.Event=Xm,mw=ly.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},gw=ly.FetchXmlHttpFactory=kk,kw=ly.WebChannel=lg,ww=ly.XhrIo=Tk,_w="@firebase/firestore",bw=function(){function e(t){S(this,e),this.uid=t}return N(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();bw.UNAUTHENTICATED=new bw(null),bw.GOOGLE_CREDENTIALS=new bw("google-credentials-uid"),bw.FIRST_PARTY=new bw("first-party-uid"),bw.MOCK_USER=new bw("mock-user");var xw="9.8.4",Iw=new ze("@firebase/firestore");function Ew(){return Iw.logLevel}function Tw(e){if(Iw.logLevel<=Me.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Nw);Iw.debug.apply(Iw,["Firestore (".concat(xw,"): ").concat(e)].concat(u(i)))}}function Sw(e){if(Iw.logLevel<=Me.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Nw);Iw.error.apply(Iw,["Firestore (".concat(xw,"): ").concat(e)].concat(u(i)))}}function Cw(e){if(Iw.logLevel<=Me.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(Nw);Iw.warn.apply(Iw,["Firestore (".concat(xw,"): ").concat(e)].concat(u(i)))}}function Nw(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Aw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(xw,") INTERNAL ASSERTION FAILED: ")+e;throw Sw(t),new Error(t)}function Dw(e,t){e||Aw()}function Pw(e,t){return e}var Rw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ow=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return N(n)}(oe),Lw=N((function e(){var t=this;S(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Mw=N((function e(t,n){S(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Fw=function(){function e(){S(this,e)}return N(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(bw.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Uw=function(){function e(t){S(this,e),this.token=t,this.changeListener=null}return N(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),Vw=function(){function e(t){S(this,e),this.t=t,this.currentUser=bw.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return N(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new Lw;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new Lw,e.enqueueRetryable((function(){return i(n.currentUser)}))};var o=function(){var t=a;e.enqueueRetryable(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},u=function(e){Tw("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return u(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(Tw("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Lw)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Tw("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Dw("string"==typeof n.accessToken),new Mw(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Dw(null===e||"string"==typeof e),new bw(e)}}]),e}(),Bw=N((function e(t,n,r){S(this,e),this.type="FirstParty",this.user=bw.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)})),jw=function(){function e(t,n,r){S(this,e),this.h=t,this.l=n,this.m=r}return N(e,[{key:"getToken",value:function(){return Promise.resolve(new Bw(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(bw.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),qw=N((function e(t){S(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),zw=function(){function e(t){S(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return N(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Tw("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,Tw("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){Tw("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?i(e):Tw("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Dw("string"==typeof t.token),e.p=t.token,new qw(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Ww(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Kw=function(){function e(){S(this,e)}return N(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Ww(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Hw(e,t){return e<t?-1:e>t?1:0}function Gw(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function Qw(e){return e+"\0"}var Yw=function(){function e(t,n){if(S(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Ow(Rw.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Ow(Rw.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Ow(Rw.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ow(Rw.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return N(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Hw(this.nanoseconds,e.nanoseconds):Hw(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Jw=function(){function e(t){S(this,e),this.timestamp=t}return N(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Yw(0,0))}},{key:"max",value:function(){return new e(new Yw(253402300799,999999999))}}]),e}(),Xw=function(){function e(t,n,r){S(this,e),void 0===n?n=0:n>t.length&&Aw(),void 0===r?r=t.length-n:r>t.length-n&&Aw(),this.segments=t,this.offset=n,this.len=r}return N(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),$w=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,u(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Xw),Zw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,e_=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Zw.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new Ow(Rw.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new Ow(Rw.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new Ow(Rw.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(Xw),t_=function(){function e(t){S(this,e),this.path=t}return N(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===$w.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e($w.fromString(t))}},{key:"fromName",value:function(t){return new e($w.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e($w.emptyPath())}},{key:"comparator",value:function(e,t){return $w.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new $w(t.slice()))}}]),e}(),n_=N((function e(t,n,r,i){S(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function r_(e){return e.fields.find((function(e){return 2===e.kind}))}function i_(e){return e.fields.filter((function(e){return 2!==e.kind}))}n_.UNKNOWN_ID=-1;var a_=N((function e(t,n){S(this,e),this.fieldPath=t,this.kind=n})),o_=function(){function e(t,n){S(this,e),this.sequenceNumber=t,this.offset=n}return N(e,null,[{key:"empty",value:function(){return new e(0,c_.min())}}]),e}();function u_(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Jw.fromTimestamp(1e9===r?new Yw(n+1,0):new Yw(n,r));return new c_(i,t_.empty(),t)}function s_(e){return new c_(e.readTime,e.key,-1)}var c_=function(){function e(t,n,r){S(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return N(e,null,[{key:"min",value:function(){return new e(Jw.min(),t_.empty(),-1)}},{key:"max",value:function(){return new e(Jw.max(),t_.empty(),-1)}}]),e}();function l_(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=t_.comparator(e.documentKey,t.documentKey))?n:Hw(e.largestBatchId,t.largestBatchId)}var h_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",f_=function(){function e(){S(this,e),this.onCommittedListeners=[]}return N(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function d_(e){return p_.apply(this,arguments)}function p_(){return p_=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Rw.FAILED_PRECONDITION&&t.message===h_){e.next=2;break}throw t;case 2:Tw("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),p_.apply(this,arguments)}var v_=function(){function e(t){var n=this;S(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return N(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Aw(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=T(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var i=t.length,a=new Array(i),o=0,u=function(u){var s=u;n(t[s]).next((function(t){a[s]=t,++o===i&&e(a)}),(function(e){return r(e)}))},s=0;s<i;s++)u(s)}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function i(){!0===t()?n().next((function(){i()}),r):e()}()}))}}]),e}(),y_=function(){function e(t,n){var r=this;S(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.T=new Lw,this.transaction.oncomplete=function(){r.T.resolve()},this.transaction.onabort=function(){n.error?r.T.reject(new k_(t,n.error)):r.T.resolve()},this.transaction.onerror=function(e){var n=I_(e.target.error);r.T.reject(new k_(t,n))}}return N(e,[{key:"A",get:function(){return this.T.promise}},{key:"abort",value:function(e){e&&this.T.reject(e),this.aborted||(Tw("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"R",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new __(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new k_(n,t)}}}]),e}(),m_=function(){function e(t,n,r){S(this,e),this.name=t,this.version=n,this.P=r,12.2===e.v($())&&Sw("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return N(e,[{key:"k",value:function(){var e=E(x().mark((function e(t){var n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return Tw("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new k_(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Ow(Rw.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new Ow(Rw.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new k_(t,n))},i.onupgradeneeded=function(e){Tw("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.P.O(t,i.transaction,e.oldVersion,n.version).next((function(){Tw("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.M&&(this.db.onversionchange=function(e){return n.M(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"F",value:function(e){this.M=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=E(x().mark((function e(t,n,r,i){var a,o,u,s,c,l=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,o=0;case 2:return++o,e.prev=3,e.delegateYield(x().mark((function e(){var n,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.k(t);case 2:return l.db=e.sent,n=y_.open(l.db,t,a?"readonly":"readwrite",r),o=i(n).next((function(e){return n.R(),e})).catch((function(e){return n.abort(e),v_.reject(e)})).toPromise(),o.catch((function(){})),e.next=7,n.A;case 7:return e.t0=o,e.abrupt("return",{v:e.t0});case 9:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:if("object"!==typeof(u=e.t0)){e.next=8;break}return e.abrupt("return",u.v);case 8:e.next=15;break;case 10:if(e.prev=10,e.t1=e.catch(3),s=e.t1,c="FirebaseError"!==s.name&&o<3,Tw("SimpleDb","Transaction failed with error:",s.message,"Retrying:",c),this.close(),c){e.next=15;break}return e.abrupt("return",Promise.reject(s));case 15:e.next=2;break;case 17:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Tw("SimpleDb","Removing database:",e),b_(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"V",value:function(){if(!ae())return!1;if(e.S())return!0;var t=$(),n=e.v(t),r=0<n&&n<10,i=e.D(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"S",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.C)}},{key:"N",value:function(e,t){return e.store(t)}},{key:"v",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"D",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),g_=function(){function e(t){S(this,e),this.$=t,this.B=!1,this.L=null}return N(e,[{key:"isDone",get:function(){return this.B}},{key:"U",get:function(){return this.L}},{key:"cursor",set:function(e){this.$=e}},{key:"done",value:function(){this.B=!0}},{key:"q",value:function(e){this.L=e}},{key:"delete",value:function(){return b_(this.$.delete())}}]),e}(),k_=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,Rw.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return N(n)}(Ow);function w_(e){return"IndexedDbTransactionError"===e.name}var __=function(){function e(t){S(this,e),this.store=t}return N(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(Tw("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Tw("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),b_(n)}},{key:"add",value:function(e){return Tw("SimpleDb","ADD",this.store.name,e,e),b_(this.store.add(e))}},{key:"get",value:function(e){var t=this;return b_(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Tw("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Tw("SimpleDb","DELETE",this.store.name,e),b_(this.store.delete(e))}},{key:"count",value:function(){return Tw("SimpleDb","COUNT",this.store.name),b_(this.store.count())}},{key:"K",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.G(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new v_((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"j",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new v_((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"W",value:function(e,t){Tw("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.H=!1;var r=this.cursor(n);return this.G(r,(function(e,t,n){return n.delete()}))}},{key:"J",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.G(r,t)}},{key:"Y",value:function(e){var t=this.cursor({});return new v_((function(n,r){t.onerror=function(e){var t=I_(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"G",value:function(e,t){var n=[];return new v_((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new g_(i),o=t(i.primaryKey,i.value,a);if(o instanceof v_){var u=o.catch((function(e){return a.done(),v_.reject(e)}));n.push(u)}a.isDone?r():null===a.U?i.continue():i.continue(a.U)}else r()}})).next((function(){return v_.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function b_(e){return new v_((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=I_(e.target.error);n(t)}}))}var x_=!1;function I_(e){var t=m_.v($());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new Ow("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return x_||(x_=!0,setTimeout((function(){throw r}),0)),r}}return e}var E_=function(){function e(t,n){S(this,e),this.asyncQueue=t,this.X=n,this.task=null}return N(e,[{key:"start",value:function(){}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"Z",value:function(e){var t=this;Tw("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=Tw,e.t1="Documents written: ",e.next=6,t.X.tt();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!w_(e.t4)){e.next=17;break}Tw("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,d_(e.t4);case 19:return e.next=21,t.Z(1);case 21:case"end":return e.stop()}}),e,null,[[1,11]])}))))}}]),e}(),T_=function(){function e(t,n){S(this,e),this.localStore=t,this.persistence=n}return N(e,[{key:"tt",value:function(){var e=E(x().mark((function e(){var t,n=this,r=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.et(e,t)})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"et",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return v_.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Tw("IndexBackiller","Processing collection: ".concat(t)),n.nt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"nt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next((function(){return r.st(i,n)})).next((function(n){return Tw("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return a.size}))}))}))}},{key:"st",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=s_(t);l_(r,n)>0&&(n=r)})),new c_(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),S_=function(){function e(t,n){var r=this;S(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return N(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function C_(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function N_(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function A_(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}S_.ot=-1;var D_=function(){function e(t,n){S(this,e),this.comparator=t,this.root=n||R_.EMPTY}return N(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,R_.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,R_.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new P_(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new P_(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new P_(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new P_(this.root,e,this.comparator,!0)}}]),e}(),P_=function(){function e(t,n,r,i){S(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return N(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),R_=function(){function e(t,n,r,i,a){S(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return N(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Aw();if(this.right.isRed())throw Aw();var e=this.left.check();if(e!==this.right.check())throw Aw();return e+(this.isRed()?0:1)}}]),e}();R_.EMPTY=null,R_.RED=!0,R_.BLACK=!1,R_.EMPTY=new(function(){function e(){S(this,e),this.size=0}return N(e,[{key:"key",get:function(){throw Aw()}},{key:"value",get:function(){throw Aw()}},{key:"color",get:function(){throw Aw()}},{key:"left",get:function(){throw Aw()}},{key:"right",get:function(){throw Aw()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new R_(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var O_=function(){function e(t){S(this,e),this.comparator=t,this.data=new D_(this.comparator)}return N(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new L_(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new L_(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),L_=function(){function e(t){S(this,e),this.iter=t}return N(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function M_(e){return e.hasNext()?e.getNext():void 0}var F_=function(){function e(t){S(this,e),this.fields=t,t.sort(e_.comparator)}return N(e,[{key:"unionWith",value:function(t){var n,r=new O_(e_.comparator),i=T(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,u=T(t);try{for(u.s();!(o=u.n()).done;){var s=o.value;r=r.add(s)}}catch(c){u.e(c)}finally{u.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=T(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Gw(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}();var U_=function(e){function t(e){S(this,t),this.binaryString=e}return N(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Hw(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();U_.EMPTY_BYTE_STRING=new U_("");var V_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function B_(e){if(Dw(!!e),"string"==typeof e){var t=0,n=V_.exec(e);if(Dw(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:j_(e.seconds),nanos:j_(e.nanos)}}function j_(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function q_(e){return"string"==typeof e?U_.fromBase64String(e):U_.fromUint8Array(e)}function z_(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function W_(e){var t=e.mapValue.fields.__previous_value__;return z_(t)?W_(t):t}function K_(e){var t=B_(e.mapValue.fields.__local_write_time__.timestampValue);return new Yw(t.seconds,t.nanos)}var H_=N((function e(t,n,r,i,a,o,u,s){S(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.useFetchStreams=s})),G_=function(){function e(t,n){S(this,e),this.projectId=t,this.database=n||"(default)"}return N(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function Q_(e){return null==e}function Y_(e){return 0===e&&1/e==-1/0}function J_(e){return"number"==typeof e&&Number.isInteger(e)&&!Y_(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var X_={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},$_={nullValue:"NULL_VALUE"};function Z_(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?z_(e)?4:db(e)?9007199254740991:10:Aw()}function eb(e,t){if(e===t)return!0;var n=Z_(e);if(n!==Z_(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return K_(e).isEqual(K_(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=B_(e.timestampValue),r=B_(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return q_(e.bytesValue).isEqual(q_(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return j_(e.geoPointValue.latitude)===j_(t.geoPointValue.latitude)&&j_(e.geoPointValue.longitude)===j_(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return j_(e.integerValue)===j_(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=j_(e.doubleValue),r=j_(t.doubleValue);return n===r?Y_(n)===Y_(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Gw(e.arrayValue.values||[],t.arrayValue.values||[],eb);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(C_(n)!==C_(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!eb(n[i],r[i])))return!1;return!0}(e,t);default:return Aw()}}function tb(e,t){return void 0!==(e.values||[]).find((function(e){return eb(e,t)}))}function nb(e,t){if(e===t)return 0;var n=Z_(e),r=Z_(t);if(n!==r)return Hw(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Hw(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=j_(e.integerValue||e.doubleValue),r=j_(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return rb(e.timestampValue,t.timestampValue);case 4:return rb(K_(e),K_(t));case 5:return Hw(e.stringValue,t.stringValue);case 6:return function(e,t){var n=q_(e),r=q_(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Hw(n[i],r[i]);if(0!==a)return a}return Hw(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Hw(j_(e.latitude),j_(t.latitude));return 0!==n?n:Hw(j_(e.longitude),j_(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=nb(n[i],r[i]);if(a)return a}return Hw(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===X_.mapValue&&t===X_.mapValue)return 0;if(e===X_.mapValue)return 1;if(t===X_.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=Hw(r[o],a[o]);if(0!==u)return u;var s=nb(n[r[o]],i[a[o]]);if(0!==s)return s}return Hw(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Aw()}}function rb(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Hw(e,t);var n=B_(e),r=B_(t),i=Hw(n.seconds,r.seconds);return 0!==i?i:Hw(n.nanos,r.nanos)}function ib(e){return ab(e)}function ab(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=B_(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?q_(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,t_.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=T(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=ab(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=T(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(ab(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):Aw();var t,n}function ob(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function ub(e){return!!e&&"integerValue"in e}function sb(e){return!!e&&"arrayValue"in e}function cb(e){return!!e&&"nullValue"in e}function lb(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function hb(e){return!!e&&"mapValue"in e}function fb(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return N_(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=fb(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=fb(e.arrayValue.values[r]);return n}return Object.assign({},e)}function db(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function pb(e){return"nullValue"in e?$_:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?ob(G_.empty(),t_.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Aw()}function vb(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?ob(G_.empty(),t_.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?X_:Aw()}function yb(e,t){var n=nb(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function mb(e,t){var n=nb(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var gb=function(){function e(t){S(this,e),this.value=t}return N(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!hb(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fb(t)}},{key:"setAll",value:function(e){var t=this,n=e_.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=fb(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());hb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return eb(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];hb(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){N_(t,(function(t,n){return e[t]=n}));var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(fb(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function kb(e){var t=[];return N_(e.fields,(function(e,n){var r=new e_([e]);if(hb(n)){var i=kb(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=T(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(r.child(u))}}catch(s){o.e(s)}finally{o.f()}}}else t.push(r)})),new F_(t)}var wb=function(){function e(t,n,r,i,a,o){S(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return N(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=gb.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=gb.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Jw.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Jw.min(),Jw.min(),gb.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Jw.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Jw.min(),gb.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Jw.min(),gb.empty(),2)}}]),e}(),_b=N((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;S(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=u,this.ut=null}));function bb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new _b(e,t,n,r,i,a,o)}function xb(e){var t=Pw(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return(t=e).field.canonicalString()+t.op.toString()+ib(t.value);var t})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Q_(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return ib(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return ib(e)})).join(",")),t.ut=n}return t.ut}function Ib(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Bb(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],a=t.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!eb(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!qb(e.startAt,t.startAt)&&qb(e.endAt,t.endAt)}function Eb(e){return t_.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Tb(e,t){return e.filters.filter((function(e){return e instanceof Nb&&e.field.isEqual(t)}))}function Sb(e,t,n){var r,i=$_,a=!0,o=T(Tb(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=$_,c=!0;switch(u.op){case"<":case"<=":s=pb(u.value);break;case"==":case"in":case">=":s=u.value;break;case">":s=u.value,c=!1;break;case"!=":case"not-in":s=$_}yb({value:i,inclusive:a},{value:s,inclusive:c})<0&&(i=s,a=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];yb({value:i,inclusive:a},{value:h,inclusive:n.inclusive})<0&&(i=h,a=n.inclusive);break}return{value:i,inclusive:a}}function Cb(e,t,n){var r,i=X_,a=!0,o=T(Tb(e,t));try{for(o.s();!(r=o.n()).done;){var u=r.value,s=X_,c=!0;switch(u.op){case">=":case">":s=vb(u.value),c=!1;break;case"==":case"in":case"<=":s=u.value;break;case"<":s=u.value,c=!1;break;case"!=":case"not-in":s=X_}mb({value:i,inclusive:a},{value:s,inclusive:c})>0&&(i=s,a=c)}}catch(f){o.e(f)}finally{o.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var h=n.position[l];mb({value:i,inclusive:a},{value:h,inclusive:n.inclusive})>0&&(i=h,a=n.inclusive);break}return{value:i,inclusive:a}}var Nb=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return N(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(nb(t,this.value)):null!==t&&Z_(this.value)===Z_(t)&&this.at(nb(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Aw()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new Ab(e,t,r):"array-contains"===t?new Ob(e,r):"in"===t?new Lb(e,r):"not-in"===t?new Mb(e,r):"array-contains-any"===t?new Fb(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new Db(e,n):new Pb(e,n)}}]),n}(function(){return N((function e(){S(this,e)}))}()),Ab=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this,e,r,i)).key=t_.fromName(i.referenceValue),a}return N(n,[{key:"matches",value:function(e){var t=t_.comparator(e.key,this.key);return this.at(t)}}]),n}(Nb),Db=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,"in",r)).keys=Rb("in",r),i}return N(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Nb),Pb=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,"not-in",r)).keys=Rb("not-in",r),i}return N(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Nb);function Rb(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return t_.fromName(e.referenceValue)}))}var Ob=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"array-contains",r)}return N(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return sb(t)&&tb(t.arrayValue,this.value)}}]),n}(Nb),Lb=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"in",r)}return N(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&tb(this.value.arrayValue,t)}}]),n}(Nb),Mb=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"not-in",r)}return N(n,[{key:"matches",value:function(e){if(tb(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!tb(this.value.arrayValue,t)}}]),n}(Nb),Fb=function(e){P(n,e);var t=M(n);function n(e,r){return S(this,n),t.call(this,e,"array-contains-any",r)}return N(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!sb(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return tb(t.value.arrayValue,e)}))}}]),n}(Nb),Ub=N((function e(t,n){S(this,e),this.position=t,this.inclusive=n})),Vb=N((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";S(this,e),this.field=t,this.dir=n}));function Bb(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function jb(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?t_.comparator(t_.fromName(o.referenceValue),n.key):nb(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function qb(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!eb(e.position[n],t.position[n]))return!1;return!0}var zb=N((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;S(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=u,this.endAt=s,this.lt=null,this.ft=null,this.startAt,this.endAt}));function Wb(e,t,n,r,i,a,o,u){return new zb(e,t,n,r,i,a,o,u)}function Kb(e){return new zb(e)}function Hb(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Gb(e){var t,n=T(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function Qb(e){return null!==e.collectionGroup}function Yb(e){var t=Pw(e);if(null===t.lt){t.lt=[];var n=Gb(t),r=Hb(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new Vb(n)),t.lt.push(new Vb(e_.keyField(),"asc"));else{var i,a=!1,o=T(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;t.lt.push(u),u.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new Vb(e_.keyField(),s))}}}return t.lt}function Jb(e){var t=Pw(e);if(!t.ft)if("F"===t.limitType)t.ft=bb(t.path,t.collectionGroup,Yb(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=T(Yb(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new Vb(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var u=t.endAt?new Ub(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Ub(t.startAt.position,t.startAt.inclusive):null;t.ft=bb(t.path,t.collectionGroup,r,t.filters,t.limit,u,s)}return t.ft}function Xb(e,t,n){return new zb(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function $b(e,t){return Ib(Jb(e),Jb(t))&&e.limitType===t.limitType}function Zb(e){return"".concat(xb(Jb(e)),"|lt:").concat(e.limitType)}function ex(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(ib(t.value));var t})).join(", "),"]")),Q_(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return ib(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return ib(e)})).join(",")),"Target(".concat(t,")")}(Jb(e)),"; limitType=").concat(e.limitType,")")}function tx(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):t_.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=T(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=T(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=jb(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Yb(e),t))&&!(e.endAt&&!function(e,t,n){var r=jb(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Yb(e),t))}(e,t)}function nx(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function rx(e){return function(t,n){var r,i=!1,a=T(Yb(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=ix(o,t,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function ix(e,t,n){var r=e.field.isKeyField()?t_.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?nb(r,i):Aw()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Aw()}}function ax(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Y_(t)?"-0":t}}function ox(e){return{integerValue:""+e}}function ux(e,t){return J_(t)?ox(t):ax(e,t)}var sx=N((function e(){S(this,e),this._=void 0}));function cx(e,t,n){return e instanceof fx?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof dx?px(e,t):e instanceof vx?yx(e,t):function(e,t){var n=hx(e,t),r=gx(n)+gx(e._t);return ub(n)&&ub(e._t)?ox(r):ax(e.wt,r)}(e,t)}function lx(e,t,n){return e instanceof dx?px(e,t):e instanceof vx?yx(e,t):n}function hx(e,t){return e instanceof mx?ub(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var fx=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n)}(sx),dx=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).elements=e,r}return N(n)}(sx);function px(e,t){var n,r=kx(t),i=T(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return eb(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var vx=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).elements=e,r}return N(n)}(sx);function yx(e,t){var n,r=kx(t),i=T(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!eb(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var mx=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).wt=e,i._t=r,i}return N(n)}(sx);function gx(e){return j_(e.integerValue||e.doubleValue)}function kx(e){return sb(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var wx=N((function e(t,n){S(this,e),this.field=t,this.transform=n}));var _x=N((function e(t,n){S(this,e),this.version=t,this.transformResults=n})),bx=function(){function e(t,n){S(this,e),this.updateTime=t,this.exists=n}return N(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function xx(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Ix=N((function e(){S(this,e)}));function Ex(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Fx(e.key,bx.none()):new Ax(e.key,e.data,bx.none());var n,r=e.data,i=gb.empty(),a=new O_(e_.comparator),o=T(t.fields);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(!a.has(u)){var s=r.field(u);null===s&&u.length>1&&(u=u.popLast(),s=r.field(u)),null===s?i.delete(u):i.set(u,s),a=a.add(u)}}}catch(c){o.e(c)}finally{o.f()}return new Dx(e.key,i,new F_(a.toArray()),bx.none())}function Tx(e,t,n){e instanceof Ax?function(e,t,n){var r=e.value.clone(),i=Rx(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Dx?function(e,t,n){if(xx(e.precondition,t)){var r=Rx(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Px(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Sx(e,t,n,r){return e instanceof Ax?function(e,t,n,r){if(!xx(e.precondition,t))return n;var i=e.value.clone(),a=Ox(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Dx?function(e,t,n,r){if(!xx(e.precondition,t))return n;var i=Ox(e.fieldTransforms,r,t),a=t.data;return a.setAll(Px(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return xx(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Cx(e,t){var n,r=null,i=T(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),u=hx(a.transform,o||null);null!=u&&(null===r&&(r=gb.empty()),r.set(a.field,u))}}catch(s){i.e(s)}finally{i.f()}return r||null}function Nx(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Gw(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof dx&&t instanceof dx||e instanceof vx&&t instanceof vx?Gw(e.elements,t.elements,eb):e instanceof mx&&t instanceof mx?eb(e._t,t._t):e instanceof fx&&t instanceof fx}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Ax=function(e){P(n,e);var t=M(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return S(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return N(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ix),Dx=function(e){P(n,e);var t=M(n);function n(e,r,i,a){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return S(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=u,o.type=1,o}return N(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Ix);function Px(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Rx(e,t,n){var r=new Map;Dw(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,lx(o,u,n[i]))}return r}function Ox(e,t,n){var r,i=new Map,a=T(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,s=n.data.field(o.field);i.set(o.field,cx(u,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Lx,Mx,Fx=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return N(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ix),Ux=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return N(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Ix),Vx=N((function e(t){S(this,e),this.count=t}));function Bx(e){switch(e){default:return Aw();case Rw.CANCELLED:case Rw.UNKNOWN:case Rw.DEADLINE_EXCEEDED:case Rw.RESOURCE_EXHAUSTED:case Rw.INTERNAL:case Rw.UNAVAILABLE:case Rw.UNAUTHENTICATED:return!1;case Rw.INVALID_ARGUMENT:case Rw.NOT_FOUND:case Rw.ALREADY_EXISTS:case Rw.PERMISSION_DENIED:case Rw.FAILED_PRECONDITION:case Rw.ABORTED:case Rw.OUT_OF_RANGE:case Rw.UNIMPLEMENTED:case Rw.DATA_LOSS:return!0}}function jx(e){if(void 0===e)return Sw("GRPC error has no .code"),Rw.UNKNOWN;switch(e){case Lx.OK:return Rw.OK;case Lx.CANCELLED:return Rw.CANCELLED;case Lx.UNKNOWN:return Rw.UNKNOWN;case Lx.DEADLINE_EXCEEDED:return Rw.DEADLINE_EXCEEDED;case Lx.RESOURCE_EXHAUSTED:return Rw.RESOURCE_EXHAUSTED;case Lx.INTERNAL:return Rw.INTERNAL;case Lx.UNAVAILABLE:return Rw.UNAVAILABLE;case Lx.UNAUTHENTICATED:return Rw.UNAUTHENTICATED;case Lx.INVALID_ARGUMENT:return Rw.INVALID_ARGUMENT;case Lx.NOT_FOUND:return Rw.NOT_FOUND;case Lx.ALREADY_EXISTS:return Rw.ALREADY_EXISTS;case Lx.PERMISSION_DENIED:return Rw.PERMISSION_DENIED;case Lx.FAILED_PRECONDITION:return Rw.FAILED_PRECONDITION;case Lx.ABORTED:return Rw.ABORTED;case Lx.OUT_OF_RANGE:return Rw.OUT_OF_RANGE;case Lx.UNIMPLEMENTED:return Rw.UNIMPLEMENTED;case Lx.DATA_LOSS:return Rw.DATA_LOSS;default:return Aw()}}(Mx=Lx||(Lx={}))[Mx.OK=0]="OK",Mx[Mx.CANCELLED=1]="CANCELLED",Mx[Mx.UNKNOWN=2]="UNKNOWN",Mx[Mx.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mx[Mx.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mx[Mx.NOT_FOUND=5]="NOT_FOUND",Mx[Mx.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mx[Mx.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mx[Mx.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mx[Mx.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mx[Mx.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mx[Mx.ABORTED=10]="ABORTED",Mx[Mx.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mx[Mx.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mx[Mx.INTERNAL=13]="INTERNAL",Mx[Mx.UNAVAILABLE=14]="UNAVAILABLE",Mx[Mx.DATA_LOSS=15]="DATA_LOSS";var qx=function(){function e(t,n){S(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return N(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=l(r.value,2),o=a[0],u=a[1];if(this.equalsFn(o,e))return u}}catch(s){i.e(s)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){N_(this.inner,(function(t,n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=l(r.value,2),o=a[0],u=a[1];e(o,u)}}catch(s){i.e(s)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return A_(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),zx=new D_(t_.comparator);function Wx(){return zx}var Kx=new D_(t_.comparator);function Hx(){for(var e=Kx,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function Gx(e){var t=Kx;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function Qx(){return Jx()}function Yx(){return Jx()}function Jx(){return new qx((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Xx=new D_(t_.comparator),$x=new O_(t_.comparator);function Zx(){for(var e=$x,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var eI=new O_(Hw);function tI(){return eI}var nI=function(){function e(t,n,r,i,a){S(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return N(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,rI.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Jw.min(),r,tI(),Wx(),Zx())}}]),e}(),rI=function(){function e(t,n,r,i,a){S(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return N(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(U_.EMPTY_BYTE_STRING,n,Zx(),Zx(),Zx())}}]),e}(),iI=N((function e(t,n,r,i){S(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i})),aI=N((function e(t,n){S(this,e),this.targetId=t,this.It=n})),oI=N((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U_.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;S(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),uI=function(){function e(){S(this,e),this.Tt=0,this.Et=lI(),this.At=U_.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return N(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=Zx(),t=Zx(),n=Zx();return this.Et.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Aw()}})),new rI(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=lI()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),sI=function(){function e(t){S(this,e),this.Mt=t,this.Ft=new Map,this.$t=Wx(),this.Bt=cI(),this.Lt=new O_(Hw)}return N(e,[{key:"Ut",value:function(e){var t,n=T(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(u){n.e(u)}finally{n.f()}var i,a=T(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(u){a.e(u)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:Aw()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((function(e,r){n.jt(r)&&t(r)}))}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(Eb(i))if(0===n){var a=new t_(i.path);this.Kt(t,a,wb.newNoDocument(a,Jw.min()))}else Dw(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach((function(r,i){var a=t.Ht(i);if(a){if(r.current&&Eb(a.target)){var o=new t_(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,wb.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}}));var r=Zx();this.Bt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.$t.forEach((function(t,n){return n.setReadTime(e)}));var i=new nI(e,n,this.Lt,this.$t,r);return this.$t=Wx(),this.Bt=cI(),this.Lt=new O_(Hw),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new uI,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new O_(Hw),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||Tw("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new uI),this.Mt.getRemoteKeysForTarget(e).forEach((function(n){t.Kt(e,n,null)}))}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function cI(){return new D_(t_.comparator)}function lI(){return new D_(t_.comparator)}var hI={asc:"ASCENDING",desc:"DESCENDING"},fI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dI=N((function e(t,n){S(this,e),this.databaseId=t,this.dt=n}));function pI(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function vI(e,t){return e.dt?t.toBase64():t.toUint8Array()}function yI(e,t){return pI(e,t.toTimestamp())}function mI(e){return Dw(!!e),Jw.fromTimestamp(function(e){var t=B_(e);return new Yw(t.seconds,t.nanos)}(e))}function gI(e,t){return function(e){return new $w(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function kI(e){var t=$w.fromString(e);return Dw(qI(t)),t}function wI(e,t){return gI(e.databaseId,t.path)}function _I(e,t){var n=kI(t);if(n.get(1)!==e.databaseId.projectId)throw new Ow(Rw.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ow(Rw.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new t_(EI(n))}function bI(e,t){return gI(e.databaseId,t)}function xI(e){var t=kI(e);return 4===t.length?$w.emptyPath():EI(t)}function II(e){return new $w(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function EI(e){return Dw(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function TI(e,t,n){return{name:wI(e,t),fields:n.value.mapValue.fields}}function SI(e,t,n){var r=_I(e,t.name),i=mI(t.updateTime),a=new gb({mapValue:{fields:t.fields}}),o=wb.newFoundDocument(r,i,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function CI(e,t){return"found"in t?function(e,t){Dw(!!t.found),t.found.name,t.found.updateTime;var n=_I(e,t.found.name),r=mI(t.found.updateTime),i=new gb({mapValue:{fields:t.found.fields}});return wb.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){Dw(!!t.missing),Dw(!!t.readTime);var n=_I(e,t.missing),r=mI(t.readTime);return wb.newNoDocument(n,r)}(e,t):Aw()}function NI(e,t){var n;if(t instanceof Ax)n={update:TI(e,t.key,t.value)};else if(t instanceof Fx)n={delete:wI(e,t.key)};else if(t instanceof Dx)n={update:TI(e,t.key,t.data),updateMask:jI(t.fieldMask)};else{if(!(t instanceof Ux))return Aw();n={verify:wI(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof fx)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof dx)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof vx)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof mx)return{fieldPath:t.field.canonicalString(),increment:n._t};throw Aw()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:yI(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Aw()}(e,t.precondition)),n}function AI(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?bx.updateTime(mI(e.updateTime)):void 0!==e.exists?bx.exists(e.exists):bx.none()}(t.currentDocument):bx.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)Dw("REQUEST_TIME"===t.setToServerValue),n=new fx;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new dx(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new vx(i)}else"increment"in t?n=new mx(e,t.increment):Aw();var a=e_.fromServerFormat(t.fieldPath);return new wx(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=_I(e,t.update.name),a=new gb({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new F_(t.map((function(e){return e_.fromServerFormat(e)})))}(t.updateMask);return new Dx(i,a,o,n,r)}return new Ax(i,a,n,r)}if(t.delete){var u=_I(e,t.delete);return new Fx(u,n)}if(t.verify){var s=_I(e,t.verify);return new Ux(s,n)}return Aw()}function DI(e,t){return{documents:[bI(e,t.path)]}}function PI(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=bI(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=bI(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(lb(e.value))return{unaryFilter:{field:FI(e.field),op:"IS_NAN"}};if(cb(e.value))return{unaryFilter:{field:FI(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(lb(e.value))return{unaryFilter:{field:FI(e.field),op:"IS_NOT_NAN"}};if(cb(e.value))return{unaryFilter:{field:FI(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:FI(e.field),op:MI(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:FI(e.field),direction:LI(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u=function(e,t){return e.dt||Q_(t)?t:{value:t}}(e,t.limit);return null!==u&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function RI(e){var t=xI(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Dw(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=OI(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return function(e){return new Vb(UI(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var s=null;n.limit&&(s=function(e){var t;return Q_(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new Ub(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new Ub(n,t)}(n.endAt)),Wb(t,i,u,o,s,"F",c,l)}function OI(e){return e?void 0!==e.unaryFilter?[BI(e)]:void 0!==e.fieldFilter?[VI(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return OI(e)})).reduce((function(e,t){return e.concat(t)})):Aw():[]}function LI(e){return hI[e]}function MI(e){return fI[e]}function FI(e){return{fieldPath:e.canonicalString()}}function UI(e){return e_.fromServerFormat(e.fieldPath)}function VI(e){return Nb.create(UI(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Aw()}}(e.fieldFilter.op),e.fieldFilter.value)}function BI(e){switch(e.unaryFilter.op){case"IS_NAN":var t=UI(e.unaryFilter.field);return Nb.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=UI(e.unaryFilter.field);return Nb.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=UI(e.unaryFilter.field);return Nb.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=UI(e.unaryFilter.field);return Nb.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Aw()}}function jI(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function qI(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function zI(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=KI(t)),t=WI(e.get(n),t);return KI(t)}function WI(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function KI(e){return e+"\x01\x01"}function HI(e){var t=e.length;if(Dw(t>=2),2===t)return Dw("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),$w.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&Aw(),e.charAt(o+1)){case"\x01":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:Aw()}a=o+2}return new $w(r)}var GI=["userId","batchId"];function QI(e,t){return[e,zI(t)]}function YI(e,t,n){return[e,zI(t),n]}var JI={},XI=["prefixPath","collectionGroup","readTime","documentId"],$I=["prefixPath","collectionGroup","documentId"],ZI=["collectionGroup","readTime","prefixPath","documentId"],eE=["canonicalId","targetId"],tE=["targetId","path"],nE=["path","targetId"],rE=["collectionId","parent"],iE=["indexId","uid"],aE=["uid","sequenceNumber"],oE=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],uE=["indexId","uid","orderedDocumentKey"],sE=["userId","collectionPath","documentId"],cE=["userId","collectionPath","largestBatchId"],lE=["userId","collectionGroup","largestBatchId"],hE=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),fE=[].concat(u(hE),["documentOverlays"]),dE=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pE=dE,vE=[].concat(pE,["indexConfiguration","indexState","indexEntries"]),yE=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).ee=e,i.currentSequenceNumber=r,i}return N(n)}(f_);function mE(e,t){var n=Pw(e);return m_.N(n.ee,t)}var gE=function(){function e(t,n,r,i){S(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return N(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Tx(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=T(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=Sx(i,e,t,this.localWriteTime))}}catch(s){r.e(s)}finally{r.f()}var a,o=T(this.mutations);try{for(o.s();!(a=o.n()).done;){var u=a.value;u.key.isEqual(e.key)&&(t=Sx(u,e,t,this.localWriteTime))}}catch(s){o.e(s)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Yx();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=Ex(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(Jw.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Zx())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Gw(this.mutations,e.mutations,(function(e,t){return Nx(e,t)}))&&Gw(this.baseMutations,e.baseMutations,(function(e,t){return Nx(e,t)}))}}]),e}(),kE=function(){function e(t,n,r,i){S(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return N(e,null,[{key:"from",value:function(t,n,r){Dw(t.mutations.length===r.length);for(var i=Xx,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),wE=function(){function e(t,n){S(this,e),this.largestBatchId=t,this.mutation=n}return N(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),_E=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Jw.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Jw.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:U_.EMPTY_BYTE_STRING;S(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return N(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),bE=N((function e(t){S(this,e),this.ne=t}));function xE(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:IE(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:wI(e,t.key),fields:t.data.value.mapValue.fields,updateTime:pI(e,t.version.toTimestamp())}}(e.ne,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:EE(t.version)};else{if(!t.isUnknownDocument())return Aw();r.unknownDocument={path:n.path.toArray(),version:EE(t.version)}}return r}function IE(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function EE(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function TE(e){var t=new Yw(e.seconds,e.nanoseconds);return Jw.fromTimestamp(t)}function SE(e,t){for(var n=(t.baseMutations||[]).map((function(t){return AI(e.ne,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return AI(e.ne,t)})),u=Yw.fromMillis(t.localWriteTimeMs);return new gE(t.batchId,u,n,o)}function CE(e){var t,n,r=TE(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?TE(e.lastLimboFreeSnapshotVersion):Jw.min();return void 0!==e.query.documents?(Dw(1===(n=e.query).documents.length),t=Jb(Kb(xI(n.documents[0])))):t=function(e){return Jb(RI(e))}(e.query),new _E(t,e.targetId,0,e.lastListenSequenceNumber,r,i,U_.fromBase64String(e.resumeToken))}function NE(e,t){var n,r=EE(t.snapshotVersion),i=EE(t.lastLimboFreeSnapshotVersion);n=Eb(t.target)?DI(e.ne,t.target):PI(e.ne,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:xb(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function AE(e){var t=RI({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Xb(t,t.limit,"L"):t}function DE(e,t){return new wE(t.largestBatchId,AI(e.ne,t.overlayMutation))}function PE(e,t){var n=t.path.lastSegment();return[e,zI(t.path.popLast()),n]}function RE(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:EE(r.readTime),documentKey:zI(r.documentKey.path),largestBatchId:r.largestBatchId}}var OE=function(){function e(){S(this,e)}return N(e,[{key:"getBundleMetadata",value:function(e,t){return LE(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:TE(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return LE(e).put({bundleId:(n=t).id,createTime:EE(mI(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return ME(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:AE(t.bundledQuery),readTime:TE(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return ME(e).put(function(e){return{name:e.name,readTime:EE(mI(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function LE(e){return mE(e,"bundles")}function ME(e){return mE(e,"namedQueries")}var FE=function(){function e(t,n){S(this,e),this.wt=t,this.userId=n}return N(e,[{key:"getOverlay",value:function(e,t){var n=this;return UE(e).get(PE(this.userId,t)).next((function(e){return e?DE(n.wt,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=Qx();return v_.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new wE(t,a);i.push(r.ie(e,o))})),v_.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(zI(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(UE(e).W("collectionPathOverlayIndex",i))})),v_.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=Qx(),a=zI(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return UE(e).K("collectionPathOverlayIndex",o).next((function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=DE(r.wt,a);i.set(o.getKey(),o)}}catch(u){n.e(u)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=Qx(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return UE(e).J({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=DE(a.wt,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"ie",value:function(e,t){return UE(e).put(function(e,t,n){var r=l(PE(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:NI(e.ne,n.mutation)}}(this.wt,this.userId,t))}}],[{key:"se",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function UE(e){return mE(e,"documentOverlays")}var VE=function(){function e(){S(this,e)}return N(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(j_(e.integerValue));else if("doubleValue"in e){var n=j_(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),Y_(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(q_(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?db(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):Aw()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),t_.fromName(e).path.forEach((function(e){n.ce(t,60),n.ge(e,t)}))}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();function BE(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function jE(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=BE(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}VE.ye=new VE;var qE=function(){function e(){S(this,e),this.buffer=new Uint8Array(1024),this.position=0}return N(e,[{key:"pe",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ie(n.value),n=t.next();this.Te()}},{key:"Ee",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ae(n.value),n=t.next();this.Re()}},{key:"be",value:function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ie(i);else if(i<2048)this.Ie(960|i>>>6),this.Ie(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ie(480|i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i);else{var a=r.codePointAt(0);this.Ie(240|a>>>18),this.Ie(128|63&a>>>12),this.Ie(128|63&a>>>6),this.Ie(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Te()}},{key:"Pe",value:function(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Ae(i);else if(i<2048)this.Ae(960|i>>>6),this.Ae(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Ae(480|i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i);else{var a=r.codePointAt(0);this.Ae(240|a>>>18),this.Ae(128|63&a>>>12),this.Ae(128|63&a>>>6),this.Ae(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.Re()}},{key:"ve",value:function(e){var t=this.Ve(e),n=jE(t);this.Se(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"De",value:function(e){var t=this.Ve(e),n=jE(t);this.Se(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"Ce",value:function(){this.xe(255),this.xe(255)}},{key:"Ne",value:function(){this.ke(255),this.ke(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Oe",value:function(){return this.buffer.slice(0,this.position)}},{key:"Ve",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"Ie",value:function(e){var t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}},{key:"Ae",value:function(e){var t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}},{key:"Te",value:function(){this.xe(0),this.xe(1)}},{key:"Re",value:function(){this.ke(0),this.ke(1)}},{key:"xe",value:function(e){this.Se(1),this.buffer[this.position++]=e}},{key:"ke",value:function(e){this.Se(1),this.buffer[this.position++]=~e}},{key:"Se",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),zE=function(){function e(t){S(this,e),this.Me=t}return N(e,[{key:"de",value:function(e){this.Me.pe(e)}},{key:"he",value:function(e){this.Me.be(e)}},{key:"ae",value:function(e){this.Me.ve(e)}},{key:"ue",value:function(){this.Me.Ce()}}]),e}(),WE=function(){function e(t){S(this,e),this.Me=t}return N(e,[{key:"de",value:function(e){this.Me.Ee(e)}},{key:"he",value:function(e){this.Me.Pe(e)}},{key:"ae",value:function(e){this.Me.De(e)}},{key:"ue",value:function(){this.Me.Ne()}}]),e}(),KE=function(){function e(){S(this,e),this.Me=new qE,this.Fe=new zE(this.Me),this.$e=new WE(this.Me)}return N(e,[{key:"seed",value:function(e){this.Me.seed(e)}},{key:"Be",value:function(e){return 0===e?this.Fe:this.$e}},{key:"Oe",value:function(){return this.Me.Oe()}},{key:"reset",value:function(){this.Me.reset()}}]),e}(),HE=function(){function e(t,n,r,i){S(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return N(e,[{key:"Le",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function GE(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=QE(e.arrayValue,t.arrayValue))?n:0!==(n=QE(e.directionalValue,t.directionalValue))?n:t_.comparator(e.documentKey,t.documentKey)}function QE(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var YE=function(){function e(t){S(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Ue=t.orderBy,this.qe=[];var n,r=T(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.ht()?this.Ke=i:this.qe.push(i)}}catch(a){r.e(a)}finally{r.f()}}return N(e,[{key:"Ge",value:function(e){var t=r_(e);if(void 0!==t&&!this.Qe(t))return!1;for(var n=i_(e),r=0,i=0;r<n.length&&this.Qe(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Ke){var a=n[r];if(!this.je(this.Ke,a)||!this.We(this.Ue[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}},{key:"Qe",value:function(e){var t,n=T(this.qe);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.je(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"je",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"We",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}(),JE=function(){function e(){S(this,e),this.ze=new XE}return N(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),v_.resolve()}},{key:"getCollectionParents",value:function(e,t){return v_.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return v_.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return v_.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return v_.resolve(null)}},{key:"getIndexType",value:function(e,t){return v_.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return v_.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return v_.resolve(null)}},{key:"getMinOffset",value:function(e,t){return v_.resolve(c_.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return v_.resolve(c_.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return v_.resolve()}},{key:"updateIndexEntries",value:function(e,t){return v_.resolve()}}]),e}(),XE=function(){function e(){S(this,e),this.index={}}return N(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new O_($w.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new O_($w.comparator)).toArray()}}]),e}(),$E=new Uint8Array(0),ZE=function(){function e(t,n){S(this,e),this.user=t,this.databaseId=n,this.He=new XE,this.Je=new qx((function(e){return xb(e)}),(function(e,t){return Ib(e,t)})),this.uid=t.uid||""}return N(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.He.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.He.add(t)}));var a={collectionId:r,parent:zI(i)};return eT(e).put(a)}return v_.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Qw(t),""],!1,!0);return eT(e).K(r).next((function(e){var r,i=T(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(HI(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=this,r=nT(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var o=rT(e);return a.next((function(e){o.put(RE(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=nT(e),r=rT(e),i=tT(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=tT(e),i=!0,a=new Map;return v_.forEach(this.Ye(t),(function(t){return n.Xe(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=Zx(),o=[];return v_.forEach(a,(function(i,a){var u;Tw("IndexedDbIndexManager","Using index ".concat((u=i,"id=".concat(u.indexId,"|cg=").concat(u.collectionGroup,"|f=").concat(u.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(xb(t)));var s=function(e,t){var n=r_(t);if(void 0===n)return null;var r,i=T(Tb(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r=new Map,i=T(i_(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,u=T(Tb(e,o.fieldPath));try{for(u.s();!(a=u.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],i=!0,a=T(i_(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?Sb(e,o.fieldPath,e.startAt):Cb(e,o.fieldPath,e.startAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new Ub(r,i)}(a,i),h=function(e,t){var n,r=[],i=!0,a=T(i_(t));try{for(a.s();!(n=a.n()).done;){var o=n.value,u=0===o.kind?Cb(e,o.fieldPath,e.endAt):Sb(e,o.fieldPath,e.endAt);r.push(u.value),i&&(i=u.inclusive)}}catch(s){a.e(s)}finally{a.f()}return new Ub(r,i)}(a,i),f=n.Ze(i,a,l),d=n.Ze(i,a,h),p=n.tn(i,a,c),v=n.en(i.indexId,s,f,l.inclusive,d,h.inclusive,p);return v_.forEach(v,(function(n){return r.j(n,t.limit).next((function(t){t.forEach((function(t){var n=t_.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),o.push(n))}))}))}))})).next((function(){return o}))}return v_.resolve(null)}))}},{key:"Ye",value:function(e){var t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}},{key:"en",value:function(e,t,n,r,i,a,o){for(var s=this,c=(null!=t?t.length:1)*Math.max(n.length,i.length),l=c/(null!=t?t.length:1),h=[],f=function(c){var f=t?s.nn(t[c/l]):$E,d=s.sn(e,f,n[c%l],r),p=s.rn(e,f,i[c%l],a),v=o.map((function(t){return s.sn(e,f,t,!0)}));h.push.apply(h,u(s.createRange(d,p,v)))},d=0;d<c;++d)f(d);return h}},{key:"sn",value:function(e,t,n,r){var i=new HE(e,t_.empty(),t,n);return r?i:i.Le()}},{key:"rn",value:function(e,t,n,r){var i=new HE(e,t_.empty(),t,n);return r?i.Le():i}},{key:"Xe",value:function(e,t){var n=new YE(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t,r=null,i=T(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.Ge(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return r}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2;return v_.forEach(this.Ye(t),(function(t){return n.Xe(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t,n=new O_(e_.comparator),r=!1,i=T(e.filters);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.field.isKeyField()||("array-contains"===a.op||"array-contains-any"===a.op?r=!0:n=n.add(a.field))}}catch(c){i.e(c)}finally{i.f()}var o,u=T(e.orderBy);try{for(u.s();!(o=u.n()).done;){var s=o.value;s.field.isKeyField()||(n=n.add(s.field))}}catch(c){u.e(c)}finally{u.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0}))})).next((function(){return r}))}},{key:"on",value:function(e,t){var n,r=new KE,i=T(i_(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var u=r.Be(a.kind);VE.ye.re(o,u)}}catch(s){i.e(s)}finally{i.f()}return r.Oe()}},{key:"nn",value:function(e){var t=new KE;return VE.ye.re(e,t.Be(0)),t.Oe()}},{key:"un",value:function(e,t){var n=new KE;return VE.ye.re(ob(this.databaseId,t),n.Be(function(e){var t=i_(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Oe()}},{key:"tn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new KE);var i,a=0,o=T(i_(e));try{for(o.s();!(i=o.n()).done;){var u,s=i.value,c=n[a++],l=T(r);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(this.cn(t,s.fieldPath)&&sb(c))r=this.an(r,s,c);else{var f=h.Be(s.kind);VE.ye.re(c,f)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.hn(r)}},{key:"Ze",value:function(e,t,n){return this.tn(e,t,n.position)}},{key:"hn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Oe();return t}},{key:"an",value:function(e,t,n){var r,i=u(e),a=[],o=T(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var s,c=r.value,l=T(i);try{for(l.s();!(s=l.n()).done;){var h=s.value,f=new KE;f.seed(h.Oe()),VE.ye.re(c,f.Be(t.kind)),a.push(f)}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return a}},{key:"cn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Nb&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=nT(e),i=rT(e);return(t?r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.K()).next((function(e){var t=[];return v_.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new o_(t.sequenceNumber,new c_(TE(t.readTime),new t_(HI(t.documentKey)),t.largestBatchId)):o_.empty(),r=e.fields.map((function(e){var t=l(e,2),n=t[0],r=t[1];return new a_(e_.fromServerFormat(n),r)}));return new n_(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Hw(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=nT(e),a=rT(e);return this.ln(e).next((function(e){return i.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return v_.forEach(t,(function(t){return a.put(RE(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return v_.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?v_.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),v_.forEach(a,(function(r){return n.fn(e,t,r).next((function(t){var a=n.dn(i,r);return t.isEqual(a)?v_.resolve():n._n(e,i,r,t,a)}))}))}))}))}},{key:"wn",value:function(e,t,n,r){return tT(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(n,t.key),documentKey:t.key.path.toArray()})}},{key:"mn",value:function(e,t,n,r){return tT(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(n,t.key),t.key.path.toArray()])}},{key:"fn",value:function(e,t,n){var r=tT(e),i=new O_(GE);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.un(n,t)])},(function(e,r){i=i.add(new HE(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"dn",value:function(e,t){var n=new O_(GE),r=this.on(t,e);if(null==r)return n;var i=r_(t);if(null!=i){var a=e.data.field(i.fieldPath);if(sb(a)){var o,u=T(a.arrayValue.values||[]);try{for(u.s();!(o=u.n()).done;){var s=o.value;n=n.add(new HE(t.indexId,e.key,this.nn(s),r))}}catch(c){u.e(c)}finally{u.f()}}}else n=n.add(new HE(t.indexId,e.key,$E,r));return n}},{key:"_n",value:function(e,t,n,r,i){var a=this;Tw("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=M_(a),s=M_(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=M_(o)):l?(i(u),u=M_(a)):(u=M_(a),s=M_(o))}}(r,i,GE,(function(r){o.push(a.wn(e,t,n,r))}),(function(r){o.push(a.mn(e,t,n,r))})),v_.waitFor(o)}},{key:"ln",value:function(e){var t=1;return rT(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return GE(e,t)})).filter((function(e,t,n){return!t||0!==GE(e,n[t-1])}));var r=[];r.push(e);var i,a=T(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=GE(o,e),s=GE(o,t);if(0===u)r[0]=e.Le();else if(u>0&&s<0)r.push(o),r.push(o.Le());else if(s>0)break}}catch(h){a.e(h)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2)c.push(IDBKeyRange.bound([r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,$E,[]],[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,$E,[]]));return c}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(iT)}},{key:"getMinOffset",value:function(e,t){var n=this;return v_.mapArray(this.Ye(t),(function(t){return n.Xe(e,t).next((function(e){return e||Aw()}))})).next(iT)}}]),e}();function eT(e){return mE(e,"collectionParents")}function tT(e){return mE(e,"indexEntries")}function nT(e){return mE(e,"indexConfiguration")}function rT(e){return mE(e,"indexState")}function iT(e){Dw(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;l_(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new c_(t.readTime,t.documentKey,n)}var aT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oT=function(){function e(t,n,r){S(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return N(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function uT(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.J({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){Dw(1===u)})));var c,l=[],h=T(n.mutations);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=YI(t,f.key.path,n.batchId);a.push(i.delete(d)),l.push(f.key)}}catch(p){h.e(p)}finally{h.f()}return v_.waitFor(a).next((function(){return l}))}function sT(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Aw();t=e.noDocument}return JSON.stringify(t).length}oT.DEFAULT_COLLECTION_PERCENTILE=10,oT.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oT.DEFAULT=new oT(41943040,oT.DEFAULT_COLLECTION_PERCENTILE,oT.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oT.DISABLED=new oT(-1,0,0);var cT=function(){function e(t,n,r,i){S(this,e),this.userId=t,this.wt=n,this.indexManager=r,this.referenceDelegate=i,this.gn={}}return N(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return hT(e).J({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=fT(e),o=hT(e);return o.add({}).next((function(u){Dw("number"==typeof u);var s,c=new gE(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return NI(e.ne,t)})),i=n.mutations.map((function(t){return NI(e.ne,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.wt,i.userId,c),h=[],f=new O_((function(e,t){return Hw(e.canonicalString(),t.canonicalString())})),d=T(r);try{for(d.s();!(s=d.n()).done;){var p=s.value,v=YI(i.userId,p.key.path,u);f=f.add(p.key.path.popLast()),h.push(o.put(l)),h.push(a.put(v,JI))}}catch(y){d.e(y)}finally{d.f()}return f.forEach((function(t){h.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.gn[u]=c.keys()})),v_.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return hT(e).get(t).next((function(e){return e?(Dw(e.userId===n.userId),SE(n.wt,e)):null}))}},{key:"yn",value:function(e,t){var n=this;return this.gn[t]?v_.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.gn[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return hT(e).J({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(Dw(t.batchId>=r),a=SE(n.wt,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return hT(e).J({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return hT(e).K("userMutationsIndex",n).next((function(e){return e.map((function(e){return SE(t.wt,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=QI(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return fT(e).J({range:i},(function(r,i,o){var u=l(r,3),s=u[0],c=u[1],h=u[2],f=HI(c);if(s===n.userId&&t.path.isEqual(f))return hT(e).get(h).next((function(e){if(!e)throw Aw();Dw(e.userId===n.userId),a.push(SE(n.wt,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new O_(Hw),i=[];return t.forEach((function(t){var a=QI(n.userId,t.path),o=IDBKeyRange.lowerBound(a),u=fT(e).J({range:o},(function(e,i,a){var o=l(e,3),u=o[0],s=o[1],c=o[2],h=HI(s);u===n.userId&&t.path.isEqual(h)?r=r.add(c):a.done()}));i.push(u)})),v_.waitFor(i).next((function(){return n.pn(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=QI(this.userId,r),o=IDBKeyRange.lowerBound(a),u=new O_(Hw);return fT(e).J({range:o},(function(e,t,a){var o=l(e,3),s=o[0],c=o[1],h=o[2],f=HI(c);s===n.userId&&r.isPrefixOf(f)?f.length===i&&(u=u.add(h)):a.done()})).next((function(){return n.pn(e,u)}))}},{key:"pn",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(hT(e).get(t).next((function(e){if(null===e)throw Aw();Dw(e.userId===n.userId),r.push(SE(n.wt,e))})))})),v_.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return uT(e.ee,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.In(t.batchId)})),v_.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"In",value:function(e){delete this.gn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return v_.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return fT(e).J({range:r},(function(e,n,r){if(e[0]===t.userId){var a=HI(e[1]);i.push(a)}else r.done()})).next((function(){Dw(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return lT(e,this.userId,t)}},{key:"Tn",value:function(e){var t=this;return dT(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"se",value:function(t,n,r,i){return Dw(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function lT(e,t,n){var r=QI(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return fT(e).J({range:a,H:!0},(function(e,n,r){var a=l(e,3),u=a[0],s=a[1];a[2];u===t&&s===i&&(o=!0),r.done()})).next((function(){return o}))}function hT(e){return mE(e,"mutations")}function fT(e){return mE(e,"documentMutations")}function dT(e){return mE(e,"mutationQueues")}var pT=function(){function e(t){S(this,e),this.En=t}return N(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),vT=function(){function e(t,n){S(this,e),this.referenceDelegate=t,this.wt=n}return N(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.bn(e).next((function(n){var r=new pT(n.highestTargetId);return n.highestTargetId=r.next(),t.Pn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.bn(e).next((function(e){return Jw.fromTimestamp(new Yw(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.bn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.bn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Pn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.vn(e,t).next((function(){return n.bn(e).next((function(r){return r.targetCount+=1,n.Vn(t,r),n.Pn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.vn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return yT(e).delete(t.targetId)})).next((function(){return n.bn(e)})).next((function(t){return Dw(t.targetCount>0),t.targetCount-=1,n.Pn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return yT(e).J((function(o,u){var s=CE(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return v_.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return yT(e).J((function(e,n){var r=CE(n);t(r)}))}},{key:"bn",value:function(e){return mT(e).get("targetGlobalKey").next((function(e){return Dw(null!==e),e}))}},{key:"Pn",value:function(e,t){return mT(e).put("targetGlobalKey",t)}},{key:"vn",value:function(e,t){return yT(e).put(NE(this.wt,t))}},{key:"Vn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.bn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=xb(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return yT(e).J({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=CE(n);Ib(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=gT(e);return t.forEach((function(t){var o=zI(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),v_.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=gT(e);return v_.forEach(t,(function(t){var a=zI(t.path);return v_.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=gT(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=gT(e),i=Zx();return r.J({range:n,H:!0},(function(e,t,n){var r=HI(e[1]),a=new t_(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=zI(t.path),r=IDBKeyRange.bound([n],[Qw(n)],!1,!0),i=0;return gT(e).J({index:"documentTargetsIndex",H:!0,range:r},(function(e,t,n){var r=l(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"te",value:function(e,t){return yT(e).get(t).next((function(e){return e?CE(e):null}))}}]),e}();function yT(e){return mE(e,"targets")}function mT(e){return mE(e,"targetGlobal")}function gT(e){return mE(e,"targetDocuments")}function kT(e,t){var n=l(e,2),r=n[0],i=n[1],a=l(t,2),o=a[0],u=a[1],s=Hw(r,o);return 0===s?Hw(i,u):s}var wT=function(){function e(t){S(this,e),this.Sn=t,this.buffer=new O_(kT),this.Dn=0}return N(e,[{key:"Cn",value:function(){return++this.Dn}},{key:"xn",value:function(e){var t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();kT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),_T=function(){function e(t,n,r){S(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Nn=null}return N(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}},{key:"stop",value:function(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}},{key:"started",get:function(){return null!==this.Nn}},{key:"kn",value:function(e){var t=this;Tw("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Nn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!w_(e.t0)){e.next=12;break}Tw("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,d_(e.t0);case 14:return e.next=16,t.kn(3e5);case 16:case"end":return e.stop()}}),e,null,[[1,6]])}))))}}]),e}(),bT=function(){function e(t,n){S(this,e),this.On=t,this.params=n}return N(e,[{key:"calculateTargetCount",value:function(e,t){return this.On.Mn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return v_.resolve(S_.ot);var r=new wT(t);return this.On.forEachTarget(e,(function(e){return r.xn(e.sequenceNumber)})).next((function(){return n.On.Fn(e,(function(e){return r.xn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.On.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.On.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Tw("LruGarbageCollector","Garbage collection skipped; disabled"),v_.resolve(aT)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Tw("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),aT):n.$n(e,t)}))}},{key:"getCacheSize",value:function(e){return this.On.getCacheSize(e)}},{key:"$n",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Tw("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Ew()<=Me.DEBUG&&Tw("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),v_.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}(),xT=function(){function e(t,n){S(this,e),this.db=t,this.garbageCollector=function(e,t){return new bT(e,t)}(this,n)}return N(e,[{key:"Mn",value:function(e){var t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Bn",value:function(e){var t=0;return this.Fn(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Fn",value:function(e,t){return this.Ln(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return IT(e,n)}},{key:"removeReference",value:function(e,t,n){return IT(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return IT(e,t)}},{key:"Un",value:function(e,t){return function(e,t){var n=!1;return dT(e).Y((function(r){return lT(e,r,t).next((function(e){return e&&(n=!0),v_.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Ln(e,(function(o,u){if(u<=t){var s=n.Un(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,Jw.min()),gT(e).delete([0,zI(o.path)])}))}));i.push(s)}})).next((function(){return v_.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return IT(e,t)}},{key:"Ln",value:function(e,t){var n,r=gT(e),i=S_.ot;return r.J({index:"documentTargetsIndex"},(function(e,r){var a=l(e,2),o=a[0],u=(a[1],r.path),s=r.sequenceNumber;0===o?(i!==S_.ot&&t(new t_(HI(n)),i),i=s,n=u):i=S_.ot})).next((function(){i!==S_.ot&&t(new t_(HI(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function IT(e,t){return gT(e).put(function(e,t){return{targetId:0,path:zI(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var ET=function(){function e(){S(this,e),this.changes=new qx((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return N(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,wb.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?v_.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),TT=function(){function e(t){S(this,e),this.wt=t}return N(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return AT(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return AT(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],IE(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=wb.newInvalidDocument(t);return AT(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(DT(t))},(function(e,i){r=n.Kn(t,i)})).next((function(){return r}))}},{key:"Gn",value:function(e,t){var n=this,r={size:0,document:wb.newInvalidDocument(t)};return AT(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(DT(t))},(function(e,i){r={document:n.Kn(t,i),size:sT(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=Wx();return this.Qn(e,t,(function(e,t){var i=n.Kn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"jn",value:function(e,t){var n=this,r=Wx(),i=new D_(t_.comparator);return this.Qn(e,t,(function(e,t){var a=n.Kn(e,t);r=r.insert(e,a),i=i.insert(e,sT(t))})).next((function(){return{documents:r,Wn:i}}))}},{key:"Qn",value:function(e,t,n){if(t.isEmpty())return v_.resolve();var r=new O_(RT);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(DT(r.first()),DT(r.last())),a=r.getIterator(),o=a.getNext();return AT(e).J({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=t_.fromSegments([].concat(u(t.prefixPath),[t.collectionGroup,t.documentId]));o&&RT(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.q(DT(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getAllFromCollection",value:function(e,t,n){var r=this,i=[t.popLast().toArray(),t.lastSegment(),IE(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return AT(e).K(IDBKeyRange.bound(i,a,!0)).next((function(e){var t,n=Wx(),i=T(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=r.Kn(t_.fromSegments(a.prefixPath.concat(a.collectionGroup,a.documentId)),a);n=n.insert(o.key,o)}}catch(u){i.e(u)}finally{i.f()}return n}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=Wx(),o=PT(t,n),u=PT(t,c_.max());return AT(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.Kn(t_.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new CT(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return NT(e).get("remoteDocumentGlobalKey").next((function(e){return Dw(!!e),e}))}},{key:"qn",value:function(e,t){return NT(e).put("remoteDocumentGlobalKey",t)}},{key:"Kn",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=SI(e.ne,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=t_.fromSegments(t.noDocument.path),i=TE(t.noDocument.readTime);n=wb.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Aw();var a=t_.fromSegments(t.unknownDocument.path),o=TE(t.unknownDocument.version);n=wb.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new Yw(e[0],e[1]);return Jw.fromTimestamp(t)}(t.readTime)),n}(this.wt,t);if(!n.isNoDocument()||!n.version.isEqual(Jw.min()))return n}return wb.newInvalidDocument(e)}}]),e}();function ST(e){return new TT(e)}var CT=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).zn=e,i.trackRemovals=r,i.Hn=new qx((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return N(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new O_((function(e,t){return Hw(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Hn.get(a);if(n.push(t.zn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=xE(t.zn.wt,o);i=i.add(a.path.popLast());var c=sT(s);r+=c-u.size,n.push(t.zn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=xE(t.zn.wt,o.convertToNoDocument(Jw.min()));n.push(t.zn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.zn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.zn.updateMetadata(e,r)),v_.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.zn.Gn(e,t).next((function(e){return n.Hn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.zn.jn(e,t).next((function(e){var t=e.documents;return e.Wn.forEach((function(e,r){n.Hn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(ET);function NT(e){return mE(e,"remoteDocumentGlobal")}function AT(e){return mE(e,"remoteDocumentsV14")}function DT(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function PT(e,t){var n=t.documentKey.path.toArray();return[e,IE(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function RT(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=Hw(n[a],r[a]))return i;return(i=Hw(n.length,r.length))||((i=Hw(n[n.length-2],r[r.length-2]))||Hw(n[n.length-1],r[r.length-1]))}var OT=N((function e(t,n){S(this,e),this.overlayedDocument=t,this.mutatedFields=n})),LT=function(){function e(t,n,r,i){S(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return N(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.getBaseDocument(e,t,r)})).next((function(e){return null!==r&&Sx(r.mutation,e,F_.empty(),Yw.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,Zx()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zx(),i=Qx();return this.populateOverlays(e,i,t).next((function(){return n.computeViews(e,t,i,r).next((function(e){var t=Hx();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Qx();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,Zx())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=Wx(),a=Jx(),o=Jx();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Dx)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),Sx(o.mutation,t,o.mutation.getFieldMask(),Yw.now()))})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new OT(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Jx(),i=new D_((function(e,t){return e-t})),a=Zx();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,a=T(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||F_.empty();o=e.applyToLocalView(a,o),r.set(n,o);var u=(i.get(e.batchId)||Zx()).add(n);i=i.insert(e.batchId,u)}}))};for(a.s();!(n=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}})).next((function(){for(var o=[],u=i.getReverseIterator(),s=function(){var i=u.getNext(),s=i.key,c=i.value,l=Yx();c.forEach((function(e){if(!a.has(e)){var n=Ex(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,s,l))};u.hasNext();)s();return v_.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return t_.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Qb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):v_.resolve(Qx()),u=-1,s=a;return o.next((function(t){return v_.forEach(t,(function(t,n){return u<n.largestBatchId&&(u=n.largestBatchId),a.get(t)?v_.resolve():i.getBaseDocument(e,t,n).next((function(e){s=s.insert(t,e)}))})).next((function(){return i.populateOverlays(e,t,a)})).next((function(){return i.computeViews(e,s,t,Zx())})).next((function(e){return{batchId:u,changes:Gx(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new t_(t)).next((function(e){var t=Hx();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=Hx();return this.indexManager.getCollectionParents(e,i).next((function(o){return v_.forEach(o,(function(o){var u=function(e,t){return new zb(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.getDocumentsMatchingCollectionQuery(e,u,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,wb.newInvalidDocument(n)))}));var n=Hx();return r.forEach((function(r,i){var a=e.get(r);void 0!==a&&Sx(a.mutation,i,F_.empty(),Yw.now()),tx(t,i)&&(n=n.insert(r,i))})),n}))}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):v_.resolve(wb.newInvalidDocument(t))}}]),e}(),MT=function(){function e(t){S(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return N(e,[{key:"getBundleMetadata",value:function(e,t){return v_.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:mI(n.createTime)}),v_.resolve()}},{key:"getNamedQuery",value:function(e,t){return v_.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,function(e){return{name:e.name,query:AE(e.bundledQuery),readTime:mI(e.readTime)}}(t)),v_.resolve()}}]),e}(),FT=function(){function e(){S(this,e),this.overlays=new D_(t_.comparator),this.Xn=new Map}return N(e,[{key:"getOverlay",value:function(e,t){return v_.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Qx();return v_.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.ie(e,t,i)})),v_.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.Xn.delete(n)),v_.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Qx(),i=t.length+1,a=new t_(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return v_.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new D_((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=Qx(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=Qx(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return v_.resolve(s)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new wE(t,n));var a=this.Xn.get(t);void 0===a&&(a=Zx(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),UT=function(){function e(){S(this,e),this.Zn=new O_(VT.ts),this.es=new O_(VT.ns)}return N(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new VT(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.rs(new VT(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"us",value:function(e){var t=this,n=new t_(new $w([])),r=new VT(n,e),i=new VT(n,e+1),a=[];return this.es.forEachInRange([r,i],(function(e){t.rs(e),a.push(e.key)})),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach((function(t){return e.rs(t)}))}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new t_(new $w([])),n=new VT(t,e),r=new VT(t,e+1),i=Zx();return this.es.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new VT(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),VT=function(){function e(t,n){S(this,e),this.key=t,this.ls=n}return N(e,null,[{key:"ts",value:function(e,t){return t_.comparator(e.key,t.key)||Hw(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Hw(e.ls,t.ls)||t_.comparator(e.key,t.key)}}]),e}(),BT=function(){function e(t,n){S(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new O_(VT.ts)}return N(e,[{key:"checkEmpty",value:function(e){return v_.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new gE(i,t,n,r);this.mutationQueue.push(a);var o,u=T(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;this.ds=this.ds.add(new VT(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){u.e(c)}finally{u.f()}return v_.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return v_.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ws(n),i=r<0?0:r;return v_.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return v_.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return v_.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new VT(t,0),i=new VT(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],(function(e){var t=n._s(e.ls);a.push(t)})),v_.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new O_(Hw);return t.forEach((function(e){var t=new VT(e,0),i=new VT(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],(function(e){r=r.add(e.ls)}))})),v_.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;t_.isDocumentKey(i)||(i=i.child(""));var a=new VT(new t_(i),0),o=new O_(Hw);return this.ds.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)}),a),v_.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t._s(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Dw(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return v_.forEach(t.mutations,(function(i){var a=new VT(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.ds=r}))}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new VT(t,0),r=this.ds.firstAfterOrEqual(n);return v_.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,v_.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),jT=function(){function e(t){S(this,e),this.ps=t,this.docs=new D_(t_.comparator),this.size=0}return N(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return v_.resolve(n?n.document.mutableCopy():wb.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Wx();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():wb.newInvalidDocument(e))})),v_.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=Wx(),i=new t_(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),u=o.key,s=o.value.document;if(!t.isPrefixOf(u.path))break;u.path.length>t.length+1||l_(s_(s),n)<=0||(r=r.insert(s.key,s.mutableCopy()))}return v_.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Aw()}},{key:"Is",value:function(e,t){return v_.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new qT(this)}},{key:"getSize",value:function(e){return v_.resolve(this.size)}}]),e}(),qT=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).zn=e,r}return N(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)})),v_.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(ET),zT=function(){function e(t){S(this,e),this.persistence=t,this.Ts=new qx((function(e){return xb(e)}),Ib),this.lastRemoteSnapshotVersion=Jw.min(),this.highestTargetId=0,this.Es=0,this.As=new UT,this.targetCount=0,this.Rs=pT.An()}return N(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach((function(e,n){return t(n)})),v_.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return v_.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return v_.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),v_.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),v_.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new pT(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,v_.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),v_.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,v_.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),v_.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return v_.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return v_.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),v_.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),v_.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),v_.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return v_.resolve(n)}},{key:"containsKey",value:function(e,t){return v_.resolve(this.As.containsKey(t))}}]),e}(),WT=function(){function e(t,n){var r=this;S(this,e),this.bs={},this.overlays={},this.Ps=new S_(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new zT(this),this.indexManager=new JE,this.remoteDocumentCache=new jT((function(e){return r.referenceDelegate.Ss(e)})),this.wt=new bE(n),this.Ds=new MT(this.wt)}return N(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new FT,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new BT(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;Tw("MemoryPersistence","Starting transaction:",e);var i=new KT(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next((function(e){return r.referenceDelegate.xs(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ns",value:function(e,t){return v_.or(Object.values(this.bs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),KT=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return N(n)}(f_),HT=function(){function e(t){S(this,e),this.persistence=t,this.ks=new UT,this.Os=null}return N(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw Aw()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),v_.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),v_.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),v_.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach((function(e){return n.Fs.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Fs.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v_.forEach(this.Fs,(function(r){var i=t_.fromPath(r);return t.$s(e,i).next((function(e){e||n.removeEntry(i,Jw.min())}))})).next((function(){return t.Os=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next((function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())}))}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return v_.or([function(){return v_.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),GT=function(){function e(t){S(this,e),this.wt=t}return N(e,[{key:"O",value:function(e,t,n,r){var i=this,a=new y_("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GI,{unique:!0}),e.createObjectStore("documentMutations")}(e),QT(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=v_.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),QT(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Jw.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").K().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",GI,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return v_.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Bs(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ls(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Us(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.Ks(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:sE});t.createIndex("collectionPathOverlayIndex",cE,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",lE,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:XI});t.createIndex("documentKeyIndex",$I),t.createIndex("collectionGroupIndex",ZI)}(e)})).next((function(){return i.Gs(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.Qs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:iE}).createIndex("sequenceNumberIndex",aE,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:oE}).createIndex("documentKeyIndex",uE,{unique:!1})}(e)}))),o}},{key:"Ls",value:function(e){var t=0;return e.store("remoteDocuments").J((function(e,n){t+=sT(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Bs",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.K().next((function(n){return v_.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",i).next((function(r){return v_.forEach(r,(function(r){Dw(r.userId===n.userId);var i=SE(t.wt,r);return uT(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"Us",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.J((function(n,i){var a=new $w(n),o=function(e){return[0,zI(e)]}(a);r.push(t.get(o).next((function(n){return n?v_.resolve():function(n){return t.put({targetId:0,path:zI(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return v_.waitFor(r)}))}))}},{key:"qs",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:rE});var n=t.store("collectionParents"),r=new XE,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:zI(i)})}};return t.store("remoteDocuments").J({H:!0},(function(e,t){var n=new $w(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").J({H:!0},(function(e,t){var n=l(e,3),r=(n[0],n[1]),a=(n[2],HI(r));return i(a.popLast())}))}))}},{key:"Ks",value:function(e){var t=this,n=e.store("targets");return n.J((function(e,r){var i=CE(r),a=NE(t.wt,i);return n.put(a)}))}},{key:"Gs",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.J((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new t_($w.fromString(i.document.name).popFirst(5)):i.noDocument?t_.fromSegments(i.noDocument.path):i.unknownDocument?t_.fromSegments(i.unknownDocument.path):Aw()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return v_.waitFor(r)}))}},{key:"Qs",value:function(e,t){var n=this,r=t.store("mutations"),i=ST(this.wt),a=new WT(HT.Ms,this.wt.ne);return r.K().next((function(e){var r=new Map;return e.forEach((function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:Zx();SE(n.wt,e).keys().forEach((function(e){return i=i.add(e)})),r.set(e.userId,i)})),v_.forEach(r,(function(e,r){var o=new bw(r),u=FE.se(n.wt,o),s=a.getIndexManager(o),c=cT.se(o,n.wt,s,a.referenceDelegate);return new LT(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new yE(t,S_.ot),e).next()}))}))}}]),e}();function QT(e){e.createObjectStore("targetDocuments",{keyPath:tE}).createIndex("documentTargetsIndex",nE,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",eE,{unique:!0}),e.createObjectStore("targetGlobal")}var YT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",JT=function(){function e(t,n,r,i,a,o,u,s,c,l){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:14;if(S(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.js=a,this.window=o,this.document=u,this.Ws=c,this.zs=l,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=function(e){return Promise.resolve()},!e.V())throw new Ow(Rw.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xT(this,i),this.ei=n+"main",this.wt=new bE(s),this.ni=new m_(this.ei,this.Hs,new GT(this.wt)),this.Vs=new vT(this.referenceDelegate,this.wt),this.remoteDocumentCache=ST(this.wt),this.Ds=new OE,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===l&&Sw("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return N(e,[{key:"start",value:function(){var e=this;return this.ii().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ow(Rw.FAILED_PRECONDITION,YT);return e.ri(),e.oi(),e.ui(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Vs.getHighestSequenceNumber(t)}))})).then((function(t){e.Ps=new S_(t,e.Ws)})).then((function(){e.vs=!0})).catch((function(t){return e.ni&&e.ni.close(),Promise.reject(t)}))}},{key:"ci",value:function(e){var t=this;return this.ti=function(){var n=E(x().mark((function n(r){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.ni.F(function(){var t=E(x().mark((function t(n){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.ii();case 4:case"end":return e.stop()}}),e)})))))}},{key:"ii",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return $T(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.ai(t).next((function(t){t||(e.isPrimary=!1,e.js.enqueueRetryable((function(){return e.ti(!1)})))}))})).next((function(){return e.hi(t)})).next((function(n){return e.isPrimary&&!n?e.li(t).next((function(){return!1})):!!n&&e.fi(t).next((function(){return!0}))}))})).catch((function(t){if(w_(t))return Tw("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Tw("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.js.enqueueRetryable((function(){return e.ti(t)})),e.isPrimary=t}))}},{key:"ai",value:function(e){var t=this;return XT(e).get("owner").next((function(e){return v_.resolve(t.di(e))}))}},{key:"_i",value:function(e){return $T(e).delete(this.clientId)}},{key:"wi",value:function(){var e=E(x().mark((function e(){var t,n,r,i,a=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.mi(this.Zs,18e5)){e.next=6;break}return this.Zs=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=mE(e,"clientMetadata");return t.K().next((function(e){var n=a.gi(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return v_.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this.si){n=T(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.si.removeItem(this.yi(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ui",value:function(){var e=this;this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ii().then((function(){return e.wi()})).then((function(){return e.ui()}))}))}},{key:"di",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"hi",value:function(e){var t=this;return this.zs?v_.resolve(!0):XT(e).get("owner").next((function(n){if(null!==n&&t.mi(n.leaseTimestampMs,5e3)&&!t.pi(n.ownerId)){if(t.di(n)&&t.networkEnabled)return!0;if(!t.di(n)){if(!n.allowTabSynchronization)throw new Ow(Rw.FAILED_PRECONDITION,YT);return!1}}return!(!t.networkEnabled||!t.inForeground)||$T(e).K().next((function(e){return void 0===t.gi(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Tw("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=E(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),e.next=7,this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new yE(e,S_.ot);return t.li(n).next((function(){return t._i(n)}))}));case 7:this.ni.close(),this.Ai();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gi",value:function(e,t){var n=this;return e.filter((function(e){return n.mi(e.updateTimeMs,t)&&!n.pi(e.clientId)}))}},{key:"Ri",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return $T(t).K().next((function(t){return e.gi(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.vs}},{key:"getMutationQueue",value:function(e,t){return cT.se(e,this.wt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new ZE(e,this.wt.ne.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return FE.se(this.wt,e)}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;Tw("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.Hs)?vE:14===i?pE:13===i?dE:12===i?fE:11===i?hE:void Aw();return this.ni.runTransaction(e,o,u,(function(i){return a=new yE(i,r.Ps?r.Ps.next():S_.ot),"readwrite-primary"===t?r.ai(a).next((function(e){return!!e||r.hi(a)})).next((function(t){if(!t)throw Sw("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.js.enqueueRetryable((function(){return r.ti(!1)})),new Ow(Rw.FAILED_PRECONDITION,h_);return n(a)})).next((function(e){return r.fi(a).next((function(){return e}))})):r.bi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"bi",value:function(e){var t=this;return XT(e).get("owner").next((function(e){if(null!==e&&t.mi(e.leaseTimestampMs,5e3)&&!t.pi(e.ownerId)&&!t.di(e)&&!(t.zs||t.allowTabSynchronization&&e.allowTabSynchronization))throw new Ow(Rw.FAILED_PRECONDITION,YT)}))}},{key:"fi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return XT(e).put("owner",t)}},{key:"li",value:function(e){var t=this,n=XT(e);return n.get("owner").next((function(e){return t.di(e)?(Tw("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v_.resolve()}))}},{key:"mi",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(Sw("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"ri",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=function(){e.js.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.ii()}))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ti",value:function(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}},{key:"oi",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=function(){t.Ii(),!ee()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&t.js.enterRestrictedMode(!0),t.js.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.Js))}},{key:"Ei",value:function(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}},{key:"pi",value:function(e){var t;try{var n=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return Tw("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Sw("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ii",value:function(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(by){Sw("Failed to set zombie client id.",by)}}},{key:"Ai",value:function(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch(by){}}},{key:"yi",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"V",value:function(){return m_.V()}}]),e}();function XT(e){return mE(e,"owner")}function $T(e){return mE(e,"clientMetadata")}function ZT(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var eS=function(){function e(t,n,r,i){S(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return N(e,null,[{key:"Vi",value:function(t,n){var r,i=Zx(),a=Zx(),o=T(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(s){o.e(s)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),tS=function(){function e(){S(this,e),this.Si=!1}return N(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next((function(a){return a||i.xi(e,t,r,n)})).next((function(n){return n||i.Ni(e,t)}))}},{key:"Ci",value:function(e,t){return v_.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Jw.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next((function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(Ew()<=Me.DEBUG&&Tw("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ex(t)),i.Mi(e,o,t,u_(r,-1)))}))}},{key:"ki",value:function(e,t){var n=new O_(rx(e));return t.forEach((function(t,r){tx(e,r)&&(n=n.add(r))})),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return Ew()<=Me.DEBUG&&Tw("QueryEngine","Using full collection scan to execute query:",ex(t)),this.Di.getDocumentsMatchingQuery(e,t,c_.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),nS=function(){function e(t,n,r,i){S(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new D_(Hw),this.Bi=new qx((function(e){return xb(e)}),Ib),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return N(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LT(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.$i)}))}}]),e}();function rS(e,t,n,r){return new nS(e,t,n,r)}function iS(e,t){return aS.apply(this,arguments)}function aS(){return aS=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],u=Zx(),s=T(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,h=T(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;u=u.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){s.e(k)}finally{s.f()}var d,p=T(n);try{for(p.s();!(d=p.n()).done;){var v=d.value;o.push(v.batchId);var y,m=T(v.mutations);try{for(m.s();!(y=m.n()).done;){var g=y.value;u=u.add(g.key)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){p.e(k)}finally{p.f()}return r.localDocuments.getDocuments(e,u).next((function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),aS.apply(this,arguments)}function oS(e,t){var n=Pw(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=v_.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);Dw(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Zx(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function uS(e){var t=Pw(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Vs.getLastRemoteSnapshotVersion(e)}))}function sS(e,t){var n=Pw(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,u)})));var c=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?c=c.withResumeToken(U_.EMPTY_BYTE_STRING,Jw.min()).withLastLimboFreeSnapshotVersion(Jw.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(u,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&o.push(n.Vs.updateTargetData(e,c))}}));var u=Wx(),s=Zx();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(cS(e,a,t.documentUpdates).next((function(e){u=e.Gi,s=e.Qi}))),!r.isEqual(Jw.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return v_.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.$i=i,e}))}function cS(e,t,n){var r=Zx(),i=Zx();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=Wx();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Jw.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Tw("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Gi:r,Qi:i}}))}function lS(e,t){var n=Pw(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function hS(e,t){var n=Pw(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Vs.getTargetData(e,t).next((function(i){return i?(r=i,v_.resolve(r)):n.Vs.allocateTargetId(e).next((function(i){return r=new _E(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e}))}function fS(e,t,n){return dS.apply(this,arguments)}function dS(){return dS=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Pw(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),w_(e.t1)){e.next=12;break}throw e.t1;case 12:Tw("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),dS.apply(this,arguments)}function pS(e,t,n){var r=Pw(e),i=Jw.min(),a=Zx();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Pw(e),i=r.Bi.get(n);return void 0!==i?v_.resolve(r.$i.get(i)):r.Vs.getTargetData(t,n)}(r,e,Jb(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:Jw.min(),n?a:Zx())})).next((function(e){return mS(r,nx(t),e),{documents:e,ji:a}}))}))}function vS(e,t){var n=Pw(e),r=Pw(n.Vs),i=n.$i.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.te(e,t).next((function(e){return e?e.target:null}))}))}function yS(e,t){var n=Pw(e),r=n.Li.get(t)||Jw.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Ui.getAllFromCollectionGroup(e,t,u_(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return mS(n,t,e),e}))}function mS(e,t,n){var r=Jw.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Li.set(t,r)}function gS(e,t,n,r){return kS.apply(this,arguments)}function kS(){return kS=E(x().mark((function e(t,n,r,i){var a,o,u,s,c,l,h,f,d,p;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Pw(t),o=Zx(),u=Wx(),s=T(r);try{for(s.s();!(c=s.n()).done;)l=c.value,h=n.Wi(l.metadata.name),l.document&&(o=o.add(h)),(f=n.zi(l)).setReadTime(n.Hi(l.metadata.readTime)),u=u.insert(h,f)}catch(v){s.e(v)}finally{s.f()}return d=a.Ui.newChangeBuffer({trackRemovals:!0}),e.next=7,hS(a,function(e){return Jb(Kb($w.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return p=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return cS(e,d,u).next((function(t){return d.apply(e),t})).next((function(t){return a.Vs.removeMatchingKeysForTargetId(e,p.targetId).next((function(){return a.Vs.addMatchingKeys(e,o,p.targetId)})).next((function(){return a.localDocuments.getLocalViewOfDocuments(e,t.Gi,t.Qi)})).next((function(){return t.Gi}))}))})));case 9:case"end":return e.stop()}}),e)}))),kS.apply(this,arguments)}function wS(e,t){return _S.apply(this,arguments)}function _S(){return _S=E(x().mark((function e(t,n){var r,i,a,o=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:Zx(),e.next=3,hS(t,Jb(AE(n.bundledQuery)));case 3:return i=e.sent,a=Pw(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=mI(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.Ds.saveNamedQuery(e,n);var o=i.withResumeToken(U_.EMPTY_BYTE_STRING,t);return a.$i=a.$i.insert(o.targetId,o),a.Vs.updateTargetData(e,o).next((function(){return a.Vs.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.Vs.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.Ds.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),_S.apply(this,arguments)}function bS(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function xS(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function IS(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var ES=function(){function e(t,n,r,i){S(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return N(e,[{key:"Yi",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Ji",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new Ow(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(Sw("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),TS=function(){function e(t,n,r){S(this,e),this.targetId=t,this.state=n,this.error=r}return N(e,[{key:"Yi",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Ji",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ow(i.error.code,i.error.message))),a?new e(t,i.state,r):(Sw("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),SS=function(){function e(t,n){S(this,e),this.clientId=t,this.activeTargetIds=n}return N(e,null,[{key:"Ji",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=tI(),o=0;i&&o<r.activeTargetIds.length;++o)i=J_(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(Sw("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),CS=function(){function e(t,n){S(this,e),this.clientId=t,this.onlineState=n}return N(e,null,[{key:"Ji",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(Sw("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),NS=function(){function e(){S(this,e),this.activeTargetIds=tI()}return N(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),AS=function(){function e(t,n,r,i,a){S(this,e),this.window=t,this.js=n,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new D_(Hw),this.started=!1,this.ir=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.rr=bS(this.persistenceKey,this.tr),this.ur=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new NS),this.cr=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.ar=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.hr=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.lr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.dr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.er)}return N(e,[{key:"start",value:function(){var e=E(x().mark((function e(){var t,n,r,i,a,o,u,s,c,l,h,f=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.Ri();case 2:t=e.sent,n=T(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.tr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(bS(this.persistenceKey,i)))&&(o=SS.Ji(i,a))&&(this.sr=this.sr.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this._r(),(u=this.storage.getItem(this.lr))&&(s=this.wr(u))&&this.mr(s),c=T(this.ir);try{for(c.s();!(l=c.n()).done;)h=l.value,this.nr(h)}catch(d){c.e(d)}finally{c.f()}this.ir=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.ur,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.gr(this.sr)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.sr.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.yr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.yr(e,t,n),this.pr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(IS(this.persistenceKey,e));if(n){var r=TS.Ji(e,n);r&&(t=r.state)}}return this.Ir.Xi(e),this._r(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ir.Zi(e),this._r()}},{key:"isLocalQueryTarget",value:function(e){return this.Ir.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(IS(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Tr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.pr(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.Er(e)}},{key:"notifyBundleLoaded",value:function(e){this.Ar(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Tw("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Tw("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Tw("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"nr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(Tw("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void Sw("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(E(x().mark((function e(){var r,i,a,o,u,s,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.cr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Rr(n.key),e.abrupt("return",t.br(r,null));case 6:if(!(i=t.Pr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.br(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.ar.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.vr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.Vr(a));case 16:e.next=41;break;case 18:if(!t.hr.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.Sr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Dr(o));case 23:e.next=41;break;case 25:if(n.key!==t.lr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.wr(n.newValue))){e.next=30;break}return e.abrupt("return",t.mr(u));case 30:e.next=41;break;case 32:if(n.key!==t.ur){e.next=37;break}s=function(e){var t=S_.ot;if(null!=e)try{var n=JSON.parse(e);Dw("number"==typeof n),t=n}catch(e){Sw("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),s!==S_.ot&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.dr){e.next=41;break}return c=t.Cr(n.newValue),e.next=41,Promise.all(c.map((function(e){return t.syncEngine.Nr(e)})));case 41:e.next=44;break;case 43:t.ir.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Ir",get:function(){return this.sr.get(this.tr)}},{key:"_r",value:function(){this.setItem(this.rr,this.Ir.Yi())}},{key:"yr",value:function(e,t,n){var r=new ES(this.currentUser,e,t,n),i=xS(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}},{key:"pr",value:function(e){var t=xS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Er",value:function(e){var t={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(t))}},{key:"Tr",value:function(e,t,n){var r=IS(this.persistenceKey,e),i=new TS(e,t,n);this.setItem(r,i.Yi())}},{key:"Ar",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}},{key:"Rr",value:function(e){var t=this.cr.exec(e);return t?t[1]:null}},{key:"Pr",value:function(e,t){var n=this.Rr(e);return SS.Ji(n,t)}},{key:"vr",value:function(e,t){var n=this.ar.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ES.Ji(new bw(i),r,t)}},{key:"Sr",value:function(e,t){var n=this.hr.exec(e),r=Number(n[1]);return TS.Ji(r,t)}},{key:"wr",value:function(e){return CS.Ji(e)}},{key:"Cr",value:function(e){return JSON.parse(e)}},{key:"Vr",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.kr(t.batchId,t.state,t.error));case 2:Tw("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Dr",value:function(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}},{key:"br",value:function(e,t){var n=this,r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),a=this.gr(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Mr(o,u).then((function(){n.sr=r}))}},{key:"mr",value:function(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"gr",value:function(e){var t=tI();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"V",value:function(e){return!(!e||!e.localStorage)}}]),e}(),DS=function(){function e(){S(this,e),this.Fr=new NS,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return N(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new NS,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),PS=function(){function e(){S(this,e)}return N(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),RS=function(){function e(){var t=this;S(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return N(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){Tw("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=T(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){Tw("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=T(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),OS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},LS=function(){function e(t){S(this,e),this.jr=t.jr,this.Wr=t.Wr}return N(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),MS=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return N(n,[{key:"co",value:function(e,t,n,r){return new Promise((function(i,a){var o=new ww;o.listenOnce(vw.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case pw.NO_ERROR:var t=o.getResponseJson();Tw("Connection","XHR received:",JSON.stringify(t)),i(t);break;case pw.TIMEOUT:Tw("Connection",'RPC "'+e+'" timed out'),a(new Ow(Rw.DEADLINE_EXCEEDED,"Request time out"));break;case pw.HTTP_ERROR:var n=o.getStatus();if(Tw("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var u=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(Rw).indexOf(t)>=0?t:Rw.UNKNOWN}(r.status);a(new Ow(u,r.message))}else a(new Ow(Rw.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Ow(Rw.UNAVAILABLE,"Connection failed."));break;default:Aw()}}finally{Tw("Connection",'RPC "'+e+'" completed.')}}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=fw(),a=dw(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new gw({})),this.uo(o.initMessageHeaders,t,n),Z()||ne()||$().indexOf("Electron/")>=0||re()||$().indexOf("MSAppHost/")>=0||te()||(o.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");Tw("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,h=new LS({jr:function(e){l?Tw("Connection","Not sending because WebChannel is closed:",e):(c||(Tw("Connection","Opening WebChannel transport."),s.open(),c=!0),Tw("Connection","WebChannel sending:",e),s.send(e))},Wr:function(){return s.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(s,kw.EventType.OPEN,(function(){l||Tw("Connection","WebChannel transport opened.")})),f(s,kw.EventType.CLOSE,(function(){l||(l=!0,Tw("Connection","WebChannel transport closed"),h.eo())})),f(s,kw.EventType.ERROR,(function(e){l||(l=!0,Cw("Connection","WebChannel transport errored:",e),h.eo(new Ow(Rw.UNAVAILABLE,"The operation could not be completed")))})),f(s,kw.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];Dw(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Tw("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Lx[e];if(void 0!==t)return jx(t)}(a),u=i.message;void 0===o&&(o=Rw.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,h.eo(new Ow(o,u)),s.close()}else Tw("Connection","WebChannel received:",n),h.no(n)}})),f(a,yw.STAT_EVENT,(function(e){e.stat===mw.PROXY?Tw("Connection","Detected buffering proxy"):e.stat===mw.NOPROXY&&Tw("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Zr()}),0),h}}]),n}(function(){function e(t){S(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.so=n+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return N(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);Tw("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then((function(e){return Tw("RestConnection","Received: ",e),e}),(function(t){throw Cw("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+xw,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"oo",value:function(e,t){var n=OS[e];return"".concat(this.so,"/v1/").concat(t,":").concat(n)}}]),e}());function FS(){return"undefined"!=typeof window?window:null}function US(){return"undefined"!=typeof document?document:null}function VS(e){return new dI(e,!0)}var BS=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;S(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return N(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&Tw("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,(function(){return t.yo=Date.now(),e()})),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),jS=function(){function e(t,n,r,i,a,o,u,s){S(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=s,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new BS(t,n)}return N(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Do(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(function(){return e.Oo()})))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Co()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(){var e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==t?this.So.reset():n&&n.code===Rw.RESOURCE_EXHAUSTED?(Sw(n.toString()),Sw("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===Rw.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Jr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=l(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)}),(function(n){t((function(){var t=new Ow(Rw.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)}))}))}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr((function(){r((function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,(function(){return n.Co()&&(n.state=3),Promise.resolve()})),n.listener.zr()}))})),this.stream.Jr((function(e){r((function(){return n.qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"qo",value:function(e){return Tw("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget((function(){return t.Po===e?n():(Tw("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),qS=function(e){P(n,e);var t=M(n);function n(e,r,i,a,o,u){var s;return S(this,n),(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,u)).wt=o,s}return N(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Aw()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.dt?(Dw(void 0===t||"string"==typeof t),U_.fromBase64String(t||"")):(Dw(void 0===t||t instanceof Uint8Array),U_.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?Rw.UNKNOWN:jx(e.code);return new Ow(t,e.message||"")}(o);n=new oI(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=_I(e,s.document.name),l=mI(s.document.updateTime),h=new gb({mapValue:{fields:s.document.fields}}),f=wb.newFoundDocument(c,l,h),d=s.targetIds||[],p=s.removedTargetIds||[];n=new iI(d,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var v=t.documentDelete;v.document;var y=_I(e,v.document),m=v.readTime?mI(v.readTime):Jw.min(),g=wb.newNoDocument(y,m),k=v.removedTargetIds||[];n=new iI([],k,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var _=_I(e,w.document),b=w.removedTargetIds||[];n=new iI([],b,_,null)}else{if(!("filter"in t))return Aw();t.filter;var x=t.filter;x.targetId;var I=x.count||0,E=new Vx(I),T=x.targetId;n=new aI(T,E)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Jw.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Jw.min():t.readTime?mI(t.readTime):Jw.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t={};t.database=II(this.wt),t.addTarget=function(e,t){var n,r=t.target;return(n=Eb(r)?{documents:DI(e,r)}:{query:PI(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=vI(e,t.resumeToken):t.snapshotVersion.compareTo(Jw.min())>0&&(n.readTime=pI(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Aw()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.wt,e);n&&(t.labels=n),this.Mo(t)}},{key:"jo",value:function(e){var t={};t.database=II(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(jS),zS=function(e){P(n,e);var t=M(n);function n(e,r,i,a,o,u){var s;return S(this,n),(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,u)).wt=o,s.Wo=!1,s}return N(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Qs(R(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(Dw(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(Dw(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?mI(e.updateTime):mI(t);return n.isEqual(Jw.min())&&(n=mI(t)),new _x(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=mI(e.commitTime);return this.listener.Jo(n,t)}return Dw(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=II(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return NI(t.wt,e)}))};this.Mo(n)}}]),n}(jS),WS=function(e){P(n,e);var t=M(n);function n(e,r,i,a){var o;return S(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return N(n,[{key:"tu",value:function(){if(this.Zo)throw new Ow(Rw.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=l(i,2),o=a[0],u=a[1];return r.bo.ro(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Rw.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Ow(Rw.UNKNOWN,e.toString())}))}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=l(a,2),u=o[0],s=o[1];return i.bo.ao(e,t,n,u,s,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Rw.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Ow(Rw.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return N((function e(){S(this,e)}))}()),KS=function(){function e(t,n){S(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return N(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()})))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(Sw(t),this.su=!1):Tw("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),HS=N((function e(t,n,r,i,a){var o=this;S(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br((function(e){r.enqueueAndForget(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=rC(o),!e.t0){e.next=5;break}return Tw("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Pw(t)).lu.add(4),e.next=4,YS(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,GS(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this._u=new KS(r,i)}));function GS(e){return QS.apply(this,arguments)}function QS(){return QS=E(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!rC(t)){e.next=18;break}n=T(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),QS.apply(this,arguments)}function YS(e){return JS.apply(this,arguments)}function JS(){return JS=E(x().mark((function e(t){var n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=T(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),JS.apply(this,arguments)}function XS(e,t){var n=Pw(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),nC(n)?tC(n):PC(n).Co()&&ZS(n,t))}function $S(e,t){var n=Pw(e),r=PC(n);n.hu.delete(t),r.Co()&&eC(n,t),0===n.hu.size&&(r.Co()?r.ko():rC(n)&&n._u.set("Unknown"))}function ZS(e,t){e.wu.Nt(t.targetId),PC(e).Qo(t)}function eC(e,t){e.wu.Nt(t),PC(e).jo(t)}function tC(e){e.wu=new sI({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),PC(e).start(),e._u.iu()}function nC(e){return rC(e)&&!PC(e).Do()&&e.hu.size>0}function rC(e){return 0===Pw(e).lu.size}function iC(e){e.wu=void 0}function aC(e){return oC.apply(this,arguments)}function oC(){return oC=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach((function(e,n){ZS(t,e)}));case 1:case"end":return e.stop()}}),e)}))),oC.apply(this,arguments)}function uC(e,t){return sC.apply(this,arguments)}function sC(){return sC=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:iC(t),nC(t)?(t._u.uu(n),tC(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),sC.apply(this,arguments)}function cC(e,t,n){return lC.apply(this,arguments)}function lC(){return lC=E(x().mark((function e(t,n,r){var i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof oI&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=T(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Tw("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,hC(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof iI?t.wu.Ut(n):n instanceof aI?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Jw.min())){e.next=29;break}return e.prev=14,e.next=17,uS(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(U_.EMPTY_BYTE_STRING,n.snapshotVersion)),eC(e,t);var r=new _E(n.target,t,1,n.sequenceNumber);ZS(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Tw("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,hC(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),lC.apply(this,arguments)}function hC(e,t,n){return fC.apply(this,arguments)}function fC(){return fC=E(x().mark((function e(t,n,r){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w_(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,YS(t);case 5:t._u.set("Offline"),r||(r=function(){return uS(t.localStore)}),t.asyncQueue.enqueueRetryable(E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Tw("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,GS(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),fC.apply(this,arguments)}function dC(e,t){return t().catch((function(n){return hC(e,n,t)}))}function pC(e){return vC.apply(this,arguments)}function vC(){return vC=E(x().mark((function e(t){var n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Pw(t),r=RC(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!yC(n)){e.next=19;break}return e.prev=3,e.next=6,lS(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,mC(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,hC(n,e.t0);case 17:e.next=2;break;case 19:gC(n)&&kC(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),vC.apply(this,arguments)}function yC(e){return rC(e)&&e.au.length<10}function mC(e,t){e.au.push(t);var n=RC(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function gC(e){return rC(e)&&!RC(e).Do()&&e.au.length>0}function kC(e){RC(e).start()}function wC(e){return _C.apply(this,arguments)}function _C(){return _C=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:RC(t).Xo();case 1:case"end":return e.stop()}}),e)}))),_C.apply(this,arguments)}function bC(e){return xC.apply(this,arguments)}function xC(){return xC=E(x().mark((function e(t){var n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=RC(t),r=T(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),xC.apply(this,arguments)}function IC(e,t,n){return EC.apply(this,arguments)}function EC(){return EC=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=kE.from(i,n,r),e.next=3,dC(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,pC(t);case 5:case"end":return e.stop()}}),e)}))),EC.apply(this,arguments)}function TC(e,t){return SC.apply(this,arguments)}function SC(){return SC=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&RC(t).zo,!e.t0){e.next=4;break}return e.next=4,function(){var e=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Bx(i=n.code)||i===Rw.ABORTED){e.next=7;break}return r=t.au.shift(),RC(t).No(),e.next=5,dC(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,pC(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:gC(t)&&kC(t);case 5:case"end":return e.stop()}}),e)}))),SC.apply(this,arguments)}function CC(e,t){return NC.apply(this,arguments)}function NC(){return NC=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Pw(t)).asyncQueue.verifyOperationInProgress(),Tw("RemoteStore","RemoteStore received new credentials"),i=rC(r),r.lu.add(3),e.next=6,YS(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,GS(r);case 12:case"end":return e.stop()}}),e)}))),NC.apply(this,arguments)}function AC(e,t){return DC.apply(this,arguments)}function DC(){return DC=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pw(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,GS(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,YS(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),DC.apply(this,arguments)}function PC(e){return e.mu||(e.mu=function(e,t,n){var r=Pw(e);return r.tu(),new qS(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:aC.bind(null,e),Jr:uC.bind(null,e),Go:cC.bind(null,e)}),e.fu.push(function(){var t=E(x().mark((function t(n){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),nC(e)?tC(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:iC(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.mu}function RC(e){return e.gu||(e.gu=function(e,t,n){var r=Pw(e);return r.tu(),new zS(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:wC.bind(null,e),Jr:TC.bind(null,e),Yo:bC.bind(null,e),Jo:IC.bind(null,e)}),e.fu.push(function(){var t=E(x().mark((function t(n){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,pC(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(Tw("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.gu}var OC=function(){function e(t,n,r,i,a){S(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Lw,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return N(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ow(Rw.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function LC(e,t){if(Sw("AsyncQueue","".concat(t,": ").concat(e)),w_(e))return new Ow(Rw.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var MC=function(){function e(t){S(this,e),this.comparator=t?function(e,n){return t(e,n)||t_.comparator(e.key,n.key)}:function(e,t){return t_.comparator(e.key,t.key)},this.keyedMap=Hx(),this.sortedSet=new D_(this.comparator)}return N(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),FC=function(){function e(){S(this,e),this.yu=new D_(t_.comparator)}return N(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):Aw():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),UC=function(){function e(t,n,r,i,a,o,u,s){S(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=s}return N(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$b(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach((function(e){a.push({type:0,doc:e})})),new e(t,n,MC.emptySet(n),a,r,i,!0,!1)}}]),e}(),VC=N((function e(){S(this,e),this.Iu=void 0,this.listeners=[]})),BC=N((function e(){S(this,e),this.queries=new qx((function(e){return Zb(e)}),$b),this.onlineState="Unknown",this.Tu=new Set}));function jC(e,t){return qC.apply(this,arguments)}function qC(){return qC=E(x().mark((function e(t,n){var r,i,a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pw(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new VC),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=LC(e.t0,"Initialization of query '".concat(ex(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&GC(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),qC.apply(this,arguments)}function zC(e,t){return WC.apply(this,arguments)}function WC(){return WC=E(x().mark((function e(t,n){var r,i,a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pw(t),i=n.query,a=!1,(o=r.queries.get(i))&&(u=o.listeners.indexOf(n))>=0&&(o.listeners.splice(u,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)}))),WC.apply(this,arguments)}function KC(e,t){var n,r=Pw(e),i=!1,a=T(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,s=r.queries.get(u);if(s){var c,l=T(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Au(o)&&(i=!0)}}catch(h){l.e(h)}finally{l.f()}s.Iu=o}}}catch(h){a.e(h)}finally{a.f()}i&&GC(r)}function HC(e,t,n){var r=Pw(e),i=r.queries.get(t);if(i){var a,o=T(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(t)}function GC(e){e.Tu.forEach((function(e){e.next()}))}var QC=function(){function e(t,n,r){S(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return N(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=T(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new UC(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Du||!n)&&(!e.docs.isEmpty()||"Offline"===t)}},{key:"vu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=UC.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),YC=function(){function e(t,n){S(this,e),this.payload=t,this.byteLength=n}return N(e,[{key:"Cu",value:function(){return"metadata"in this.payload}}]),e}(),JC=function(){function e(t){S(this,e),this.wt=t}return N(e,[{key:"Wi",value:function(e){return _I(this.wt,e)}},{key:"zi",value:function(e){return e.metadata.exists?SI(this.wt,e.document,!1):wb.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}},{key:"Hi",value:function(e){return mI(e)}}]),e}(),XC=function(){function e(t,n,r){S(this,e),this.xu=t,this.localStore=n,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=$C(t)}return N(e,[{key:"Nu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;var n=$w.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"ku",value:function(e){var t,n=new Map,r=new JC(this.wt),i=T(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,u=r.Wi(a.metadata.name),s=T(a.metadata.queries);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(n.get(c)||Zx()).add(u);n.set(c,l)}}catch(h){s.e(h)}finally{s.f()}}}}catch(h){i.e(h)}finally{i.f()}return n}},{key:"complete",value:function(){var e=E(x().mark((function e(){var t,n,r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gS(this.localStore,new JC(this.wt),this.documents,this.xu.id);case 2:t=e.sent,n=this.ku(this.documents),r=T(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,wS(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function $C(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var ZC=N((function e(t){S(this,e),this.key=t})),eN=N((function e(t){S(this,e),this.key=t})),tN=function(){function e(t,n){S(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=Zx(),this.mutatedKeys=Zx(),this.Lu=rx(t),this.Uu=new MC(this.Lu)}return N(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new FC,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=tx(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.Qu(l,h)||(r.track({type:2,doc:h}),p=!0,(s&&n.Lu(h,s)>0||c&&n.Lu(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(s||c)&&(u=!0)),p&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:u,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Aw()}};return n(e)-n(t)}(e.type,t.type)||r.Lu(e.doc,t.doc)})),this.ju(n);var o=t?this.Wu():[],u=0===this.Bu.size&&this.current?1:0,s=u!==this.$u;return this.$u=u,0!==a.length||s?{snapshot:new UC(this.query,e.Uu,i,a,e.mutatedKeys,0===u,s,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new FC,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Fu=t.Fu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Fu=t.Fu.delete(e)})),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=Zx(),this.Uu.forEach((function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))}));var n=[];return t.forEach((function(t){e.Bu.has(t)||n.push(new eN(t))})),this.Bu.forEach((function(e){t.has(e)||n.push(new ZC(e))})),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=Zx();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return UC.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),nN=N((function e(t,n,r){S(this,e),this.query=t,this.targetId=n,this.view=r})),rN=N((function e(t){S(this,e),this.key=t,this.Xu=!1})),iN=function(){function e(t,n,r,i,a,o){S(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new qx((function(e){return Zb(e)}),$b),this.ec=new Map,this.nc=new Set,this.sc=new D_(t_.comparator),this.ic=new Map,this.rc=new UT,this.oc={},this.uc=new Map,this.cc=pT.Rn(),this.onlineState="Unknown",this.ac=void 0}return N(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function aN(e,t){return oN.apply(this,arguments)}function oN(){return oN=E(x().mark((function e(t,n){var r,i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=$N(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,hS(r.localStore,Jb(n));case 8:return u=e.sent,r.isPrimaryClient&&XS(r.remoteStore,u),s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=14,uN(r,n,i,"current"===s);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)}))),oN.apply(this,arguments)}function uN(e,t,n,r){return sN.apply(this,arguments)}function sN(){return sN=E(x().mark((function e(t,n,r,i){var a,o,u,s,c,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return function(){var e=E(x().mark((function e(t,n,r,i){var a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,pS(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Ku(t,a)}));case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(CN(t,n.targetId,u.zu),u.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,pS(t.localStore,n,!0);case 3:return a=e.sent,o=new tN(n,a.ji),u=o.Ku(a.documents),s=rI.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(u,t.isPrimaryClient,s),CN(t,r,c.zu),l=new nN(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}}),e)}))),sN.apply(this,arguments)}function cN(e,t){return lN.apply(this,arguments)}function lN(){return lN=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pw(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter((function(e){return!$b(e,n)}))),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,fS(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),$S(r.remoteStore,i.targetId),TN(r,i.targetId)})).catch(d_);case 9:e.next=14;break;case 11:return TN(r,i.targetId),e.next=14,fS(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),lN.apply(this,arguments)}function hN(e,t,n){return fN.apply(this,arguments)}function fN(){return fN=E(x().mark((function e(t,n,r){var i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ZN(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Pw(e),a=Yw.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Zx());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var u=Wx(),s=Zx();return i.Ui.getEntries(e,o).next((function(e){(u=e).forEach((function(e,t){t.isValidDocument()||(s=s.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,u)})).next((function(r){n=r;var o,u=[],s=T(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=Cx(c,n.get(c.key).overlayedDocument);null!=l&&u.push(new Dx(c.key,l,kb(l.value.mapValue),bx.exists(!0)))}}catch(h){s.e(h)}finally{s.f()}return i.mutationQueue.addMutationBatch(e,a,u,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:Gx(n)}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new D_(Hw)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,DN(i,a.changes);case 9:return e.next=11,pC(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=LC(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),fN.apply(this,arguments)}function dN(e,t){return pN.apply(this,arguments)}function pN(){return pN=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.prev=1,e.next=4,sS(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.ic.get(t);n&&(Dw(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?Dw(n.Xu):e.removedDocuments.size>0&&(Dw(n.Xu),n.Xu=!1))})),e.next=8,DN(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,d_(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),pN.apply(this,arguments)}function vN(e,t,n){var r=Pw(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach((function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=Pw(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=T(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&GC(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function yN(e,t,n){return mN.apply(this,arguments)}function mN(){return mN=E(x().mark((function e(t,n,r){var i,a,o,u,s,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Pw(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return u=(u=new D_(t_.comparator)).insert(o,wb.newNoDocument(o,Jw.min())),s=Zx().add(o),c=new nI(Jw.min(),new Map,new O_(Hw),u,s),e.next=9,dN(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),AN(i),e.next=16;break;case 14:return e.next=16,fS(i.localStore,n,!1).then((function(){return TN(i,n,r)})).catch(d_);case 16:case"end":return e.stop()}}),e)}))),mN.apply(this,arguments)}function gN(e,t){return kN.apply(this,arguments)}function kN(){return kN=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),i=n.batch.batchId,e.prev=1,e.next=4,oS(r.localStore,n);case 4:return a=e.sent,EN(r,i,null),IN(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,DN(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,d_(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),kN.apply(this,arguments)}function wN(e,t,n){return _N.apply(this,arguments)}function _N(){return _N=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pw(t),e.prev=1,e.next=4,function(e,t){var n=Pw(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Dw(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,EN(i,n,r),IN(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,DN(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,d_(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),_N.apply(this,arguments)}function bN(e,t){return xN.apply(this,arguments)}function xN(){return xN=E(x().mark((function e(t,n){var r,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rC((r=Pw(t)).remoteStore)||Tw("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Pw(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.uc.get(i)||[]).push(n),r.uc.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=LC(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),xN.apply(this,arguments)}function IN(e,t){(e.uc.get(t)||[]).forEach((function(e){e.resolve()})),e.uc.delete(t)}function EN(e,t,n){var r=Pw(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function TN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=T(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach((function(t){e.rc.containsKey(t)||SN(e,t)}))}function SN(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&($S(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),AN(e))}function CN(e,t,n){var r,i=T(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof ZC?(e.rc.addReference(a.key,t),NN(e,a)):a instanceof eN?(Tw("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||SN(e,a.key)):Aw()}}catch(o){i.e(o)}finally{i.f()}}function NN(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(Tw("SyncEngine","New document in limbo: "+n),e.nc.add(r),AN(e))}function AN(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new t_($w.fromString(t)),r=e.cc.next();e.ic.set(r,new rN(n)),e.sc=e.sc.insert(n,r),XS(e.remoteStore,new _E(Jb(Kb(n.path)),r,2,S_.ot))}}function DN(e,t,n){return PN.apply(this,arguments)}function PN(){return PN=E(x().mark((function e(t,n,r){var i,a,o,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Pw(t),a=[],o=[],u=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach((function(e,t){u.push(i.hc(t,n,r).then((function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=eS.Vi(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(u);case 6:return i.Zu.Go(a),e.next=9,function(){var e=E(x().mark((function e(t,n){var r,i,a,o,u,s,c,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return v_.forEach(n,(function(t){return v_.forEach(t.Pi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return v_.forEach(t.vi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),w_(e.t0)){e.next=10;break}throw e.t0;case 10:Tw("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=T(n);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.targetId,o.fromCache||(s=r.$i.get(u),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.$i=r.$i.insert(u,l))}catch(h){i.e(h)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return e.stop()}}),e)}))),PN.apply(this,arguments)}function RN(e,t){return ON.apply(this,arguments)}function ON(){return ON=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Pw(t)).currentUser.isEqual(n)){e.next=11;break}return Tw("SyncEngine","User change. New user:",n.toKey()),e.next=5,iS(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.uc.forEach((function(e){e.forEach((function(e){e.reject(new Ow(Rw.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.uc.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,DN(r,i.Ki);case 11:case"end":return e.stop()}}),e)}))),ON.apply(this,arguments)}function LN(e,t){var n=Pw(e),r=n.ic.get(t);if(r&&r.Xu)return Zx().add(r.key);var i=Zx(),a=n.ec.get(t);if(!a)return i;var o,u=T(a);try{for(u.s();!(o=u.n()).done;){var s=o.value,c=n.tc.get(s);i=i.unionWith(c.view.qu)}}catch(l){u.e(l)}finally{u.f()}return i}function MN(e,t){return FN.apply(this,arguments)}function FN(){return FN=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.next=3,pS(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.Ju(i),e.abrupt("return",(r.isPrimaryClient&&CN(r,n.targetId,a.zu),a));case 6:case"end":return e.stop()}}),e)}))),FN.apply(this,arguments)}function UN(e,t){return VN.apply(this,arguments)}function VN(){return VN=E(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),e.abrupt("return",yS(r.localStore,n).then((function(e){return DN(r,e)})));case 2:case"end":return e.stop()}}),e)}))),VN.apply(this,arguments)}function BN(e,t,n,r){return jN.apply(this,arguments)}function jN(){return jN=E(x().mark((function e(t,n,r,i){var a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pw(t),e.next=3,function(e,t){var n=Pw(e),r=Pw(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.yn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):v_.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,pC(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(EN(a,n,i||null),IN(a,n),function(e,t){Pw(Pw(e).mutationQueue).In(t)}(a.localStore,n)):Aw();case 11:return e.next=13,DN(a,o);case 13:e.next=16;break;case 15:Tw("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),jN.apply(this,arguments)}function qN(e,t){return zN.apply(this,arguments)}function zN(){return zN=E(x().mark((function e(t,n){var r,i,a,o,u,s,c,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($N(r=Pw(t)),ZN(r),!0!==n||!0===r.ac){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,WN(r,i.toArray());case 5:return a=e.sent,r.ac=!0,e.next=9,AC(r.remoteStore,!0);case 9:o=T(a);try{for(o.s();!(u=o.n()).done;)s=u.value,XS(r.remoteStore,s)}catch(h){o.e(h)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.ac){e.next=25;break}return c=[],l=Promise.resolve(),r.ec.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then((function(){return TN(r,t),fS(r.localStore,t,!0)})),$S(r.remoteStore,t)})),e.next=19,l;case 19:return e.next=21,WN(r,c);case 21:return function(e){var t=Pw(e);t.ic.forEach((function(e,n){$S(t.remoteStore,n)})),t.rc.cs(),t.ic=new Map,t.sc=new D_(t_.comparator)}(r),r.ac=!1,e.next=25,AC(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)}))),zN.apply(this,arguments)}function WN(e,t,n){return KN.apply(this,arguments)}function KN(){return KN=E(x().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f,d,p,v,y,m;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Pw(t),a=[],o=[],u=T(n),e.prev=2,u.s();case 4:if((s=u.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(h=i.ec.get(c))||0===h.length){e.next=34;break}return e.next=11,hS(i.localStore,Jb(h[0]));case 11:l=e.sent,f=T(h),e.prev=13,f.s();case 15:if((d=f.n()).done){e.next=24;break}return p=d.value,v=i.tc.get(p),e.next=20,MN(i,v);case 20:(y=e.sent).snapshot&&o.push(y.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),f.e(e.t0);case 29:return e.prev=29,f.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,vS(i.localStore,c);case 36:return m=e.sent,e.next=39,hS(i.localStore,m);case 39:return l=e.sent,e.next=42,uN(i,HN(m),c,!1);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),u.e(e.t1);case 50:return e.prev=50,u.f(),e.finish(50);case 53:return e.abrupt("return",(i.Zu.Go(o),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),KN.apply(this,arguments)}function HN(e){return Wb(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function GN(e){var t=Pw(e);return Pw(Pw(t.localStore).persistence).Ri()}function QN(e,t,n,r){return YN.apply(this,arguments)}function YN(){return YN=E(x().mark((function e(t,n,r,i){var a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Pw(t)).ac){e.next=3;break}return e.abrupt("return",void Tw("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((o=a.ec.get(n))&&o.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,yS(a.localStore,nx(o[0]));case 10:return u=e.sent,s=nI.createSynthesizedRemoteEventForCurrentChange(n,"current"===r),e.next=14,DN(a,u,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,fS(a.localStore,n,!0);case 17:return TN(a,n,i),e.abrupt("break",20);case 19:Aw();case 20:case"end":return e.stop()}}),e)}))),YN.apply(this,arguments)}function JN(e,t,n){return XN.apply(this,arguments)}function XN(){return XN=E(x().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=$N(t)).ac){e.next=45;break}a=T(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=21;break}if(u=o.value,!i.ec.has(u)){e.next=10;break}return Tw("SyncEngine","Adding an already active target "+u),e.abrupt("continue",19);case 10:return e.next=12,vS(i.localStore,u);case 12:return s=e.sent,e.next=15,hS(i.localStore,s);case 15:return c=e.sent,e.next=18,uN(i,HN(s),c.targetId,!1);case 18:XS(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=T(r),e.prev=30,f=x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=i.ec.has(t),!e.t0){e.next=5;break}return e.next=5,fS(i.localStore,t,!1).then((function(){$S(i.remoteStore,t),TN(i,t)})).catch(d_);case 5:case"end":return e.stop()}}),e)})),l.s();case 33:if((h=l.n()).done){e.next=37;break}return e.delegateYield(f(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])}))),XN.apply(this,arguments)}function $N(e){var t=Pw(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=dN.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=LN.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=yN.bind(null,t),t.Zu.Go=KC.bind(null,t.eventManager),t.Zu.lc=HC.bind(null,t.eventManager),t}function ZN(e){var t=Pw(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gN.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=wN.bind(null,t),t}function eA(e,t,n){var r=Pw(e);(function(){var e=E(x().mark((function e(t,n,r){var i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=Pw(e),r=mI(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ds.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress($C(i)),a=new XC(i,t.localStore,n.wt),e.next=15,n.fc();case 15:o=e.sent;case 16:if(!o){e.next=26;break}return e.next=19,a.Nu(o);case 19:return(u=e.sent)&&r._updateProgress(u),e.next=23,n.fc();case 23:o=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,DN(t,s.Mu,void 0);case 31:return e.next=33,function(e,t){var n=Pw(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ds.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.Ou));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Cw("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var tA=function(){function e(){S(this,e),this.synchronizeTabs=!1}return N(e,[{key:"initialize",value:function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.wt=VS(t.databaseInfo.databaseId),this.sharedClientState=this.dc(t),this.persistence=this._c(t),e.next=5,this.persistence.start();case 5:this.localStore=this.wc(t),this.gcScheduler=this.mc(t,this.localStore),this.indexBackfillerScheduler=this.gc(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return rS(this.persistence,new tS,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new WT(HT.Ms,this.wt)}},{key:"dc",value:function(e){return new DS}},{key:"terminate",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),nA=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).yc=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return N(n,[{key:"initialize",value:function(){var e=E(x().mark((function e(t){var r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(R(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.yc.initialize(this,t);case 4:return e.next=6,ZN(this.yc.syncEngine);case 6:return e.next=8,pC(this.yc.remoteStore);case 8:return e.next=10,this.persistence.ci((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"wc",value:function(e){return rS(this.persistence,new tS,e.initialUser,this.wt)}},{key:"mc",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new _T(n,e.asyncQueue,t)}},{key:"gc",value:function(e,t){var n=new T_(t,this.persistence);return new E_(e.asyncQueue,n)}},{key:"_c",value:function(e){var t=ZT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?oT.withCacheSize(this.cacheSizeBytes):oT.DEFAULT;return new JT(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,FS(),US(),this.wt,this.sharedClientState,!!this.forceOwnership)}},{key:"dc",value:function(e){return new DS}}]),n}(tA),rA=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,r,!1)).yc=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return N(n,[{key:"initialize",value:function(){var e=E(x().mark((function e(t){var r,i=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(R(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.yc.syncEngine,e.t0=this.sharedClientState instanceof AS,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={kr:BN.bind(null,r),Or:QN.bind(null,r),Mr:JN.bind(null,r),Ri:GN.bind(null,r),Nr:UN.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.ci(function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qN(i.yc.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"dc",value:function(e){var t=FS();if(!AS.V(t))throw new Ow(Rw.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ZT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new AS(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(nA),iA=function(){function e(){S(this,e)}return N(e,[{key:"initialize",value:function(){var e=E(x().mark((function e(t,n){var r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return vN(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=RN.bind(null,this.syncEngine),e.next=12,AC(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new BC}},{key:"createDatastore",value:function(e){var t,n=VS(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new MS(t));return function(e,t,n,r){return new WS(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return vN(o.syncEngine,e,0)},a=RS.V()?new RS:new PS,new HS(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new iN(e,t,n,r,i,a);return o&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Pw(t),Tw("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,YS(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function aA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return E(x().mark((function r(){var i;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var oA=function(){function e(t){S(this,e),this.observer=t,this.muted=!1}return N(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),uA=function(){function e(t,n){var r=this;S(this,e),this.Ec=t,this.wt=n,this.metadata=new Lw,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then((function(e){e&&e.Cu()?r.metadata.resolve(e.payload.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.payload))))}),(function(e){return r.metadata.reject(e)}))}return N(e,[{key:"close",value:function(){return this.Ec.cancel()}},{key:"getMetadata",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fc",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Rc());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Rc",value:function(){var e=E(x().mark((function e(){var t,n,r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.Ac.decode(t),r=Number(n),isNaN(r)&&this.Pc("length string (".concat(n,") is not valid number")),e.next=9,this.vc(r);case 9:return i=e.sent,e.abrupt("return",new YC(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Vc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"bc",value:function(){var e=E(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Vc()<0)){e.next=7;break}return e.next=3,this.Sc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Vc())<0&&this.Pc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"vc",value:function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Sc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Pc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.Ac.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Pc",value:function(e){throw this.Ec.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Sc",value:function(){var e=E(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Ec.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),sA=function(){function e(t){S(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return N(e,[{key:"lookup",value:function(){var e=E(x().mark((function e(t){var n,r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new Ow(Rw.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=E(x().mark((function e(t,n){var r,i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),i=II(r.wt)+"/documents",a={documents:n.map((function(e){return wI(r.wt,e)}))},e.next=5,r.ao("BatchGetDocuments",i,a,n.length);case 5:return o=e.sent,u=new Map,o.forEach((function(e){var t=CI(r.wt,e);u.set(t.key.toString(),t)})),s=[],e.abrupt("return",(n.forEach((function(e){var t=u.get(e.toString());Dw(!!t),s.push(t)})),s));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new Fx(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=E(x().mark((function e(){var t,n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=t_.fromPath(t);n.mutations.push(new Ux(r,n.precondition(r)))})),e.next=7,function(){var e=E(x().mark((function e(t,n){var r,i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pw(t),i=II(r.wt)+"/documents",a={writes:n.map((function(e){return NI(r.wt,e)}))},e.next=3,r.ro("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Aw();t=Jw.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Ow(Rw.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?bx.updateTime(t):bx.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Jw.min()))throw new Ow(Rw.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bx.updateTime(t)}return bx.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),cA=function(){function e(t,n,r,i,a){S(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.Dc=r.maxAttempts,this.So=new BS(this.asyncQueue,"transaction_retry")}return N(e,[{key:"run",value:function(){this.Dc-=1,this.Cc()}},{key:"Cc",value:function(){var e=this;this.So.Io(E(x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new sA(e.datastore),(r=e.xc(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Nc(t)}))}))})).catch((function(t){e.Nc(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"xc",value:function(e){try{var t=this.updateFunction(e);return!Q_(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Nc",value:function(e){var t=this;this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget((function(){return t.Cc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"kc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!Bx(t)}return!1}}]),e}(),lA=function(){function e(t,n,r,i){var a=this;S(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=bw.UNAUTHENTICATED,this.clientId=Kw.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Tw("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Tw("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return N(e,[{key:"getConfiguration",value:function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Ow(Rw.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Lw;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(E(x().mark((function n(){var r;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=LC(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function hA(e,t){return fA.apply(this,arguments)}function fA(){return fA=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Tw("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,iS(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),fA.apply(this,arguments)}function dA(e,t){return pA.apply(this,arguments)}function pA(){return pA=E(x().mark((function e(t,n){var r,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,vA(t);case 3:return r=e.sent,Tw("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return CC(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return CC(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),pA.apply(this,arguments)}function vA(e){return yA.apply(this,arguments)}function yA(){return yA=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Tw("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,hA(t,new tA);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),yA.apply(this,arguments)}function mA(e){return gA.apply(this,arguments)}function gA(){return gA=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Tw("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,dA(t,new iA);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),gA.apply(this,arguments)}function kA(e){return vA(e).then((function(e){return e.persistence}))}function wA(e){return vA(e).then((function(e){return e.localStore}))}function _A(e){return mA(e).then((function(e){return e.remoteStore}))}function bA(e){return mA(e).then((function(e){return e.syncEngine}))}function xA(e){return IA.apply(this,arguments)}function IA(){return IA=E(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mA(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=aN.bind(null,n.syncEngine),r.onUnlisten=cN.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),IA.apply(this,arguments)}function EA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function i(){return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new oA({next:function(a){t.enqueueAndForget((function(){return zC(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new Ow(Rw.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new Ow(Rw.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new QC(Kb(n.path),a,{includeMetadataChanges:!0,Du:!0});return jC(e,o)},i.next=3,xA(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function TA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function i(){return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new oA({next:function(n){t.enqueueAndForget((function(){return zC(e,o)})),n.fromCache&&"server"===r.source?i.reject(new Ow(Rw.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new QC(n,a,{includeMetadataChanges:!0,Du:!0});return jC(e,o)},i.next=3,xA(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}var SA=new Map;function CA(e,t,n){if(!n)throw new Ow(Rw.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function NA(e,t,n,r){if(!0===t&&!0===r)throw new Ow(Rw.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function AA(e){if(!t_.isDocumentKey(e))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function DA(e){if(t_.isDocumentKey(e))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function PA(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Aw()}function RA(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ow(Rw.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=PA(e);throw new Ow(Rw.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function OA(e,t){if(t<=0)throw new Ow(Rw.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var LA=function(){function e(t){var n;if(S(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Ow(Rw.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ow(Rw.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,NA("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return N(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),MA=function(){function e(t,n,r){S(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LA({}),this._settingsFrozen=!1,t instanceof G_?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ow(Rw.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new G_(e.options.projectId)}(t))}return N(e,[{key:"app",get:function(){if(!this._app)throw new Ow(Rw.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Ow(Rw.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LA(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Fw;switch(e.type){case"gapi":var t=e.client;return Dw(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new jw(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Ow(Rw.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=SA.get(e);t&&(Tw("ComponentProvider","Removing Datastore"),SA.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function FA(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=RA(e,MA))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Cw("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=bw.MOCK_USER;else{o=X(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new Ow(Rw.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new bw(s)}e._authCredentials=new Uw(new Mw(o,u))}}var UA=function(){function e(t,n,r){S(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return N(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new BA(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),VA=function(){function e(t,n,r){S(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return N(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),BA=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this,e,r,Kb(i)))._path=i,a.type="collection",a}return N(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new UA(this.firestore,null,new t_(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(VA);function jA(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=De(e),CA("collection","path",t),e instanceof MA){var a=$w.fromString.apply($w,[t].concat(r));return DA(a),new BA(e,null,a)}if(!(e instanceof UA||e instanceof BA))throw new Ow(Rw.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child($w.fromString.apply($w,[t].concat(r)));return DA(o),new BA(e.firestore,null,o)}function qA(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=De(e),1===arguments.length&&(t=Kw.I()),CA("doc","path",t),e instanceof MA){var a=$w.fromString.apply($w,[t].concat(r));return AA(a),new UA(e,null,new t_(a))}if(!(e instanceof UA||e instanceof BA))throw new Ow(Rw.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child($w.fromString.apply($w,[t].concat(r)));return AA(o),new UA(e.firestore,e instanceof BA?e.converter:null,new t_(o))}function zA(e,t){return e=De(e),t=De(t),(e instanceof UA||e instanceof BA)&&(t instanceof UA||t instanceof BA)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function WA(e,t){return e=De(e),t=De(t),e instanceof VA&&t instanceof VA&&e.firestore===t.firestore&&$b(e._query,t._query)&&e.converter===t.converter}var KA=function(){function e(){var t=this;S(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new BS(this,"async_queue_retry"),this.Kc=function(){var e=US();e&&Tw("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=US();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return N(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=US();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise((function(){}));var n=new Lw;return this.Qc((function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Mc.push(e),t.jc()}))}},{key:"jc",value:function(){var e=E(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Mc.length){e.next=14;break}return e.prev=1,e.next=4,this.Mc[0]();case 4:this.Mc.shift(),this.So.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),w_(e.t0)){e.next=12;break}throw e.t0;case 12:Tw("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Mc.length>0&&this.So.Io((function(){return t.jc()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Qc",value:function(e){var t=this,n=this.Oc.then((function(){return t.Lc=!0,e().catch((function(e){t.Bc=e,t.Lc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Sw("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Lc=!1,e}))}));return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=OC.createAndSchedule(this,e,t,n,(function(e){return r.Wc(e)}));return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&Aw()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Oc,e.next=3,t;case 3:if(t!==this.Oc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Hc",value:function(e){var t,n=T(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then((function(){t.$c.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=T(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()}))}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function HA(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=T(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var GA=function(){function e(){S(this,e),this._progressObserver={},this._taskCompletionResolver=new Lw,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return N(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),QA=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new KA,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return N(n,[{key:"_terminate",value:function(){return this._firestoreClient||JA(this),this._firestoreClient.terminate()}}]),n}(MA);function YA(e){return e._firestoreClient||JA(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function JA(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new H_(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new lA(e._authCredentials,e._appCheckCredentials,e._queue,r)}function XA(e,t,n){var r=new Lw;return e.asyncQueue.enqueue(E(x().mark((function i(){var a;return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,hA(e,n);case 3:return i.next=5,dA(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===Rw.FAILED_PRECONDITION||e.code===Rw.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(a=i.t0)){i.next=13;break}throw a;case 13:console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a);case 14:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function $A(e){return function(e){return e.asyncQueue.enqueue(E(x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,kA(e);case 2:return n=t.sent,t.next=5,_A(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Pw(e);return t.lu.delete(0),GS(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(YA(e=RA(e,QA)))}function ZA(e){return function(e){return e.asyncQueue.enqueue(E(x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,kA(e);case 2:return n=t.sent,t.next=5,_A(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Pw(t)).lu.add(0),e.next=4,YS(n);case 4:n._u.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(YA(e=RA(e,QA)))}function eD(e,t){var n=YA(e=RA(e,QA)),r=new GA;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new uA(e,t)}(function(e,t){if(e instanceof Uint8Array)return aA(e,t);if(e instanceof ArrayBuffer)return aA(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,VS(t));e.asyncQueue.enqueueAndForget(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=eA,t.next=3,bA(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function tD(e,t){return function(e,t){return e.asyncQueue.enqueue(E(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Pw(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ds.getNamedQuery(e,t)}))},n.next=3,wA(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(YA(e=RA(e,QA)),t).then((function(t){return t?new VA(e,null,t.query):null}))}function nD(e){if(e._initialized||e._terminated)throw new Ow(Rw.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var rD=function(){function e(){S(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new e_(n)}return N(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var iD=function(){function e(t){S(this,e),this._byteString=t}return N(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(U_.fromBase64String(t))}catch(t){throw new Ow(Rw.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(U_.fromUint8Array(t))}}]),e}(),aD=N((function e(t){S(this,e),this._methodName=t})),oD=function(){function e(t,n){if(S(this,e),!isFinite(t)||t<-90||t>90)throw new Ow(Rw.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Ow(Rw.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return N(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Hw(this._lat,e._lat)||Hw(this._long,e._long)}}]),e}(),uD=/^__.*__$/,sD=function(){function e(t,n,r){S(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return N(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Dx(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ax(e,this.data,t,this.fieldTransforms)}}]),e}(),cD=function(){function e(t,n,r){S(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return N(e,[{key:"toMutation",value:function(e,t){return new Dx(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function lD(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Aw()}}var hD=function(){function e(t,n,r,i,a,o){S(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return N(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return DD(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(lD(this.Zc)&&uD.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),fD=function(){function e(t,n,r){S(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||VS(t)}return N(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new hD({Zc:e,methodName:t,ca:n,path:e_.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function dD(e){var t=e._freezeSettings(),n=VS(e._databaseId);return new fD(e._databaseId,!!t.ignoreUndefinedProperties,n)}function pD(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);SD("Data must be an object, but it was:",o,r);var u,s,c=ED(r,o);if(a.merge)u=new F_(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=T(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,p=CD(t,d,n);if(!o.contains(p))throw new Ow(Rw.INVALID_ARGUMENT,"Field '".concat(p,"' is specified in your field mask but missing from your input data."));PD(h,p)||h.push(p)}}catch(v){f.e(v)}finally{f.f()}u=new F_(h),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new sD(new gb(c),u,s)}var vD=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw 1===e.Zc?e.oa("".concat(this._methodName,"() can only appear at the top level of your update data")):e.oa("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(aD);function yD(e,t,n){return new hD({Zc:3,ca:t.settings.ca,methodName:e._methodName,na:n},t.databaseId,t.wt,t.ignoreUndefinedProperties)}var mD=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"_toFieldTransform",value:function(e){return new wx(e.path,new fx)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(aD),gD=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e)).ha=r,i}return N(n,[{key:"_toFieldTransform",value:function(e){var t=yD(this,e,!0),n=this.ha.map((function(e){return ID(e,t)})),r=new dx(n);return new wx(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(aD),kD=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e)).ha=r,i}return N(n,[{key:"_toFieldTransform",value:function(e){var t=yD(this,e,!0),n=this.ha.map((function(e){return ID(e,t)})),r=new vx(n);return new wx(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(aD),wD=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e)).la=r,i}return N(n,[{key:"_toFieldTransform",value:function(e){var t=new mx(e.wt,ux(e.wt,this.la));return new wx(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(aD);function _D(e,t,n,r){var i=e.aa(1,t,n);SD("Data must be an object, but it was:",i,r);var a=[],o=gb.empty();N_(r,(function(e,r){var u=AD(t,e,n);r=De(r);var s=i.ia(u);if(r instanceof vD)a.push(u);else{var c=ID(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new F_(a);return new cD(o,u,i.fieldTransforms)}function bD(e,t,n,r,i,a){var o=e.aa(1,t,n),u=[CD(t,r,n)],s=[i];if(a.length%2!=0)throw new Ow(Rw.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(CD(t,a[c])),s.push(a[c+1]);for(var l=[],h=gb.empty(),f=u.length-1;f>=0;--f)if(!PD(l,u[f])){var d=u[f],p=s[f];p=De(p);var v=o.ia(d);if(p instanceof vD)l.push(d);else{var y=ID(p,v);null!=y&&(l.push(d),h.set(d,y))}}var m=new F_(l);return new cD(h,m,o.fieldTransforms)}function xD(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ID(n,e.aa(r?4:3,t))}function ID(e,t){if(TD(e=De(e)))return SD("Unsupported field value:",t,e),ED(e,t);if(e instanceof aD)return function(e,t){if(!lD(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=T(e);try{for(a.s();!(n=a.n()).done;){var o=ID(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=De(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ux(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Yw.fromDate(e);return{timestampValue:pI(t.wt,n)}}if(e instanceof Yw){var r=new Yw(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:pI(t.wt,r)}}if(e instanceof oD)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof iD)return{bytesValue:vI(t.wt,e._byteString)};if(e instanceof UA){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:gI(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(PA(e)))}(e,t)}function ED(e,t){var n={};return A_(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):N_(e,(function(e,r){var i=ID(r,t.ea(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function TD(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Yw||e instanceof oD||e instanceof iD||e instanceof UA||e instanceof aD)}function SD(e,t,n){if(!TD(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=PA(n);throw"an object"===r?t.oa(e+" a custom object"):t.oa(e+" "+r)}}function CD(e,t,n){if((t=De(t))instanceof rD)return t._internalPath;if("string"==typeof t)return AD(e,t);throw DD("Field path arguments must be of type string or ",e,!1,void 0,n)}var ND=new RegExp("[~\\*/\\[\\]]");function AD(e,t,n){if(t.search(ND)>=0)throw DD("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return F(rD,u(t.split(".")))._internalPath}catch(r){throw DD("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function DD(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new Ow(Rw.INVALID_ARGUMENT,u+e+s)}function PD(e,t){return e.some((function(e){return e.isEqual(t)}))}var RD=function(){function e(t,n,r,i,a){S(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return N(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new UA(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new OD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(LD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),OD=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"data",value:function(){return Qs(R(n.prototype),"data",this).call(this)}}]),n}(RD);function LD(e,t){return"string"==typeof t?AD(e,t):t instanceof rD?t._internalPath:t._delegate._internalPath}var MD=function(){function e(t,n){S(this,e),this.hasPendingWrites=t,this.fromCache=n}return N(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),FD=function(e){P(n,e);var t=M(n);function n(e,r,i,a,o,u){var s;return S(this,n),(s=t.call(this,e,r,i,a,u))._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return N(n,[{key:"exists",value:function(){return Qs(R(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new UD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(LD("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(RD),UD=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qs(R(n.prototype),"data",this).call(this,e)}}]),n}(FD),VD=function(){function e(t,n,r,i){S(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new MD(i.hasPendingWrites,i.fromCache),this.query=r}return N(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new UD(n._firestore,n._userDataWriter,r.key,r,new MD(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ow(Rw.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){return{type:"added",doc:new UD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new MD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new UD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new MD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:BD(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function BD(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Aw()}}function jD(e,t){return e instanceof FD&&t instanceof FD?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof VD&&t instanceof VD&&e._firestore===t._firestore&&WA(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function qD(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ow(Rw.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zD=N((function e(){S(this,e)}));function WD(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e}var KD=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return N(n,[{key:"_apply",value:function(e){var t=dD(e.firestore),n=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){nP(o,a);var s,c=[],l=T(o);try{for(l.s();!(s=l.n()).done;){var h=s.value;c.push(tP(r,e,h))}}catch(d){l.e(d)}finally{l.f()}u={arrayValue:{values:c}}}else u=tP(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||nP(o,a),u=xD(n,"where",o,"in"===a||"not-in"===a);var f=Nb.create(i,a,u);return function(e,t){if(t.ht()){var n=Gb(e);if(null!==n&&!n.isEqual(t.field))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=Hb(e);null!==r&&rP(e,t.field,r)}var i=function(e,t){var n,r=T(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new VA(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new zb(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}]),n}(zD);var HD=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return N(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Vb(t,n);return function(e,t){if(null===Hb(e)){var n=Gb(e);null!==n&&rP(e,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new VA(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new zb(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}]),n}(zD);var GD=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return N(n,[{key:"_apply",value:function(e){return new VA(e.firestore,e.converter,Xb(e._query,this.ma,this.ga))}}]),n}(zD);var QD=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).type=e,a.ya=r,a.pa=i,a}return N(n,[{key:"_apply",value:function(e){var t=eP(e,this.type,this.ya,this.pa);return new VA(e.firestore,e.converter,function(e,t){return new zb(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}]),n}(zD);function YD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new QD("startAt",t,!0)}function JD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new QD("startAfter",t,!1)}var XD=function(e){P(n,e);var t=M(n);function n(e,r,i){var a;return S(this,n),(a=t.call(this)).type=e,a.ya=r,a.pa=i,a}return N(n,[{key:"_apply",value:function(e){var t=eP(e,this.type,this.ya,this.pa);return new VA(e.firestore,e.converter,function(e,t){return new zb(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}]),n}(zD);function $D(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new XD("endBefore",t,!1)}function ZD(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new XD("endAt",t,!0)}function eP(e,t,n,r){if(n[0]=De(n[0]),n[0]instanceof RD)return function(e,t,n,r,i){if(!r)throw new Ow(Rw.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],u=T(Yb(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s.field.isKeyField())o.push(ob(t,r.key));else{var c=r.data.field(s.field);if(z_(c))throw new Ow(Rw.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(h){u.e(h)}finally{u.f()}return new Ub(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=dD(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new Ow(Rw.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!Qb(e)&&-1!==c.indexOf("/"))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child($w.fromString(c));if(!t_.isDocumentKey(l))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var h=new t_(l);u.push(ob(t,h))}else{var f=xD(n,r,c);u.push(f)}}return new Ub(u,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function tP(e,t,n){if("string"==typeof(n=De(n))){if(""===n)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qb(t)&&-1!==n.indexOf("/"))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child($w.fromString(n));if(!t_.isDocumentKey(r))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return ob(e,new t_(r))}if(n instanceof UA)return ob(e,n._key);throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(PA(n),"."))}function nP(e,t){if(!Array.isArray(e)||0===e.length)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function rP(e,t,n){if(!n.isEqual(t))throw new Ow(Rw.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var iP={maxAttempts:5},aP=function(){function e(){S(this,e)}return N(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Z_(e)){case 0:return null;case 1:return e.booleanValue;case 2:return j_(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(q_(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Aw()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return N_(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new oD(j_(e.latitude),j_(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=W_(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(K_(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=B_(e);return new Yw(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=$w.fromString(e);Dw(qI(n));var r=new G_(n.get(1),n.get(3)),i=new t_(n.popFirst(5));return r.isEqual(t)||Sw("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function oP(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var uP=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).firestore=e,r}return N(n,[{key:"convertBytes",value:function(e){return new iD(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new UA(this.firestore,null,t)}}]),n}(aP),sP=function(){function e(t,n){S(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=dD(t)}return N(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=cP(e,this._firestore),i=oP(r.converter,t,n),a=pD(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,bx.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=cP(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=De(t))||t instanceof rD?bD(this._dataReader,"WriteBatch.update",i._key,t,n,o):_D(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,bx.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=cP(e,this._firestore);return this._mutations=this._mutations.concat(new Fx(t._key,bx.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new Ow(Rw.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function cP(e,t){if((e=De(e)).firestore!==t)throw new Ow(Rw.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var lP=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).firestore=e,r}return N(n,[{key:"convertBytes",value:function(e){return new iD(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new UA(this.firestore,null,t)}}]),n}(aP);function hP(e){e=RA(e,UA);var t=RA(e.firestore,QA),n=YA(t),r=new lP(t);return function(e,t){var n=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function r(){return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=E(x().mark((function e(t,n,r){var i,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Pw(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new Ow(Rw.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=LC(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,wA(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new FD(t,r,e._key,n,new MD(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function fP(e){e=RA(e,VA);var t=RA(e.firestore,QA),n=YA(t),r=new lP(t);return function(e,t){var n=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function r(){return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=E(x().mark((function e(t,n,r){var i,a,o,u,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pS(t,n,!0);case 3:i=e.sent,a=new tN(n,i.ji),o=a.Ku(i.documents),u=a.applyChanges(o,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=LC(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,wA(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new VD(t,r,e,n)}))}function dP(e,t,n){e=RA(e,UA);var r=RA(e.firestore,QA),i=oP(e.converter,t,n);return mP(r,[pD(dD(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,bx.none())])}function pP(e,t,n){e=RA(e,UA);for(var r=RA(e.firestore,QA),i=dD(r),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return mP(r,[("string"==typeof(t=De(t))||t instanceof rD?bD(i,"updateDoc",e._key,t,n,o):_D(i,"updateDoc",e._key,t)).toMutation(e._key,bx.exists(!0))])}function vP(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=De(e);var u={includeMetadataChanges:!1},s=0;"object"!=typeof n[s]||HA(n[s])||(u=n[s],s++);var c,l,h,f={includeMetadataChanges:u.includeMetadataChanges};if(HA(n[s])){var d=n[s];n[s]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[s+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[s+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof UA)l=RA(e.firestore,QA),h=Kb(e._key.path),c={next:function(t){n[s]&&n[s](gP(l,e,t))},error:n[s+1],complete:n[s+2]};else{var p=RA(e,VA);l=RA(p.firestore,QA),h=p._query;var v=new lP(l);c={next:function(e){n[s]&&n[s](new VD(l,v,p,e))},error:n[s+1],complete:n[s+2]},qD(e._query)}return function(e,t,n,r){var i=new oA(r),a=new QC(t,i,n);return e.asyncQueue.enqueueAndForget(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=jC,t.next=3,xA(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=zC,t.next=3,xA(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(YA(l),h,f,c)}function yP(e,t){return function(e,t){var n=new oA(t);return e.asyncQueue.enqueueAndForget(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Pw(e).Tu.add(t),t.next()},t.next=3,xA(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.Tc(),e.asyncQueue.enqueueAndForget(E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Pw(e).Tu.delete(t)},t.next=3,xA(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(YA(e=RA(e,QA)),HA(t)?t:{next:t})}function mP(e,t){return function(e,t){var n=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function r(){return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=hN,r.next=3,bA(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(YA(e),t)}function gP(e,t,n){var r=n.docs.get(t._key),i=new lP(e);return new FD(e,i,t._key,r,new MD(n.hasPendingWrites,n.fromCache),t.converter)}var kP=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,r))._firestore=e,i}return N(n,[{key:"get",value:function(e){var t=this,r=cP(e,this._firestore),i=new lP(this._firestore);return Qs(R(n.prototype),"get",this).call(this,e).then((function(e){return new FD(t._firestore,i,r._key,e._document,new MD(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){S(this,e),this._firestore=t,this._transaction=n,this._dataReader=dD(t)}return N(e,[{key:"get",value:function(e){var t=this,n=cP(e,this._firestore),r=new uP(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Aw();var i=e[0];if(i.isFoundDocument())return new RD(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new RD(t._firestore,r,n._key,null,n.converter);throw Aw()}))}},{key:"set",value:function(e,t,n){var r=cP(e,this._firestore),i=oP(r.converter,t,n),a=pD(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=cP(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=De(t))||t instanceof rD?bD(this._dataReader,"Transaction.update",i._key,t,n,o):_D(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=cP(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function wP(e,t,n){e=RA(e,QA);var r=Object.assign(Object.assign({},iP),n);return function(e){if(e.maxAttempts<1)throw new Ow(Rw.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){var r=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function i(){var a;return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,function(e){return mA(e).then((function(e){return e.datastore}))}(e);case 2:a=i.sent,new cA(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}}),i)})))),r.promise}(YA(e),(function(n){return t(new kP(e,n))}),r)}function _P(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new gD("arrayUnion",t)}function bP(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new kD("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){xw=e}(Et),gt(new Pe("firestore",(function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new QA(i,new Vw(e.getProvider("auth-internal")),new zw(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a}),"PUBLIC")),Dt(_w,"3.4.11",e),Dt(_w,"3.4.11","esm2017")}();function xP(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Ow("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function IP(){if("undefined"===typeof Uint8Array)throw new Ow("unimplemented","Uint8Arrays are not available in this environment.")}function EP(){if("undefined"==typeof atob)throw new Ow("unimplemented","Blobs are unavailable in Firestore in this environment.")}var TP=function(){function e(t){S(this,e),this._delegate=t}return N(e,[{key:"toBase64",value:function(){return EP(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return IP(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return EP(),new e(iD.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return IP(),new e(iD.fromUint8Array(t))}}]),e}();function SP(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=T(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var CP=function(){function e(){S(this,e)}return N(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){nD(e=RA(e,QA));var n=YA(e),r=e._freezeSettings(),i=new iA;return XA(n,i,new nA(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){nD(e=RA(e,QA));var t=YA(e),n=e._freezeSettings(),r=new iA;return XA(t,r,new rA(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new Ow(Rw.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new Lw;return e._queue.enqueueAndForgetEvenWhileRestricted(E(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m_.V()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,m_.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(ZT(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),NP=function(){function e(t,n,r){var i=this;S(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof G_||(this._appCompat=t)}return N(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Cw("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};FA(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return $A(this._delegate)}},{key:"disableNetwork",value:function(){return ZA(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&NA("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){return function(e){var t=new Lw;return e.asyncQueue.enqueueAndForget(E(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=bN,n.next=3,bA(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(YA(e=RA(e,QA)))}(this._delegate)}},{key:"onSnapshotsInSync",value:function(e){return yP(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new Ow("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new zP(this,jA(this._delegate,e))}catch(t){throw LP(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new OP(this,qA(this._delegate,e))}catch(t){throw LP(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new BP(this,function(e,t){if(e=RA(e,MA),CA("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Ow(Rw.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new VA(e,null,function(e){return new zb($w.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw LP(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return wP(this._delegate,(function(n){return e(new DP(t,n))}))}},{key:"batch",value:function(){var e=this;return YA(this._delegate),new PP(new sP(this._delegate,(function(t){return mP(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return eD(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return tD(this._delegate,e).then((function(e){return e?new BP(t,e):null}))}}]),e}(),AP=function(e){P(n,e);var t=M(n);function n(e){var r;return S(this,n),(r=t.call(this)).firestore=e,r}return N(n,[{key:"convertBytes",value:function(e){return new TP(new iD(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return OP.forKey(t,this.firestore,null)}}]),n}(aP);var DP=function(){function e(t,n){S(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new AP(t)}return N(e,[{key:"get",value:function(e){var t=this,n=WP(e);return this._delegate.get(n).then((function(e){return new UP(t._firestore,new FD(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=WP(e);return n?(xP("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=WP(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=WP(e);return this._delegate.delete(t),this}}]),e}(),PP=function(){function e(t){S(this,e),this._delegate=t}return N(e,[{key:"set",value:function(e,t,n){var r=WP(e);return n?(xP("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=WP(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=WP(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),RP=function(){function e(t,n,r){S(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return N(e,[{key:"fromFirestore",value:function(e,t){var n=new UD(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new VP(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new AP(t),n),i.set(n,a)),a}}]),e}();RP.INSTANCES=new WeakMap;var OP=function(){function e(t,n){S(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new AP(t)}return N(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new zP(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new zP(this.firestore,jA(this._delegate,e))}catch(t){throw LP(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=De(e))instanceof UA&&zA(this._delegate,e)}},{key:"set",value:function(e,t){t=xP("DocumentReference.set",t);try{return t?dP(this._delegate,e,t):dP(this._delegate,e)}catch(n){throw LP(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?pP(this._delegate,e):pP.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw LP(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return function(e){return mP(RA(e.firestore,QA),[new Fx(e._key,bx.none())])}(this._delegate)}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=MP(n),a=FP(n,(function(t){return new UP(e.firestore,new FD(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return vP(this._delegate,i,a)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?hP(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=RA(e,UA);var t=RA(e.firestore,QA);return EA(YA(t),e._key,{source:"server"}).then((function(n){return gP(t,e,n)}))}(this._delegate):function(e){e=RA(e,UA);var t=RA(e.firestore,QA);return EA(YA(t),e._key).then((function(n){return gP(t,e,n)}))}(this._delegate),t.then((function(e){return new UP(n.firestore,new FD(n.firestore._delegate,n._userDataWriter,e._key,e._document,e.metadata,n._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(RP.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new Ow("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new UA(n._delegate,r,new t_(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new UA(n._delegate,r,t))}}]),e}();function LP(e,t,n){return e.message=e.message.replace(t,n),e}function MP(e){var t,n=T(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!SP(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function FP(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=SP(e[0])?e[0]:SP(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var UP=function(){function e(t,n){S(this,e),this._firestore=t,this._delegate=n}return N(e,[{key:"ref",get:function(){return new OP(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return jD(this._delegate,e._delegate)}}]),e}(),VP=function(e){P(n,e);var t=M(n);function n(){return S(this,n),t.apply(this,arguments)}return N(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return function(e,t){e||Aw()}(void 0!==t),t}}]),n}(UP),BP=function(){function e(t,n){S(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new AP(t)}return N(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,WD(this._delegate,function(e,t,n){var r=t,i=LD("where",e);return new KD(i,r,n)}(t,n,r)))}catch(i){throw LP(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,WD(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=LD("orderBy",e);return new HD(n,t)}(t,n)))}catch(r){throw LP(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,WD(this._delegate,function(e){return OA("limit",e),new GD("limit",e,"F")}(t)))}catch(n){throw LP(n,"limit()","Query.limit()")}}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,WD(this._delegate,function(e){return OA("limitToLast",e),new GD("limitToLast",e,"L")}(t)))}catch(n){throw LP(n,"limitToLast()","Query.limitToLast()")}}},{key:"startAt",value:function(){try{return new e(this.firestore,WD(this._delegate,YD.apply(void 0,arguments)))}catch(t){throw LP(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,WD(this._delegate,JD.apply(void 0,arguments)))}catch(t){throw LP(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,WD(this._delegate,$D.apply(void 0,arguments)))}catch(t){throw LP(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,WD(this._delegate,ZD.apply(void 0,arguments)))}catch(t){throw LP(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return WA(this._delegate,e._delegate)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?fP(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=RA(e,VA);var t=RA(e.firestore,QA),n=YA(t),r=new lP(t);return TA(n,e._query,{source:"server"}).then((function(n){return new VD(t,r,e,n)}))}(this._delegate):function(e){e=RA(e,VA);var t=RA(e.firestore,QA),n=YA(t),r=new lP(t);return qD(e._query),TA(n,e._query).then((function(n){return new VD(t,r,e,n)}))}(this._delegate),t.then((function(e){return new qP(n.firestore,new VD(n.firestore._delegate,n._userDataWriter,n._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=MP(n),a=FP(n,(function(t){return new qP(e.firestore,new VD(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return vP(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(RP.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),jP=function(){function e(t,n){S(this,e),this._firestore=t,this._delegate=n}return N(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new VP(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),qP=function(){function e(t,n){S(this,e),this._firestore=t,this._delegate=n}return N(e,[{key:"query",get:function(){return new BP(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new VP(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new jP(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new VP(n._firestore,r))}))}},{key:"isEqual",value:function(e){return jD(this._delegate,e._delegate)}}]),e}(),zP=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return N(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new OP(this.firestore,e):null}},{key:"doc",value:function(e){try{return new OP(this.firestore,void 0===e?qA(this._delegate):qA(this._delegate,e))}catch(t){throw LP(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=RA(e.firestore,QA),r=qA(e),i=oP(e.converter,t);return mP(n,[pD(dD(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,bx.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new OP(t.firestore,e)}))}},{key:"isEqual",value:function(e){return zA(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(RP.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(BP);function WP(e){return RA(e,UA)}var KP=function(){function e(){S(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=F(rD,n)}return N(e,[{key:"isEqual",value:function(e){return(e=De(e))instanceof rD&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(e_.keyField().canonicalString())}}]),e}(),HP=function(){function e(t){S(this,e),this._delegate=t}return N(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new mD("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new vD("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=_P.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=bP.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=function(e){return new wD("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),GP={Firestore:NP,GeoPoint:oD,Timestamp:Yw,Blob:TP,Transaction:DP,WriteBatch:PP,DocumentReference:OP,DocumentSnapshot:UP,Query:BP,QueryDocumentSnapshot:VP,QuerySnapshot:qP,CollectionReference:zP,FieldPath:KP,FieldValue:HP,setLogLevel:function(e){!function(e){Iw.setLogLevel(e)}(e)},CACHE_SIZE_UNLIMITED:-1};!function(e){!function(e,t){e.INTERNAL.registerComponent(new Pe("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},GP)))}(e,(function(e,t){return new NP(e,t,new CP)})),e.registerVersion("@firebase/firestore-compat","0.1.20")}(Hs);var QP=new ze("@firebase/database-compat"),YP=function(e){var t="FIREBASE WARNING: "+e;QP.warn(t)},JP=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(Se(e,t)+"must be a boolean.")},XP=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Se(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},$P=function(){function e(t){S(this,e),this._delegate=t}return N(e,[{key:"cancel",value:function(e){Te("OnDisconnect.cancel",0,1,arguments.length),Ce("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"remove",value:function(e){Te("OnDisconnect.remove",0,1,arguments.length),Ce("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"set",value:function(e,t){Te("OnDisconnect.set",1,2,arguments.length),Ce("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"setWithPriority",value:function(e,t,n){Te("OnDisconnect.setWithPriority",2,3,arguments.length),Ce("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"update",value:function(e,t){if(Te("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,YP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ce("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}}]),e}(),ZP=function(){function e(t,n){S(this,e),this.committed=t,this.snapshot=n}return N(e,[{key:"toJSON",value:function(){return Te("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}]),e}(),eR=function(){function e(t,n){S(this,e),this._database=t,this._delegate=n}return N(e,[{key:"val",value:function(){return Te("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}},{key:"exportVal",value:function(){return Te("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}},{key:"toJSON",value:function(){return Te("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"exists",value:function(){return Te("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}},{key:"child",value:function(t){return Te("DataSnapshot.child",0,1,arguments.length),t=String(t),qo("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))}},{key:"hasChild",value:function(e){return Te("DataSnapshot.hasChild",1,1,arguments.length),qo("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}},{key:"getPriority",value:function(){return Te("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}},{key:"forEach",value:function(t){var n=this;return Te("DataSnapshot.forEach",1,1,arguments.length),Ce("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))}},{key:"hasChildren",value:function(){return Te("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}},{key:"key",get:function(){return this._delegate.key}},{key:"numChildren",value:function(){return Te("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}},{key:"getRef",value:function(){return Te("DataSnapshot.ref",0,0,arguments.length),new nR(this._database,this._delegate.ref)}},{key:"ref",get:function(){return this.getRef()}}]),e}(),tR=function(){function e(t,n){S(this,e),this.database=t,this._delegate=n}return N(e,[{key:"on",value:function(t,n,r,i){var a,o=this;Te("Query.on",2,4,arguments.length),Ce("Query.on","callback",n,!1);var u=e.getCancelAndContextArgs_("Query.on",r,i),s=function(e,t){n.call(u.context,new eR(o.database,e),t)};s.userCallback=n,s.context=u.context;var c=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(t){case"value":return Qu(this._delegate,s,c),n;case"child_added":return Yu(this._delegate,s,c),n;case"child_removed":return $u(this._delegate,s,c),n;case"child_changed":return Ju(this._delegate,s,c),n;case"child_moved":return Xu(this._delegate,s,c),n;default:throw new Error(Se("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}},{key:"off",value:function(e,t,n){if(Te("Query.off",0,3,arguments.length),XP("Query.off",e,!0),Ce("Query.off","callback",t,!0),Ne("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,Zu(this._delegate,e,r)}else Zu(this._delegate,e)}},{key:"get",value:function(){var e=this;return function(e){return ou((e=De(e))._repo,e).then((function(t){return new Lu(t,new Ou(e._repo,e._path),e._queryParams.getIndex())}))}(this._delegate).then((function(t){return new eR(e.database,t)}))}},{key:"once",value:function(t,n,r,i){var a=this;Te("Query.once",1,4,arguments.length),Ce("Query.once","callback",n,!0);var o=e.getCancelAndContextArgs_("Query.once",r,i),u=new J,s=function(e,t){var r=new eR(a.database,e);n&&n.call(o.context,r,t),u.resolve(r)};s.userCallback=n,s.context=o.context;var c=function(e){o.cancel&&o.cancel.call(o.context,e),u.reject(e)};switch(t){case"value":Qu(this._delegate,s,c,{onlyOnce:!0});break;case"child_added":Yu(this._delegate,s,c,{onlyOnce:!0});break;case"child_removed":$u(this._delegate,s,c,{onlyOnce:!0});break;case"child_changed":Ju(this._delegate,s,c,{onlyOnce:!0});break;case"child_moved":Xu(this._delegate,s,c,{onlyOnce:!0});break;default:throw new Error(Se("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise}},{key:"limitToFirst",value:function(t){return Te("Query.limitToFirst",1,1,arguments.length),new e(this.database,xs(this._delegate,ls(t)))}},{key:"limitToLast",value:function(t){return Te("Query.limitToLast",1,1,arguments.length),new e(this.database,xs(this._delegate,fs(t)))}},{key:"orderByChild",value:function(t){return Te("Query.orderByChild",1,1,arguments.length),new e(this.database,xs(this._delegate,ps(t)))}},{key:"orderByKey",value:function(){return Te("Query.orderByKey",0,0,arguments.length),new e(this.database,xs(this._delegate,ys()))}},{key:"orderByPriority",value:function(){return Te("Query.orderByPriority",0,0,arguments.length),new e(this.database,xs(this._delegate,gs()))}},{key:"orderByValue",value:function(){return Te("Query.orderByValue",0,0,arguments.length),new e(this.database,xs(this._delegate,ws()))}},{key:"startAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Te("Query.startAt",0,2,arguments.length),new e(this.database,xs(this._delegate,os(t,n)))}},{key:"startAfter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Te("Query.startAfter",0,2,arguments.length),new e(this.database,xs(this._delegate,ss(t,n)))}},{key:"endAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Te("Query.endAt",0,2,arguments.length),new e(this.database,xs(this._delegate,ns(t,n)))}},{key:"endBefore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Te("Query.endBefore",0,2,arguments.length),new e(this.database,xs(this._delegate,is(t,n)))}},{key:"equalTo",value:function(t,n){return Te("Query.equalTo",1,2,arguments.length),new e(this.database,xs(this._delegate,bs(t,n)))}},{key:"toString",value:function(){return Te("Query.toString",0,0,arguments.length),this._delegate.toString()}},{key:"toJSON",value:function(){return Te("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}},{key:"isEqual",value:function(t){if(Te("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)}},{key:"ref",get:function(){return new nR(this.database,new Ou(this._delegate._repo,this._delegate._path))}}],[{key:"getCancelAndContextArgs_",value:function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Ce(e,"cancel",r.cancel,!0),r.context=n,Ne(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(Se(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}}]),e}(),nR=function(e){P(n,e);var t=M(n);function n(e,r){var i;return S(this,n),(i=t.call(this,e,new Au(r._repo,r._path,new di,!1))).database=e,i._delegate=r,i}return N(n,[{key:"getKey",value:function(){return Te("Reference.key",0,0,arguments.length),this._delegate.key}},{key:"child",value:function(e){return Te("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new n(this.database,Uu(this._delegate,e))}},{key:"getParent",value:function(){Te("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new n(this.database,e):null}},{key:"getRoot",value:function(){return Te("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}},{key:"set",value:function(e,t){Te("Reference.set",1,2,arguments.length),Ce("Reference.set","onComplete",t,!0);var n=ju(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"update",value:function(e,t){if(Te("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,YP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}zo("Reference.update",this._delegate._path),Ce("Reference.update","onComplete",t,!0);var i=Wu(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i}},{key:"setWithPriority",value:function(e,t,n){Te("Reference.setWithPriority",2,3,arguments.length),Ce("Reference.setWithPriority","onComplete",n,!0);var r=zu(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r}},{key:"remove",value:function(e){Te("Reference.remove",0,1,arguments.length),Ce("Reference.remove","onComplete",e,!0);var t=Bu(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t}},{key:"transaction",value:function(e,t,n){var r=this;Te("Reference.transaction",1,3,arguments.length),Ce("Reference.transaction","transactionUpdate",e,!1),Ce("Reference.transaction","onComplete",t,!0),JP("Reference.transaction","applyLocally",n,!0);var i=Us(this._delegate,e,{applyLocally:n}).then((function(e){return new ZP(e.committed,new eR(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i}},{key:"setPriority",value:function(e,t){Te("Reference.setPriority",1,2,arguments.length),Ce("Reference.setPriority","onComplete",t,!0);var n=qu(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n}},{key:"push",value:function(e,t){var r=this;Te("Reference.push",0,2,arguments.length),Ce("Reference.push","onComplete",t,!0);var i=Vu(this._delegate,e),a=i.then((function(e){return new n(r.database,e)}));t&&a.then((function(){return t(null)}),(function(e){return t(e)}));var o=new n(this.database,i);return o.then=a.then.bind(a),o.catch=a.catch.bind(a,void 0),o}},{key:"onDisconnect",value:function(){return zo("Reference.onDisconnect",this._delegate._path),new $P(new Nu(this._delegate._repo,this._delegate._path))}},{key:"key",get:function(){return this.getKey()}},{key:"parent",get:function(){return this.getParent()}},{key:"root",get:function(){return this.getRoot()}}]),n}(tR),rR=function(){function e(t,n){var r=this;S(this,e),this._delegate=t,this.app=n,this.INTERNAL={delete:function(){return r._delegate._delete()},forceWebSockets:As,forceLongPolling:Ds}}return N(e,[{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ps(this._delegate,e,t,n)}},{key:"ref",value:function(e){if(Te("database.ref",0,1,arguments.length),e instanceof nR){var t=Fu(this._delegate,e.toString());return new nR(this,t)}var n=Mu(this._delegate,e);return new nR(this,n)}},{key:"refFromURL",value:function(e){var t="database.refFromURL";Te(t,1,1,arguments.length);var n=Fu(this._delegate,e);return new nR(this,n)}},{key:"goOffline",value:function(){return Te("database.goOffline",0,0,arguments.length),Rs(this._delegate)}},{key:"goOnline",value:function(){return Te("database.goOnline",0,0,arguments.length),Os(this._delegate)}}]),e}();rR.ServerValue={TIMESTAMP:Ms,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}};var iR=Object.freeze({__proto__:null,initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,a=e.namespace,o=e.nodeAdmin,u=void 0!==o&&o;Xt(r);var s=new Oe("auth-internal",new Fe("database-standalone"));return s.setComponent(new Pe("auth-internal",(function(){return i}),"PRIVATE")),{instance:new rR(Ss(t,s,void 0,n,u),t),namespace:a}}}),aR=rR.ServerValue;!function(e){e.INTERNAL.registerComponent(new Pe("database-compat",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new rR(i,r)}),"PUBLIC").setServiceProps({Reference:nR,Query:tR,Database:rR,DataSnapshot:eR,enableLogging:Ls,INTERNAL:iR,ServerValue:aR}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.2.2")}(Hs);var oR=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St(),t=arguments.length>1?arguments[1]:void 0;return kt(e,"database").getImmediate({identifier:t})}(Tt({apiKey:"AIzaSyBgW7bHtq02poDieD3wPaXjxd3DDAZiYNo",authDomain:"todoapp-ee772.firebaseapp.com",projectId:"todoapp-ee772",storageBucket:"todoapp-ee772.appspot.com",messagingSenderId:"472046002245",appId:"1:472046002245:web:340c2eeb8487feb6dc832c"}));var uR=function(){var e=l((0,t.useState)(!1),2),n=e[0],r=e[1],i=l((0,t.useState)(!1),2),a=i[0],o=i[1],s=l((0,t.useState)([]),2),c=s[0],d=s[1],v=l((0,t.useState)(),2),m=(v[0],v[1],l((0,t.useState)([]),2)),g=m[0],k=m[1],w=l((0,t.useState)("All"),2),b=w[0],x=w[1];(0,t.useEffect)((function(){var e=function(e){"ArrowLeft"===e.key&&a?o(!1):"ArrowRight"!==e.key||a||o(!0)};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}));var I=l((0,t.useState)([]),2),E=I[0],T=I[1],S=l((0,t.useState)([]),2),C=S[0],N=S[1],A=function(e){F(e),D()},D=function(){var e=[],t=[],n=[];switch(b){case"All":e=E,N([(0,h.jsx)(p,{name:"All",post:P(e),RemoveFromDB:U,DoneUdate:A},1)]);break;case"Important":e=[];for(var r=0;r<E.length;r++)for(var i=0;i<E[r].marks.length;i++)"Important "===E[r].marks[i]&&(e=[].concat(u(e),[E[r]]));N([(0,h.jsx)(p,{name:"Important",post:P(e),RemoveFromDB:U,DoneUdate:A},1)]);break;case"Complete":e=[];for(var a=0;a<E.length;a++)E[a].done&&(e=[].concat(u(e),[E[a]]));N([(0,h.jsx)(p,{name:"Complete",post:P(e),RemoveFromDB:U,DoneUdate:A},1)]);break;case"Uncomplete":e=[];for(var o=0;o<E.length;o++)E[o].done||(e=[].concat(u(e),[E[o]]));N([(0,h.jsx)(p,{name:"Uncomplete",post:P(e),RemoveFromDB:U,DoneUdate:A},1)]);break;case"By date":t=[],n=["Everyday ","Today ","Tomorrow "];for(var s=0;s<n.length;s++){e=[];for(var c=0;c<E.length;c++)for(var l=0;l<E[c].marks.length;l++)E[c].marks[l]===n[s]&&(e=[].concat(u(e),[E[c]]));t=[].concat(u(t),[(0,h.jsx)(p,{name:n[s],post:P(e),RemoveFromDB:U,DoneUdate:A},1)])}N(t);break;case"By marks":t=[],n=[];for(var f=0;f<O.length;f++)n=[].concat(u(n),[O[f].mark+" "]);for(var d=0;d<n.length;d++){e=[];for(var v=0;v<E.length;v++)for(var y=0;y<E[v].marks.length;y++)E[v].marks[y]===n[d]&&(e=[].concat(u(e),[E[v]]));0!==e.length&&(console.log(n[d],e),t=[].concat(u(t),[(0,h.jsx)(p,{name:n[d],post:P(e),RemoveFromDB:U,DoneUdate:A},1)]))}N(t)}},P=function(e){for(var t=e,n=[],r=[],i=0;i<t.length;i++)t[i].done?r.push(t[i]):n.push(t[i]);return[].concat(u(R(n)),u(R(r)))},R=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)if(e[t].id<e[n].id){var r=e[n];e[n]=e[t],e[t]=r}return e},O=[{key:1,mark:"Today"},{key:2,mark:"Tomorrow"},{key:3,mark:"Everyday"},{key:4,mark:"Important"},{key:5,mark:"Work"},{key:6,mark:"Home"},{key:7,mark:"Hobby"}];function L(e){k(e)}(0,t.useEffect)((function(){D()}),[b]),(0,t.useEffect)((function(){D()}),[E]),(0,t.useEffect)((function(){M()}),[]);var M=function(){T([]),console.log("RENDER!"),Qu(Mu(oR),(function(e){var t=e.val();null!==t&&T(Object.values(t))}))},F=function(e){Wu(Mu(oR,e.id.toString()),{done:!e.done})},U=function(e){Bu(Mu(oR,e.id.toString())),M()};return(0,h.jsxs)("div",{className:"App",id:"App",children:[(0,h.jsx)(_,{myAddMark:g,AddMarksToPost:L,marksArr:c,setMarksArr:d,marks:O,AddPostWind_active:n,setAddPostWind_active:r,AddPostToPosts:function(e){ju(Mu(oR,e.id.toString()),{id:e.id,text:e.text,done:e.done,marks:e.marks.length>0?e.marks:[""]}),k([]),r(!1)}}),(0,h.jsx)(f,{ClickOptBtn:function(e){console.log(e)},setFiltrName:x,leftMenu_acvive:a}),(0,h.jsx)(y,{filtrBoxes:C,AddMarksToPost:L,marks:O,setMarksArr:d,leftMenu_acvive:a,setLeftMenu_acvive:o,setAddPostWind_active:r})]})};r.createRoot(document.getElementById("root")).render((0,h.jsx)(t.StrictMode,{children:(0,h.jsx)(uR,{})}))}()}();
//# sourceMappingURL=main.3cff1bb0.js.map